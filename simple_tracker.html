<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RESOTRADE</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    :root {
        --bg-primary: #000000;
        --bg-secondary: #111111;
        --bg-card: #333333;
        --text-primary: #ffffff;
        --text-secondary: #cccccc;
        --border: #333333;
        --accent: #007bff;
        --positive: #28a745;
        --negative: #dc3545;
        --shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    :root.dark {
        --bg-primary: #000000;
        --bg-secondary: #111111;
        --bg-card: #333333;
        --text-primary: #ffffff;
        --text-secondary: #cccccc;
        --border: #333333;
        --accent: #0d6efd;
        --positive: #198754;
        --negative: #dc3545;
        --shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
        transition: all 0.3s ease;
        font-size: 18px;
        font-weight: 800;
    }

    * {
        font-weight: 800 !important;
    }

    /* Мобильное сообщение о разработке */
    .mobile-development-message {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #000000 0%, #111111 100%);
        z-index: 9999;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
    }

    .mobile-dev-icon {
        font-size: 5rem;
        color: var(--accent);
        margin-bottom: 30px;
    }

    .mobile-dev-title {
        font-size: 2.5rem;
        font-weight: 900;
        margin-bottom: 20px;
        color: var(--text-primary);
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .mobile-dev-subtitle {
        font-size: 1.2rem;
        color: var(--text-secondary);
        margin-bottom: 40px;
        line-height: 1.6;
        max-width: 350px;
    }

    .mobile-dev-features {
        list-style: none;
        padding: 0;
        margin-bottom: 40px;
    }

    .mobile-dev-features li {
        font-size: 1rem;
        color: var(--text-secondary);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: flex-start;
    }

    .mobile-dev-features li i {
        color: var(--accent);
        margin-right: 10px;
        width: 20px;
    }

    .mobile-dev-contact {
        font-size: 0.9rem;
        color: var(--text-secondary);
        opacity: 0.8;
    }

    .mobile-dev-contact a {
        color: var(--accent);
        text-decoration: none;
    }



    /* Скрытие основного контента на мобильных */
    @media (max-width: 768px) {
        .mobile-development-message {
            display: flex !important;
        }
        
        .frame,
        .sidebar,
        .right-sidebar,
        .main-area {
            display: none !important;
        }
    }

    .frame {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #131213;
        z-index: 50;
    }
    
    .frame::after {
        content: '';
        position: absolute;
        top: 10px;
        left: 90px;
        right: 90px;
        bottom: 10px;
        background: var(--bg-primary);
        border-radius: 25px;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    body.sidebar-expanded .frame::after {
        left: 280px;
    }

    .main-area {
        position: fixed;
        top: 20px;
        left: 100px;
        right: 105px;
        bottom: 20px;
        background: transparent;
        border-radius: 20px;
        margin: 0;
        box-shadow: 
            inset 0 0 20px rgba(0,0,0,0.3);
        overflow: auto;
        z-index: 100;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    body.sidebar-expanded .main-area {
        left: 290px;
        right: 105px;
    }

    /* Кастомный скроллбар */
    .main-area::-webkit-scrollbar {
        width: 8px;
    }

    .main-area::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 8px;
    }

    .main-area::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
    }

    .main-area::-webkit-scrollbar-thumb:hover {
        background: var(--border);
    }

    .container {
        max-width: none;
        margin: 0;
        padding: 30px;
        height: 100%;
        min-height: calc(100vh - 140px);
    }

    .header {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 30px;
        padding: 0;
        border: none;
    }

    .header h1 {
        font-size: 3.5rem;
        font-weight: 900;
        color: var(--accent);
        margin: 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }



    .card {
        background: #111111 !important;
        border: none;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: var(--shadow);
        font-size: 19px;
        font-weight: 800;
    }

    .card h3 {
        font-size: 2rem;
        font-weight: 800;
        margin-bottom: 20px;
        color: var(--accent);
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }



    .btn {
        background: var(--bg-card);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 10px;
        cursor: pointer;
        margin: 8px;
        font-size: 1.1rem;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        -webkit-text-stroke: 0.3px;
    }
    .btn-secondary {
        background: #333333;
        color: var(--text-primary);
        border: 1px solid var(--border);
    }

    .btn-danger {
        background: var(--negative);
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        font-size: 0.9rem;
        color: #ffffff !important;
        -webkit-text-stroke: 0.1px;
    }

    .form-control {
        width: 100%;
        padding: 12px;
        border: 1px solid #333333 !important;
        border-radius: 8px !important;
        background: #1a1a1a !important;
        color: #ffffff !important;
        font-size: 0.9rem;
        font-weight: 400;
    }

    .form-control:focus {
        border-color: var(--accent) !important;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2) !important;
        outline: none;
    }

    /* Стили для пользовательского диапазона дат */
    .date-range-modal {
        z-index: 1300;
        background: #000000 !important;
    }

    .date-range-modal-content {
        background: #131213 !important; /* Цвет как у левого меню */
        border: 1px solid #333333;
        margin: 5% auto; /* Поднимаем выше */
        padding: 25px 35px;
        border-radius: 16px;
        max-width: 700px; /* Уменьшили для 3 колонок */
        width: 90%;
        position: relative;
        font-size: 1rem;
        font-weight: 500; /* Тоньше шрифт */
        box-shadow: 0 15px 50px rgba(0,0,0,0.6);
        color: #ffffff !important; /* Белый текст */
    }

    .date-range-modal-content h3 {
        font-size: 1.3rem !important; /* Еще меньше заголовок */
        font-weight: 600; /* Тоньше заголовок */
        margin-bottom: 20px;
        padding-bottom: 15px;
        color: #ffffff !important; /* Белый заголовок */
        text-align: center;
        -webkit-text-stroke: 0.2px;
        border-bottom: 1px solid #333333; /* Разделительная линия */
    }

    .date-range-modal-content h3 i {
        font-size: 0.9rem !important; /* Уменьшаем иконку */
        margin-right: 6px;
        opacity: 0.8;
    }

    .date-range-modal-content .close {
        color: #cccccc;
        font-size: 24px;
    }

    .date-range-modal-content .close:hover {
        color: #ff4757;
    }

    .date-range-form-grid {
        display: flex;
        flex-direction: column;
        gap: 0px; /* Убираем gap, используем margin и padding для разделителей */
        margin-bottom: 5px;
    }

    .date-range-type-row {
        width: 100%;
        margin-bottom: 20px;
    }

    .date-range-dates-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        align-items: end;
    }

    .date-range-form-grid .form-group {
        margin-bottom: 0;
    }

    .date-range-form-grid .form-group label {
        font-size: 0.9rem;
        font-weight: 500; /* Тоньше лейблы */
        color: #ffffff !important; /* Белые лейблы */
        margin-bottom: 8px;
        -webkit-text-stroke: 0.1px;
        display: block;
    }

    .date-range-form-grid select.form-control {
        background: #1a1a1a !important;
        border: 1px solid #333333 !important;
        color: #ffffff !important;
        font-size: 0.9rem;
        font-weight: 400; /* Тоньше текст в полях */
        padding: 12px;
    }

    .date-range-form-grid select.form-control:focus {
        border-color: var(--accent) !important;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2) !important;
    }

    .date-range-form-grid input.form-control {
        background: #1a1a1a !important;
        border: 1px solid #333333 !important;
        color: #ffffff !important;
        font-size: 0.9rem;
        font-weight: 400; /* Тоньше текст в полях */
        padding: 12px;
        border-radius: 8px !important;
    }

    .date-range-form-grid input.form-control:focus {
        border-color: var(--accent) !important;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2) !important;
        outline: none !important;
    }

    /* Белые иконки календаря в полях дат */
    .date-range-form-grid input[type="date"] {
        color-scheme: dark;
    }

    .date-range-form-grid input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        cursor: pointer;
    }

    .date-range-form-grid input[type="date"]::-webkit-datetime-edit {
        color: #ffffff !important;
    }

    .date-range-form-grid input[type="date"]::-webkit-datetime-edit-text {
        color: #ffffff !important;
    }

    .date-range-form-grid input[type="date"]::-webkit-datetime-edit-month-field {
        color: #ffffff !important;
    }

    .date-range-form-grid input[type="date"]::-webkit-datetime-edit-day-field {
        color: #ffffff !important;
    }

    .date-range-form-grid input[type="date"]::-webkit-datetime-edit-year-field {
        color: #ffffff !important;
    }

















    .date-range-form-grid option {
        background: #1a1a1a !important;
        color: #ffffff !important;
        font-weight: 400;
    }

    .date-range-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid rgba(255,255,255,0.3);
    }

    .date-range-buttons .btn {
        min-width: 120px;
        padding: 12px 20px;
        font-size: 0.9rem;
        font-weight: 600;
        border: none !important;
        border-radius: 8px !important;
    }

    /* Красная кнопка ОТМЕНИТЬ */
    .date-range-buttons .btn.btn-secondary {
        background: #dc3545 !important;
        color: #ffffff !important;
    }

    .date-range-buttons .btn.btn-secondary:hover {
        background: #c82333 !important;
    }

    /* Синяя кнопка ФИЛЬТР */
    .date-range-buttons .btn:not(.btn-secondary) {
        background: #007bff !important;
        color: #ffffff !important;
    }

    .date-range-buttons .btn:not(.btn-secondary):hover {
        background: #0056b3 !important;
        color: #ffffff !important;
    }

    /* Адаптивность для горизонтального модального окна */
    @media (max-width: 768px) {
        .date-range-modal-content {
            max-width: 95%;
            padding: 20px 25px;
            margin: 8% auto;
        }

        .date-range-dates-row {
            grid-template-columns: 1fr; /* 1 колонка на мобильных для дат */
            gap: 15px;
        }

        .date-range-modal-content h3 {
            font-size: 1.15rem !important;
        }

        .date-range-buttons .btn {
            min-width: 100px;
            padding: 10px 16px;
            font-size: 0.85rem;
        }
    }

    @media (max-width: 480px) {
        .date-range-dates-row {
            grid-template-columns: 1fr; /* 1 колонка на очень маленьких экранах */
            gap: 12px;
        }

        .date-range-buttons {
            flex-direction: column;
            gap: 10px;
        }

        .date-range-buttons .btn {
            width: 100%;
        }
    }

    /* Стили для поля поиска с иконкой */
    .search-container {
        position: relative;
        flex: 1;
        min-width: 200px;
    }

    .search-input {
        padding-left: 50px !important;
    }

    .search-input:focus {
        border-color: var(--border) !important;
        box-shadow: none !important;
        outline: none !important;
    }

    .search-icon {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
        font-size: 16px;
        pointer-events: none;
        z-index: 1;
    }

    select.form-control {
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        cursor: pointer;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 12px center;
        background-size: 16px;
        padding-right: 40px;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }

    select.form-control:focus {
        border-color: var(--border) !important;
        box-shadow: none !important;
        outline: none !important;
    }

    option {
        font-weight: 400;
        padding: 12px 15px;
        background: #1a1a1a !important;
        color: #ffffff !important;
        border: none;
        font-size: 0.9rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        text-transform: none;
        letter-spacing: 0.2px;
        line-height: 1.4;
        border-radius: 0;
    }

    /* Стилизация выпадающего списка */
    select.form-control option:first-child {
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    select.form-control option:last-child {
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }

    option:hover,
    option:focus,
    option:checked {
        background: var(--accent) !important;
        color: #ffffff !important;
    }

    /* Для Firefox */
    select.form-control {
        text-indent: 0.01px;
        text-overflow: '';
    }

    /* Для WebKit браузеров */
    select.form-control::-webkit-scrollbar {
        width: 8px;
    }

    select.form-control::-webkit-scrollbar-track {
        background: var(--bg-card);
        border-radius: 8px;
    }

    select.form-control::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
    }

    select.form-control::-webkit-scrollbar-thumb:hover {
        background: var(--accent);
    }

    /* Дополнительная стилизация для WebKit браузеров */
    select.form-control {
        border-radius: 10px;
    }

    /* Попытка стилизации выпадающего списка в WebKit */
    select.form-control::-webkit-list-box {
        border-radius: 10px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    /* Для Firefox - альтернативный подход */
    @-moz-document url-prefix() {
        select.form-control {
            border-radius: 10px;
            background: var(--bg-card);
        }
    }

    /* Дополнительные правила для Brave и других Chromium браузеров */
    select.form-control {
        border-radius: 10px !important;
        overflow: hidden;
    }

    /* Попытка для всех WebKit браузеров */
    select.form-control::-webkit-appearance {
        border-radius: 10px;
    }

    /* Принудительное применение стилей */
    select.form-control, 
    select.form-control * {
        border-radius: 10px !important;
        -webkit-border-radius: 10px !important;
        -moz-border-radius: 10px !important;
    }

    /* Для Brave специально */
    select.form-control {
        background-clip: padding-box !important;
        border-radius: 10px !important;
        box-sizing: border-box !important;
    }

    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000000;
        z-index: 1200;
    }

    /* Блокировка скролла и взаимодействия при открытом модальном окне */
    body.modal-open {
        overflow: hidden;
    }

    body.modal-open .sidebar {
        pointer-events: none;
    }
    
    /* Правый сайдбар остается активным для модального окна депозитов */
    body.modal-open .right-sidebar {
        pointer-events: auto;
    }

    /* Затемнение сайдбаров при открытом модальном окне - только левый сайдбар */
    body.modal-open .sidebar::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #000000;
        z-index: 50;
        pointer-events: none;
    }

    /* Иконки в правом сайдбаре должны быть выше затемнения */
    body.modal-open .right-sidebar .right-nav-btn {
        position: relative;
        z-index: 51;
    }

    body.modal-open .right-sidebar .right-nav-btn i {
        position: relative;
        z-index: 52;
    }

    body.modal-open .sidebar,
    body.modal-open .right-sidebar {
        position: relative;
    }

    .modal-content {
        background: #131213 !important;
        border: 1px solid #333333;
        margin: 5% auto;
        padding: 25px 35px;
        border-radius: 16px;
        max-width: 700px;
        width: 90%;
        position: relative;
        font-size: 1rem;
        font-weight: 500;
        box-shadow: 0 15px 50px rgba(0,0,0,0.6);
        color: #ffffff !important;
        max-height: 85vh;
        overflow-y: auto;
    }

    .modal-content h3 {
        font-size: 1.3rem !important;
        font-weight: 600;
        margin-bottom: 20px;
        padding-bottom: 15px;
        color: #ffffff !important;
        text-align: center;
        -webkit-text-stroke: 0.2px;
        border-bottom: 1px solid #333333;
    }

    .modal-content h3 i {
        font-size: 0.9rem !important;
        margin-right: 6px;
        opacity: 0.8;
    }

    .close {
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 24px;
        font-weight: 900;
        cursor: pointer;
        color: #cccccc;
        transition: all 0.3s;
    }

    .close:hover {
        color: #ff4757;
    }

    /* Стили кнопок для модального окна добавления сделки */
    .modal-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid rgba(255,255,255,0.3);
    }

    .modal-buttons .btn {
        min-width: 120px;
        padding: 12px 20px;
        font-size: 0.9rem;
        font-weight: 600;
        border: none !important;
        border-radius: 8px !important;
    }

    /* Красная кнопка ОТМЕНИТЬ */
    .modal-buttons .btn.btn-secondary {
        background: #dc3545 !important;
        color: #ffffff !important;
    }

    .modal-buttons .btn.btn-secondary:hover {
        background: #c82333 !important;
    }

    /* Синяя кнопка ДОБАВИТЬ */
    .modal-buttons .btn:not(.btn-secondary) {
        background: #007bff !important;
        color: #ffffff !important;
    }

    .modal-buttons .btn:not(.btn-secondary):hover {
        background: #0056b3 !important;
        color: #ffffff !important;
    }

    /* Горизонтальная сетка для полей формы */
    .transaction-form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 15px;
    }

    .transaction-form-grid .form-group {
        margin-bottom: 0;
    }

    /* Белые иконки календаря в полях дат модального окна */
    .modal-content input[type="date"] {
        color-scheme: dark;
    }

    .modal-content input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        cursor: pointer;
    }

    .modal-content input[type="date"]::-webkit-datetime-edit {
        color: #ffffff !important;
    }

    .modal-content input[type="date"]::-webkit-datetime-edit-day-field {
        color: #ffffff !important;
    }

    .modal-content input[type="date"]::-webkit-datetime-edit-year-field {
        color: #ffffff !important;
    }

    /* Кастомный скроллбар для модальных окон */
    .modal-content::-webkit-scrollbar {
        width: 8px;
    }

    .modal-content::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 8px;
        margin: 8px 0;
    }

    .modal-content::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
        border: 2px solid transparent;
        background-clip: content-box;
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
        background: #555555;
        background-clip: content-box;
    }

    /* Адаптивность для модального окна */
    @media (max-width: 768px) {
        .modal-content {
            max-width: 95%;
            padding: 20px 25px;
            margin: 3% auto;
            max-height: 90vh;
        }

        .transaction-form-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .modal-content h3 {
            font-size: 1.15rem !important;
        }

        .modal-buttons .btn {
            min-width: 100px;
            padding: 10px 16px;
            font-size: 0.85rem;
        }
    }

    @media (max-width: 480px) {
        .modal-content {
            margin: 2% auto;
            max-height: 95vh;
            padding: 15px 20px;
        }

        .modal-buttons {
            flex-direction: column;
            gap: 10px;
        }

        .modal-buttons .btn {
            width: 100%;
        }
    }

    /* Стили для модального окна подтверждения удаления */
    .confirm-delete-modal-content {
        max-width: 500px !important;
        text-align: center;
    }

    .confirm-delete-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 25px;
    }

    .confirm-delete-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: #dc3545;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
    }

    .confirm-delete-icon i {
        font-size: 2.2rem;
        color: #ffffff;
    }

    .confirm-delete-header h3 {
        margin: 0;
        padding: 0;
        border: none;
        color: #dc3545 !important;
        font-size: 1.4rem !important;
        font-weight: 800;
    }

    .confirm-delete-body {
        margin-bottom: 30px;
    }

    .confirm-delete-body p {
        font-size: 1.1rem;
        color: var(--text-secondary);
        margin-bottom: 15px;
        line-height: 1.5;
    }

    .transaction-preview {
        background: #1a1a1a;
        border: 1px solid #333333;
        border-radius: 10px;
        padding: 15px;
        margin: 15px 0;
        text-align: left;
    }

    .transaction-preview h4 {
        color: var(--text-primary);
        font-size: 1.1rem;
        margin: 0 0 8px 0;
        font-weight: 700;
    }

    .transaction-preview .preview-amount {
        font-size: 1.2rem;
        font-weight: 800;
        margin: 8px 0;
    }

    .transaction-preview .preview-amount.income {
        color: #22c55e;
    }

    .transaction-preview .preview-amount.expense {
        color: #ef4444;
    }

    .transaction-preview .preview-date {
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin: 5px 0;
    }

    .transaction-preview .preview-type {
        background: rgba(0, 123, 255, 0.15);
        color: var(--accent);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
        display: inline-block;
        margin-top: 8px;
    }

    .confirm-delete-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        padding-top: 20px;
        border-top: 1px solid rgba(255,255,255,0.1);
    }

    .confirm-delete-buttons .btn {
        min-width: 120px;
        padding: 12px 20px;
        font-size: 0.9rem;
        font-weight: 700;
        border: none !important;
        border-radius: 8px !important;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .confirm-delete-buttons .btn.btn-secondary {
        background: #6c757d !important;
        color: #ffffff !important;
    }

    .confirm-delete-buttons .btn.btn-secondary:hover {
        background: #5a6268 !important;
    }

    .confirm-delete-buttons .btn.btn-danger {
        background: #dc3545 !important;
        color: #ffffff !important;
    }

    .confirm-delete-buttons .btn.btn-danger:hover {
        background: #c82333 !important;
    }

    @media (max-width: 480px) {
        .confirm-delete-modal-content {
            max-width: 95% !important;
        }
        
        .confirm-delete-buttons {
            flex-direction: column;
            gap: 10px;
        }

        .confirm-delete-buttons .btn {
            width: 100%;
        }
    }

    .transaction-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0;
        margin-bottom: 25px;
        background: #1a1a1a;
        border: none;
        border-radius: 16px;
        font-size: 1.1rem;
        font-weight: 900;
        -webkit-text-stroke: 0.2px;
        overflow: hidden;
        position: relative;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        min-height: 100px;
    }

    .transaction-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 5px;
        background: linear-gradient(180deg, var(--accent), #0066ff);
        opacity: 0;
    }

    .transaction-item.income::before {
        background: linear-gradient(180deg, #22c55e, #16a34a);
        opacity: 1;
    }

    .transaction-item.expense::before {
        background: linear-gradient(180deg, #ef4444, #dc2626);
        opacity: 1;
    }

    .transaction-content {
        flex: 1;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .transaction-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 6px;
    }

    .transaction-icon {
        width: 42px;
        height: 42px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #ffffff;
        flex-shrink: 0;
    }

    .transaction-icon.income {
        background: linear-gradient(135deg, #22c55e, #16a34a);
        box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
    }

    .transaction-icon.expense {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .transaction-main-info {
        flex: 1;
    }

    .transaction-item h4 {
        font-size: 1.4rem;
        font-weight: 900;
        margin: 0;
        color: var(--text-primary);
        -webkit-text-stroke: 0.3px;
        line-height: 1.2;
    }

    .transaction-title-row {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 6px;
    }

    .transaction-title-row h4 {
        margin: 0;
        flex: 1;
        min-width: 0; /* Позволяет тексту сжиматься */
    }

    .transaction-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
        margin-top: 4px;
    }

    .transaction-type {
        background: rgba(0, 123, 255, 0.15);
        color: var(--accent);
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border: 1px solid rgba(0, 123, 255, 0.3);
    }

    .transaction-date {
        color: var(--text-secondary);
        font-size: 0.85rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 6px;
        margin-top: 2px;
    }

    .transaction-description {
        color: var(--text-secondary);
        font-size: 0.85rem;
        font-weight: 500;
        line-height: 1.4;
        margin-top: 8px;
        margin-left: 52px; /* Выравниваем с текстом, учитывая иконку + отступ */
        opacity: 0.8;
    }

    .transaction-amount-section {
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 12px;
        min-width: 180px;
        width: 180px;
    }

    .transaction-amount {
        font-size: 1.8rem;
        font-weight: 900;
        line-height: 1;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .transaction-amount.income {
        color: #22c55e;
    }

    .transaction-amount.expense {
        color: #ef4444;
    }

    .transaction-profit-info {
        text-align: right;
        font-size: 0.8rem;
        color: var(--text-secondary);
        line-height: 1.2;
    }

    .transaction-item:last-child {
        border-bottom: none;
    }

    .transaction-actions {
        display: flex;
        gap: 8px;
        margin-top: 8px;
    }

    .btn-sm {
        padding: 10px 12px;
        font-size: 0.85rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.3px;
        border-radius: 8px;
        min-width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        border: none;
        cursor: pointer;
    }

    .btn-sm:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .btn-sm.btn-secondary {
        background: #444444;
        color: #ffffff;
    }

    .btn-sm.btn-secondary:hover {
        background: #555555;
    }

    .btn-sm.btn-danger {
        background: #ef4444;
        color: #ffffff;
    }

    .btn-sm.btn-danger:hover {
        background: #dc2626;
    }

    .btn-sm.btn-info {
        background: #007bff;
        color: #ffffff;
    }

    .btn-sm.btn-info:hover {
        background: #0056b3;
    }

    /* Адаптивность для транзакций */
    @media (max-width: 768px) {
        .transaction-item {
            flex-direction: column;
            align-items: stretch;
        }

        .transaction-amount-section {
            padding: 15px 20px;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            min-width: auto;
            border-top: 1px solid #333333;
        }

        .transaction-amount {
            font-size: 1.5rem;
        }

        .transaction-actions {
            margin-top: 0;
            gap: 6px;
        }

        .btn-sm {
            min-width: 40px;
            height: 40px;
            padding: 8px;
        }

        .transaction-header {
            flex-wrap: wrap;
        }

        .transaction-icon {
            width: 35px;
            height: 35px;
            font-size: 16px;
        }

        .transaction-title-row {
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
        }

        .transaction-title-row h4 {
            font-size: 1.2rem;
        }

        .transaction-type {
            font-size: 0.7rem;
            padding: 3px 8px;
        }

        .transaction-date {
            font-size: 0.8rem;
            margin-top: 4px;
        }

        .transaction-description {
            margin-left: 47px; /* Учитываем уменьшенную иконку на мобильных */
            font-size: 0.8rem;
            margin-top: 6px;
        }
    }



    .chart-container {
        height: 400px;
        margin: 20px 0;
    }

    .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }

    /* Стили для индикатора активного фильтра */
    .filter-indicator {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #007bff !important;
        border: none !important;
        border-radius: 12px;
        padding: 12px 16px;
        margin-bottom: 20px;
    }

    .filter-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: #ffffff !important;
        font-weight: 700;
        font-size: 0.9rem;
    }

    .filter-info i {
        font-size: 1rem;
        color: #ffffff !important;
    }

    .filter-reset-btn {
        background: #ff4757 !important;
        border: none !important;
        border-radius: 8px;
        color: #ffffff !important;
        cursor: pointer;
        padding: 8px 10px;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 32px;
        height: 32px;
    }

    .filter-reset-btn:hover {
        background: #dc3545 !important;
    }



    /* Стили для управления графиком */
    .chart-controls {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-bottom: 25px;
        padding: 0 5px;
    }

    .chart-controls-right {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .chart-btn {
        background: var(--bg-card);
        color: var(--text-primary);
        border: 2px solid var(--border);
        padding: 10px 18px;
        border-radius: 12px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        transition: all 0.3s ease;
        min-width: 100px;
        justify-content: center;
    }

    .chart-btn:hover {
        background: var(--accent);
        border-color: var(--accent);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }

    .chart-btn.active {
        background: var(--accent);
        border-color: var(--accent);
        color: white;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
    }

    .chart-btn i {
        font-size: 0.8rem;
    }

    .period-buttons {
        display: flex;
        background: var(--bg-card);
        border-radius: 12px;
        padding: 4px;
        border: 2px solid var(--border);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .period-btn {
        background: transparent;
        color: var(--text-secondary);
        border: none;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.85rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.3px;
        transition: all 0.3s ease;
        position: relative;
        white-space: nowrap;
    }

    .period-btn:hover {
        color: var(--text-primary);
        background: rgba(255, 255, 255, 0.05);
    }

    .period-btn.active {
        background: var(--accent);
        color: white;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
        transform: scale(1.02);
    }

    /* Адаптивность для управления графиком */
    @media (max-width: 768px) {
        .chart-controls {
            flex-direction: column;
            gap: 15px;
            align-items: flex-start;
        }

        .chart-controls-right {
            width: 100%;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .period-buttons {
            flex: 1;
            min-width: 250px;
        }

        .period-btn {
            flex: 1;
            text-align: center;
        }
    }



    .transactions-list {
        max-height: 500px;
        overflow-y: auto;
        padding: 5px 15px 15px 5px;
        margin: -5px;
    }

    /* Скроллбар для списка транзакций */
    .transactions-list::-webkit-scrollbar {
        width: 10px;
    }

    .transactions-list::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 10px;
        margin: 5px 0;
    }

    .transactions-list::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 10px;
        border: 2px solid transparent;
        background-clip: content-box;
    }

    .transactions-list::-webkit-scrollbar-thumb:hover {
        background: #555555;
        background-clip: content-box;
    }

    /* Общие стили скроллбара для всех элементов */
    .skins-list::-webkit-scrollbar,
    .modal-content::-webkit-scrollbar {
        width: 8px;
    }

    .skins-list::-webkit-scrollbar-track,
    .modal-content::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 8px;
    }

    .skins-list::-webkit-scrollbar-thumb,
    .modal-content::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
    }

    .skins-list::-webkit-scrollbar-thumb:hover,
    .modal-content::-webkit-scrollbar-thumb:hover {
        background: var(--border);
    }



    .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: 90px;
        height: 100vh;
        background: transparent;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px 0;
        z-index: 101;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .sidebar.expanded {
        width: 280px;
        background: #131213;
        align-items: center;
        padding: 20px;
        box-shadow: 5px 0 20px rgba(0,0,0,0.3);
    }

    .sidebar-logo {
        font-size: 40px;
        font-weight: 900;
        color: var(--accent);
        margin-bottom: 35px;
        text-align: center;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        -webkit-text-stroke: 0.8px;
        cursor: pointer;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        align-self: center;
    }

    .sidebar-logo:hover {
        color: #ffffff;
        transform: scale(1.1);
    }

    .sidebar-nav {
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: 100%;
        align-items: center;
        height: calc(100vh - 90px);
    }

    .sidebar.expanded .sidebar-nav {
        align-items: center;
    }

    .nav-btn {
        width: 50px;
        height: 50px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        border-radius: 10px;
        margin: 2px 0;
        gap: 0;
    }

    .sidebar.expanded .nav-btn {
        width: 240px;
        height: 50px;
        justify-content: flex-start;
        padding: 15px 20px;
        margin: 5px 0;
        font-size: 16px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        gap: 18px;
        text-align: left;
        align-items: center;
        display: flex;
    }

    .nav-btn i {
        font-size: 22px;
        font-weight: 900;
        width: 24px;
        min-width: 24px;
        max-width: 24px;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .sidebar.expanded .nav-btn i {
        width: 24px;
        min-width: 24px;
        max-width: 24px;
    }

    .nav-btn-text {
        color: var(--text-primary);
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap;
        opacity: 0;
        width: 0;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        text-align: left;
        line-height: 1;
    }

    .sidebar.expanded .nav-btn-text {
        opacity: 1;
        width: auto;
        flex: 1;
        text-align: left;
        margin-left: 0;
    }

    .nav-btn:hover {
        color: #999999;
        background: #333333;
    }

    .nav-btn.active {
        color: #ffffff;
        background: #333333;
    }

    .nav-btn::before {
        content: '';
        position: absolute;
        left: -20px;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 0;
        background: #ffffff;
        transition: height 0.3s ease;
        border-radius: 10px;
    }

    .nav-btn.active::before {
        height: 30px;
    }



    /* Тултипы для кнопок меню */
    .nav-btn {
        position: relative;
    }

    .nav-btn::after {
        content: attr(data-tooltip);
        position: absolute;
        left: 65px;
        top: 50%;
        transform: translateY(-50%);
        background: #444444;
        color: #ffffff;
        padding: 14px 18px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }

    .nav-btn:hover::after {
        opacity: 1;
        visibility: visible;
        left: 75px;
    }

    /* Скрываем тултипы в расширенном меню */
    .sidebar.expanded .nav-btn::after {
        display: none;
    }

    /* Правый сайдбар */
    .right-sidebar {
        position: fixed;
        right: 0;
        top: 0;
        width: 90px;
        height: 100vh;
        background: transparent;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px 0;
        z-index: 101;
    }

    .right-sidebar-nav {
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: 100%;
        align-items: center;
        padding-top: 55px;
    }

    .right-nav-btn {
        width: 50px;
        height: 50px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        border-radius: 10px;
        margin: 2px 0;
    }

    .right-nav-btn i {
        font-size: 22px;
        font-weight: 900;
        width: 24px;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .right-nav-btn:hover {
        color: #999999;
        background: #333333;
    }

    .right-nav-btn.active {
        color: #ffffff;
        background: #333333;
    }

    .right-nav-btn:not(.important)::before {
        content: '';
        position: absolute;
        right: -20px;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 0;
        background: #ffffff;
        transition: height 0.3s ease;
        border-radius: 10px;
    }

    .right-nav-btn.active:not(.important)::before {
        height: 30px;
    }

    /* Белая полоска для правого меню через дополнительный элемент */
    .right-nav-btn .active-line {
        position: absolute;
        right: -20px;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 0;
        background: #ffffff;
        transition: height 0.3s ease;
        border-radius: 10px;
        z-index: 5;
    }

    .right-nav-btn.active .active-line {
        height: 30px;
    }

    /* Тултипы для правых кнопок */
    .right-nav-btn::after {
        content: attr(data-tooltip);
        position: absolute;
        right: 65px;
        top: 50%;
        transform: translateY(-50%);
        background: #444444;
        color: #ffffff;
        padding: 14px 18px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }

    .right-nav-btn:hover::after {
        opacity: 1;
        visibility: visible;
        right: 75px;
    }

    /* Красная точка для кнопки FAQ */
    .right-nav-btn.important {
        position: relative;
    }

    .red-dot {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 8px;
        height: 8px;
        background: #ff0000;
        border-radius: 50%;
        z-index: 10;
        box-shadow: 0 0 0 2px #000000, 0 0 8px rgba(255, 0, 0, 0.6);
        animation: pulse-red 2s infinite;
    }

    @keyframes pulse-red {
        0% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.2);
            opacity: 0.8;
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    /* Белая полоска для активных элементов */
    .nav-btn::before {
        content: '';
        position: absolute;
        left: -20px;
        top: 50%;
        transform: translateY(-50%);
        width: 5px;
        height: 0;
        background: #ffffff;
        transition: height 0.3s ease;
        border-radius: 10px;
    }

    .nav-btn.active::before {
        height: 30px;
    }

    .nav-separator {
        width: 60px;
        height: 1px;
        background: var(--border);
        margin: 15px 5px;
        border-radius: 1px;
        transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .sidebar.expanded .nav-separator {
        width: 240px;
        margin: 15px 0;
        align-self: center;
    }

    .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding: 15px 20px;
        background: var(--bg-card);
        border-radius: 12px;
        border: none;
    }

    .calendar-nav-btn {
        width: 40px;
        height: 40px;
        border: none;
        background: var(--accent);
        color: white;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        transition: all 0.3s ease;
    }

    .calendar-nav-btn:hover {
        background: var(--positive);
        transform: scale(1.05);
    }

    .calendar-month-title {
        font-size: 2rem;
        font-weight: 800;
        color: white !important;
        text-align: center;
        flex: 1;
    }

    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 8px;
        margin-top: 20px;
        background: var(--bg-card);
        padding: 20px;
        border-radius: 12px;
        border: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .calendar-weekday {
        padding: 15px 10px;
        text-align: center;
        font-weight: 800;
        font-size: 1.1rem;
        color: white !important;
        background: #131213;
        border-radius: 6px;
        border-bottom: 3px solid var(--accent);
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .calendar-day {
        padding: 8px;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
        min-height: 70px;
        position: relative;
        transition: all 0.3s ease;
        background: var(--bg-primary);
        border: 1px solid transparent;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .calendar-day:hover {
        background: #131213;
        border-color: var(--accent);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.2);
    }

    .calendar-day-number {
        font-weight: 800;
        font-size: 1.3rem;
        margin-bottom: 6px;
        color: white !important;
    }

    .calendar-day-transactions {
        font-size: 12px;
        font-weight: 800;
        color: white !important;
        margin: 3px 0;
    }

    .calendar-day-balance {
        font-size: 11px;
        font-weight: 800;
        padding: 3px 6px;
        border-radius: 6px;
        margin-top: auto;
        color: white !important;
    }

    .calendar-day-balance.positive {
        background: rgba(40, 167, 69, 0.2);
        color: var(--positive);
    }

    .calendar-day-balance.negative {
        background: rgba(220, 53, 69, 0.2);
        color: var(--negative);
    }

    .calendar-day.today {
        background: var(--accent);
        color: white;
        box-shadow: 0 0 20px rgba(0, 123, 255, 0.4);
        border-color: var(--accent);
    }

    .calendar-day.today .calendar-day-number {
        color: white;
    }

    .calendar-day.today .calendar-day-transactions {
        color: rgba(255, 255, 255, 0.8);
    }

    .calendar-day.today .calendar-day-balance {
        background: rgba(255, 255, 255, 0.2);
        color: white;
    }

    .calendar-day.has-transactions::after {
        content: '';
        position: absolute;
        top: 6px;
        right: 6px;
        width: 6px;
        height: 6px;
        background: var(--accent);
        border-radius: 50%;
    }

    .calendar-day.today.has-transactions::after {
        background: white;
    }

    .calculator-section {
        border-top: 1px solid var(--border);
        padding-top: 20px;
        margin-top: 20px;
    }

    .skins-list {
        max-height: 300px;
        overflow-y: auto;
        border: none;
        border-radius: 10px;
        padding: 10px;
        background: var(--bg-card);
    }

    .skin-item {
        padding: 10px;
        border-bottom: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .skin-quality {
        color: var(--accent);
        font-weight: 700;
        font-size: 0.9rem;
    }

    .skin-info-card {
        background: var(--bg-card);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        border-left: 4px solid var(--accent);
    }

    .skin-info-card h4 {
        margin: 0 0 10px 0;
        color: var(--text-primary);
        font-size: 1.2rem;
    }

    .skin-info-card p {
        margin: 5px 0;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .sell-calculation {
        background: var(--bg-card);
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
        border: 1px solid var(--border);
    }

    .calculation-row {
        display: flex;
        justify-content: space-between;
        margin: 8px 0;
        font-size: 0.95rem;
    }

    .calculation-row.profit {
        border-top: 1px solid var(--border);
        padding-top: 8px;
        margin-top: 12px;
        font-weight: 800;
        font-size: 1.1rem;
    }

    .calculation-row.profit span:last-child {
        color: var(--positive);
    }

    /* Стили страницы "Мои скины" */
    
    /* Стили для баннера скинов */
    .skins-hero-banner {
        background: linear-gradient(135deg, #1e40af, #3b82f6, #60a5fa, #93c5fd);
        border-radius: 20px;
        padding: 50px 60px;
        margin: 20px 0 50px 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        min-height: 240px;
    }

    .skins-hero-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 25% 40%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 75% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.06) 0%, transparent 50%);
        z-index: 1;
    }

    .skins-hero-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(255,255,255,0.03) 3px, rgba(255,255,255,0.03) 6px),
            repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 6px);
        z-index: 1;
    }

    .skins-hero-content {
        position: relative;
        z-index: 3;
        flex: 1;
        max-width: 65%;
    }

    .skins-hero-icon {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 25px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .skins-hero-icon i {
        font-size: 2.5rem;
        color: #ffffff;
    }

    .skins-hero-title {
        font-size: 3.2rem;
        font-weight: 900;
        color: #ffffff;
        margin: 0 0 20px 0;
        line-height: 1.2;
        -webkit-text-stroke: 0.5px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .skins-hero-subtitle {
        font-size: 1.2rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.85);
        margin: 0 0 30px 0;
        line-height: 1.5;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .skins-hero-decoration {
        position: relative;
        z-index: 2;
        flex: 1;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        max-width: 35%;
    }

    .skins-weapon {
        width: 780px;
        height: auto;
        object-fit: contain;
        transform: rotate(-15deg) scale(1.65);
        opacity: 0.95;
        position: relative;
        right: -270px;
        top: 27px;
    }

    .skins-stats-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }

    .skins-stat-card {
        background: #131213;
        border-radius: 15px;
        padding: 25px;
        display: flex;
        align-items: center;
        gap: 20px;
        border: 1px solid var(--border);
    }

    .skins-stat-card .stat-icon {
        width: 60px;
        height: 60px;
        background: var(--accent);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
    }

    .skins-stat-card .stat-content h3 {
        font-size: 2rem;
        font-weight: 900;
        color: var(--text-primary);
        margin: 0;
    }

    .skins-stat-card .stat-content p {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin: 5px 0 0 0;
        font-weight: 600;
    }

    .skins-main-content {
        display: grid;
        grid-template-columns: 350px 1fr;
        gap: 30px;
    }

    /* Адаптивность для страницы скинов */
    @media (max-width: 768px) {
        .skins-main-content {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .skins-stats-cards {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .skins-page-header h1 {
            font-size: 2.5rem;
        }

        .skins-page-header p {
            font-size: 1rem;
        }

        .skins-grid {
            grid-template-columns: 1fr;
        }

        .skins-sidebar {
            order: 2;
        }

        .skins-grid-section {
            order: 1;
        }

        .skins-grid-header {
            flex-direction: column;
            gap: 15px;
            align-items: stretch;
        }

        .skins-filter select {
            min-width: auto;
            width: 100%;
        }
    }

    .skins-sidebar {
        background: #131213;
        border-radius: 15px;
        padding: 25px;
        height: fit-content;
        border: 1px solid var(--border);
    }

    .add-skin-section h3 {
        font-size: 1.5rem;
        font-weight: 800;
        color: #ffffff;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .skins-grid-section {
        background: #131213;
        border-radius: 15px;
        padding: 25px;
        border: 1px solid var(--border);
        height: fit-content;
        max-height: 700px;
        overflow-y: auto;
    }

    /* Стилизация скроллбара для секции скинов */
    .skins-grid-section::-webkit-scrollbar {
        width: 8px;
    }

    .skins-grid-section::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
    }

    .skins-grid-section::-webkit-scrollbar-thumb {
        background: #666666;
        border-radius: 4px;
    }

    .skins-grid-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--border);
    }

    .skins-grid-header h3 {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--text-primary);
        margin: 0;
    }

    .skins-filter select {
        min-width: 200px;
    }

    .skins-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
    }

    .skin-card {
        background: #1a1a1a;
        border-radius: 15px;
        padding: 20px;
        border: 1px solid var(--border);
        position: relative;
        overflow: hidden;
    }

    .skin-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }

    .skin-name {
        font-size: 1.2rem;
        font-weight: 800;
        color: var(--text-primary);
        margin: 0;
        line-height: 1.3;
    }

    .skin-quality {
        background: var(--accent);
        color: white;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
    }

    .skin-price {
        font-size: 1.5rem;
        font-weight: 900;
        color: var(--positive);
        margin: 10px 0;
    }

    .skin-date {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 15px;
    }

    .skin-actions {
        display: flex;
        gap: 10px;
    }

    .skin-actions .btn {
        flex: 1;
        padding: 10px;
        font-size: 0.9rem;
    }

    .btn-sell {
        background: var(--positive);
        color: white;
        border: none;
    }

    .empty-skins {
        text-align: center;
        padding: 80px 20px;
        color: var(--text-secondary);
    }

    .empty-skins i {
        font-size: 5rem;
        margin-bottom: 25px;
        opacity: 0.6;
        color: var(--accent);
    }

    .empty-skins h3 {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 15px;
    }

    .empty-skins p {
        font-size: 1.1rem;
        line-height: 1.6;
        max-width: 400px;
        margin: 0 auto;
    }



    .empty-skins h3 {
        margin-bottom: 10px;
    }

    .empty-skins p {
        font-size: 1rem;
    }

    /* Адаптивность для страницы скинов */
    @media (max-width: 768px) {
        .skins-main-content {
            grid-template-columns: 1fr;
        }

        .skins-stats-cards {
            grid-template-columns: 1fr;
        }

        .skins-grid-header {
            flex-direction: column;
            gap: 15px;
            align-items: stretch;
        }

        .skins-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Стили главной страницы - Баннер в голубом стиле */
    .hero-banner {
        background: linear-gradient(135deg, #1e3a8a, #3b82f6, #60a5fa, #93c5fd);
        border-radius: 20px;
        padding: 50px 60px;
        margin: 20px 0 50px 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        min-height: 200px;
    }

    .hero-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
            radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.04) 0%, transparent 50%);
        z-index: 1;
    }

    .hero-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(255,255,255,0.02) 2px, rgba(255,255,255,0.02) 4px),
            repeating-linear-gradient(-45deg, transparent, transparent 2px, rgba(255,255,255,0.01) 2px, rgba(255,255,255,0.01) 4px);
        z-index: 1;
    }

    .hero-content {
        position: relative;
        z-index: 3;
        flex: 1;
        max-width: 50%;
        padding-right: 20px;
    }

    .hero-title {
        font-size: 3.5rem;
        font-weight: 900;
        color: #ffffff;
        margin-bottom: 20px;
        line-height: 1.2;
        -webkit-text-stroke: 0.5px;
    }

    .hero-brand {
        color: #ffffff;
        font-weight: 900;
        opacity: 0.95;
    }

    .hero-subtitle {
        font-size: 1.3rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 30px;
        line-height: 1.5;
    }

    .hero-btn {
        background: #f8f9fa;
        color: #212529;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 18px 35px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .hero-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        background: #ffffff;
        border-color: rgba(255, 255, 255, 0.3);
    }

    .hero-decoration {
        position: absolute;
        top: -50px;
        right: -100px;
        width: 600px;
        height: 400px;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        opacity: 0.9;
    }

    .hero-weapon {
        width: 780px;
        height: auto;
        object-fit: contain;
        transform: rotate(-15deg) scale(1.65);
        opacity: 0.95;
        position: relative;
        right: -105px;
        top: 27px;
    }

    /* Большая карточка-контейнер */
    .main-section-card {
        background: #131213;
        border: 1px solid #333333;
        border-radius: 20px;
        padding: 40px;
        margin-top: 40px;
        display: flex;
        gap: 40px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .main-section-left {
        flex: 2;
    }

    .main-section-right {
        flex: 1;
        background: #000000;
        padding: 40px 30px;
        margin: -40px -40px -40px 0px;
        border-top-right-radius: 20px;
        border-bottom-right-radius: 20px;
        border-left: 1px solid rgba(255, 255, 255, 0.1);
    }

    .main-section-right h4 {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 25px;
        text-align: center;
    }

    .home-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin: 0;
        padding: 0;
    }

    .home-card {
        background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #60a5fa 100%);
        border: none;
        border-radius: 20px;
        padding: 40px 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .home-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: 1;
    }

    .home-card::after {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        opacity: 0;
        transition: all 0.6s ease;
        z-index: 1;
    }

    .home-card:hover {
        transform: translateY(-15px) scale(1.05);
        box-shadow: 0 25px 60px rgba(30, 58, 138, 0.6);
    }

    .home-card:hover::before {
        opacity: 1;
    }

    .home-card:hover::after {
        opacity: 1;
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .home-card-icon {
        font-size: 4.5rem;
        color: #ffffff;
        margin-bottom: 20px;
        transition: all 0.4s ease;
        position: relative;
        z-index: 2;
        text-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .home-card:hover .home-card-icon {
        transform: scale(1.2) rotate(5deg);
        text-shadow: 0 6px 25px rgba(0,0,0,0.5);
    }

    .home-card h3 {
        font-size: 1.8rem;
        font-weight: 900;
        color: #ffffff;
        margin-bottom: 12px;
        -webkit-text-stroke: 0.5px;
        position: relative;
        z-index: 2;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .home-card p {
        font-size: 1.1rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.9);
        margin: 0;
        line-height: 1.5;
        position: relative;
        z-index: 2;
        text-shadow: 0 1px 5px rgba(0,0,0,0.2);
    }

    .home-card:hover h3 {
        color: #ffffff;
        text-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }

    .home-card:hover p {
        color: #ffffff;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    /* Телеграм ссылки */
    .telegram-links {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .telegram-link {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
        border: 1px solid #333333;
        border-radius: 10px;
        text-decoration: none;
        color: #ffffff;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        font-size: 0.9rem;
    }

    .telegram-link:hover {
        transform: translateY(-3px) scale(1.02);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        background: linear-gradient(135deg, #333333, #2a2a2a);
        border-color: #555555;
    }

    /* YouTube ссылки */
    .youtube-link {
        background: linear-gradient(135deg, #2a2a2a, #1a1a1a) !important;
        border: 1px solid #333333 !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
    }

    .youtube-link:hover {
        background: linear-gradient(135deg, #333333, #2a2a2a) !important;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4) !important;
        border-color: #555555 !important;
        transform: translateY(-3px) scale(1.02) !important;
    }

    .telegram-link i {
        font-size: 1.4rem;
        min-width: 24px;
        transition: all 0.3s ease;
    }

    .telegram-link:hover i {
        transform: scale(1.1);
    }

    .telegram-link div {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .tg-title {
        font-size: 0.9rem;
        font-weight: 700;
        color: #ffffff;
        line-height: 1.2;
    }

    .tg-desc {
        font-size: 0.75rem;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.7);
        line-height: 1.1;
    }

    /* Адаптивность для баннера */
    @media (max-width: 768px) {
        .hero-banner {
            flex-direction: column;
            text-align: center;
            padding: 40px 30px;
        }

        .hero-content {
            max-width: 100%;
            margin-bottom: 30px;
        }

        .hero-title {
            font-size: 2.5rem;
        }

        .hero-subtitle {
            font-size: 1.1rem;
        }

        .hero-decoration {
            position: relative;
            top: 0;
            right: 0;
            width: 300px;
            height: 150px;
            margin-top: 20px;
            justify-content: center;
        }

        .hero-weapon {
            width: 350px;
            transform: rotate(-10deg) scale(1.0);
            right: 0;
            top: 0;
        }

        .main-section-card {
            flex-direction: column;
            gap: 30px;
            padding: 30px 20px;
        }

        .main-section-right {
            background: #000000;
            padding: 30px 20px;
            margin: 0px -30px -30px -30px;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            border-top-left-radius: 0px;
            border-top-right-radius: 0px;
            border-left: none;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .home-cards {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .telegram-links {
            gap: 8px;
        }

        .telegram-link {
            padding: 10px 14px;
            font-size: 0.85rem;
        }

        .telegram-link i {
            font-size: 1.2rem;
            min-width: 20px;
        }

        .tg-title {
            font-size: 0.8rem;
        }

        .tg-desc {
            font-size: 0.7rem;
        }
    }

    /* Стили для страницы статистики - Hero Banner */
    .statistics-hero-banner {
        background: linear-gradient(135deg, #1e40af, #3b82f6, #60a5fa, #93c5fd);
        border-radius: 20px;
        padding: 50px 60px;
        margin: 20px 0 50px 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        min-height: 240px;
    }

    /* Стили для dashboard hero баннера */
    .dashboard-hero-banner {
        background: linear-gradient(135deg, #1e40af, #3b82f6, #60a5fa, #93c5fd);
        border-radius: 20px;
        padding: 50px 60px;
        margin: 20px 0 30px 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        min-height: 240px;
    }

    .dashboard-hero-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 25% 40%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 75% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.06) 0%, transparent 50%);
        z-index: 1;
    }

    .dashboard-hero-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(255,255,255,0.03) 3px, rgba(255,255,255,0.03) 6px),
            repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 6px);
        z-index: 1;
    }

    .dashboard-hero-content {
        position: relative;
        z-index: 3;
        flex: 1;
        max-width: 65%;
    }

    .dashboard-hero-icon {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 25px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .dashboard-hero-icon i {
        font-size: 2.5rem;
        color: #ffffff;
    }

    .dashboard-hero-title {
        font-size: 3.2rem;
        font-weight: 900;
        color: #ffffff;
        margin: 0 0 20px 0;
        line-height: 1.2;
        -webkit-text-stroke: 0.5px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .dashboard-hero-subtitle {
        font-size: 1.2rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.85);
        margin: 0 0 15px 0;
        line-height: 1.5;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .dashboard-hero-description {
        font-size: 1rem;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.75);
        margin: 0 0 30px 0;
        line-height: 1.6;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .dashboard-hero-decoration {
        position: relative;
        z-index: 2;
        flex: 1;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        max-width: 35%;
    }

    .dashboard-weapon {
        width: 780px;
        height: auto;
        object-fit: contain;
        transform: rotate(-15deg) scale(1.65);
        opacity: 0.95;
        position: relative;
        right: -105px;
        top: 27px;
    }

    /* Стили для calendar hero баннера */
    .calendar-hero-banner {
        background: linear-gradient(135deg, #1e40af, #3b82f6, #60a5fa, #93c5fd);
        border-radius: 20px;
        padding: 30px 40px;
        margin: 20px 0 30px 0;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        min-height: 160px;
    }

    .calendar-hero-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 25% 40%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 75% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.06) 0%, transparent 50%);
        z-index: 1;
    }

    .calendar-hero-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(255,255,255,0.03) 3px, rgba(255,255,255,0.03) 6px),
            repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 6px);
        z-index: 1;
    }

    .calendar-hero-content {
        position: relative;
        z-index: 3;
        flex: 1;
        max-width: 65%;
    }

    .calendar-hero-icon {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .calendar-hero-icon i {
        font-size: 1.8rem;
        color: #ffffff;
    }

    .calendar-hero-title {
        font-size: 2.4rem;
        font-weight: 900;
        color: #ffffff;
        margin: 0 0 12px 0;
        line-height: 1.2;
        -webkit-text-stroke: 0.5px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .calendar-hero-subtitle {
        font-size: 1rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.85);
        margin: 0 0 8px 0;
        line-height: 1.5;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .calendar-hero-description {
        font-size: 0.9rem;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.75);
        margin: 0 0 20px 0;
        line-height: 1.5;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .calendar-hero-decoration {
        position: relative;
        z-index: 2;
        flex: 1;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        max-width: 35%;
    }

    .calendar-weapon {
        width: 500px;
        height: auto;
        object-fit: contain;
        transform: rotate(-15deg) scale(1.2);
        opacity: 0.95;
        position: relative;
        right: -70px;
        top: 15px;
    }

    .statistics-hero-banner::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 25% 40%, rgba(255, 255, 255, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 75% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.06) 0%, transparent 50%);
        z-index: 1;
    }

    .statistics-hero-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(255,255,255,0.03) 3px, rgba(255,255,255,0.03) 6px),
            repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 6px);
        z-index: 1;
    }

    .statistics-hero-content {
        position: relative;
        z-index: 3;
        flex: 1;
        max-width: 65%;
    }

    .statistics-hero-icon {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 25px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .statistics-hero-icon i {
        font-size: 2.5rem;
        color: #ffffff;
    }

    .statistics-hero-title {
        font-size: 3.2rem;
        font-weight: 900;
        color: #ffffff;
        margin: 0 0 20px 0;
        line-height: 1.2;
        -webkit-text-stroke: 0.5px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .statistics-hero-subtitle {
        font-size: 1.2rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.85);
        margin: 0 0 30px 0;
        line-height: 1.5;
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    .statistics-controls {
        display: flex;
        gap: 15px;
        align-items: center;
    }

    .statistics-period-select {
        background: rgba(255, 255, 255, 0.15) !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        font-weight: 600 !important;
        font-size: 1rem !important;
        padding: 12px 18px !important;
        border-radius: 12px !important;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        min-width: 180px;
        transition: all 0.3s ease;
    }

    .statistics-period-select:focus {
        background: rgba(255, 255, 255, 0.25) !important;
        border-color: rgba(255, 255, 255, 0.4) !important;
        box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        outline: none;
    }

    .statistics-period-select option {
        background: #1e40af;
        color: #ffffff;
        font-weight: 600;
        padding: 10px;
    }

    .statistics-hero-decoration {
        position: relative;
        z-index: 2;
        flex: 1;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        max-width: 35%;
    }

    .statistics-weapon {
        width: 780px;
        height: auto;
        object-fit: contain;
        transform: rotate(-15deg) scale(1.65);
        opacity: 0.95;
        position: relative;
        right: -105px;
        top: 27px;
    }



    .statistics-container {
        padding: 0 20px;
    }

    .statistics-section-title {
        color: #ffffff;
        font-size: 1.4rem;
        font-weight: 600;
        margin: 0 0 25px 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .statistics-section-title i {
        color: #007bff;
    }

    .statistics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .statistic-card {
        background: #1a1a1a;
        border: 1px solid #333333;
        border-radius: 15px;
        padding: 25px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .statistic-card:hover {
        border-color: #555555;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .statistic-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(90deg, #007bff, #28a745);
    }

    .profit-card::before {
        background: linear-gradient(90deg, #28a745, #20c997);
    }

    .balance-card::before {
        background: linear-gradient(90deg, #007bff, #6f42c1);
    }

    .average-card::before {
        background: linear-gradient(90deg, #fd7e14, #ffc107);
    }

    .earnings-card::before {
        background: linear-gradient(90deg, #20c997, #17a2b8);
    }

    .success-card::before {
        background: linear-gradient(90deg, #28a745, #198754);
    }

    .percent-card::before {
        background: linear-gradient(90deg, #6f42c1, #e83e8c);
    }

    .statistic-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
    }

    .statistic-header i {
        font-size: 1.3rem;
        color: #007bff;
        background: rgba(0, 123, 255, 0.1);
        padding: 8px;
        border-radius: 8px;
    }

    .statistic-header span {
        color: #cccccc;
        font-size: 0.95rem;
        font-weight: 500;
    }

    .statistic-value {
        font-size: 2.2rem;
        font-weight: 700;
        color: #ffffff;
        margin: 10px 0;
        letter-spacing: -0.5px;
    }

    .statistic-trend {
        font-size: 0.85rem;
        color: #999999;
        font-weight: 400;
    }

    .statistic-trend.positive {
        color: #28a745;
    }

    .statistic-trend.negative {
        color: #dc3545;
    }

    /* Стили для торговой активности */
    .beta-badge {
        background: #007bff;
        color: #ffffff;
        font-size: 0.7rem;
        font-weight: 700;
        padding: 4px 8px;
        border-radius: 6px;
        margin-left: 10px;
        letter-spacing: 0.5px;
        text-transform: uppercase;
    }

    .trading-activity-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .activity-card {
        background: #1a1a1a;
        border: 1px solid #333333;
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .activity-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(90deg, #007bff, #28a745);
    }

    .activity-card.deals-card::before {
        background: linear-gradient(90deg, #28a745, #20c997);
    }

    .activity-card.month-card::before {
        background: linear-gradient(90deg, #007bff, #6f42c1);
    }

    .activity-card.time-card::before {
        background: linear-gradient(90deg, #fd7e14, #ffc107);
    }

    .activity-card:hover {
        border-color: #555555;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .activity-number {
        font-size: 3rem;
        font-weight: 900;
        color: #ffffff;
        margin-bottom: 15px;
        line-height: 1;
        letter-spacing: -1px;
    }

    .activity-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #cccccc;
        margin-bottom: 15px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .activity-subtitle {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.9rem;
        color: #999999;
        font-weight: 500;
    }

    .activity-subtitle span:last-child {
        color: #ffffff;
        font-weight: 700;
    }

    /* Стили для графиков активности */
    .activity-charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
    }

    .activity-chart-card {
        background: #171717;
        border: 1px solid #2a2a2a;
        border-radius: 12px;
        padding: 20px;
        position: relative;
        overflow: hidden;
    }

    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .chart-title {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .chart-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #ffffff;
        line-height: 1;
    }

    .chart-subtitle {
        font-size: 0.9rem;
        color: #999999;
        font-weight: 400;
    }

    .chart-legend {
        display: flex;
        flex-direction: column;
        gap: 8px;
        align-items: flex-end;
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        color: #cccccc;
        font-weight: 500;
    }

    .legend-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }

    .legend-dot.white {
        background: #ffffff;
    }

    .legend-dot.green {
        background: #22c55e;
    }

    .chart-container-activity {
        height: 120px;
        position: relative;
    }

    .chart-container-activity canvas {
        max-height: 100%;
        width: 100% !important;
        height: 100% !important;
    }

    @media (max-width: 768px) {
        .statistics-hero-banner {
            flex-direction: column;
            padding: 40px 30px;
            text-align: center;
            min-height: auto;
        }
        
        .statistics-hero-content {
            max-width: 100%;
            margin-bottom: 30px;
        }
        
        .statistics-hero-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px auto;
        }
        
        .statistics-hero-icon i {
            font-size: 2rem;
        }
        
        .statistics-hero-title {
            font-size: 2.5rem;
        }
        
        .statistics-hero-subtitle {
            font-size: 1.1rem;
        }
        
        .statistics-hero-decoration {
            max-width: 100%;
            justify-content: center;
            overflow: hidden;
        }
        
        .statistics-weapon {
            width: 400px;
            transform: rotate(-10deg) scale(1.2);
            right: -50px;
            top: 10px;
        }
        
        .statistics-period-select {
            min-width: 160px;
            font-size: 0.9rem !important;
            padding: 10px 15px !important;
        }
        
        .statistics-grid {
            grid-template-columns: 1fr;
        }
        
        .statistic-value {
            font-size: 1.8rem;
        }
        
        .statistic-card {
            padding: 20px;
        }
        
        .trading-activity-grid {
            grid-template-columns: 1fr;
        }
        
        .activity-card {
            padding: 25px;
        }
        
        .activity-number {
            font-size: 2.5rem;
        }
        
        .activity-title {
            font-size: 1rem;
        }
        
        .activity-charts-grid {
            grid-template-columns: 1fr;
        }
        
        .activity-chart-card {
            padding: 15px;
        }
        
        .chart-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }
        
        .chart-legend {
            flex-direction: row;
            align-items: flex-start;
            gap: 15px;
        }
        
        .chart-number {
            font-size: 2rem;
        }
    }

    /* Стили для секции количества сделок */
    .deals-count-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .deals-count-card {
        background: #1a1a1a;
        border: 1px solid #333333;
        border-radius: 15px;
        padding: 25px;
        display: flex;
        align-items: center;
        gap: 20px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .deals-count-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .count-icon-square {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        flex-shrink: 0;
    }

    .count-icon-square.day {
        background: linear-gradient(135deg, #28a745, #20c997);
    }

    .count-icon-square.week {
        background: linear-gradient(135deg, #007bff, #17a2b8);
    }

    .count-icon-square.month {
        background: linear-gradient(135deg, #ffc107, #fd7e14);
    }

    .count-icon-square.total {
        background: linear-gradient(135deg, #6f42c1, #e83e8c);
    }

    .count-icon-square::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 6px;
    }

    .count-content {
        display: flex;
        flex-direction: column;
        gap: 5px;
        flex: 1;
    }

    .count-number {
        font-size: 2.2rem;
        font-weight: 700;
        color: #ffffff;
        line-height: 1;
    }

    .count-label {
        font-size: 0.9rem;
        color: #999999;
        font-weight: 500;
    }

    @media (max-width: 768px) {
        .deals-count-grid {
            grid-template-columns: 1fr;
        }
        
        .deals-count-card {
            padding: 20px;
            gap: 15px;
        }
        
        .count-icon-square {
            width: 40px;
            height: 40px;
        }
        
        .count-icon-square::after {
            width: 16px;
            height: 16px;
        }
        
                 .count-number {
             font-size: 1.8rem;
         }
     }

     /* Стили для секции лучших и худших сделок */
     .best-worst-deals-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
         gap: 20px;
         margin-bottom: 30px;
     }

     .deal-card {
         background: #1a1a1a;
         border: 1px solid #333333;
         border-radius: 15px;
         padding: 25px;
         transition: transform 0.2s ease, box-shadow 0.2s ease;
         position: relative;
         overflow: hidden;
     }

     .deal-card::before {
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 4px;
     }

     .deal-card.best-month-card::before {
         background: linear-gradient(90deg, #ffd700, #ffed4e);
     }

     .deal-card.worst-month-card::before {
         background: linear-gradient(90deg, #dc3545, #ff6b7a);
     }

     .deal-card.max-profit-card::before {
         background: linear-gradient(90deg, #28a745, #20c997);
     }

     .deal-card.min-profit-card::before {
         background: linear-gradient(90deg, #6c757d, #adb5bd);
     }

     .deal-card:hover {
         transform: translateY(-2px);
         box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
     }

     .deal-header {
         display: flex;
         align-items: center;
         gap: 15px;
         margin-bottom: 20px;
     }

     .deal-icon {
         width: 45px;
         height: 45px;
         border-radius: 12px;
         display: flex;
         align-items: center;
         justify-content: center;
         font-size: 1.2rem;
         flex-shrink: 0;
     }

     .deal-icon.best {
         background: linear-gradient(135deg, #ffd700, #ffed4e);
         color: #1a1a1a;
     }

     .deal-icon.worst {
         background: linear-gradient(135deg, #dc3545, #ff6b7a);
         color: #ffffff;
     }

     .deal-icon.max {
         background: linear-gradient(135deg, #28a745, #20c997);
         color: #ffffff;
     }

     .deal-icon.min {
         background: linear-gradient(135deg, #6c757d, #adb5bd);
         color: #ffffff;
     }

     .deal-title {
         font-size: 1rem;
         font-weight: 600;
         color: #cccccc;
         line-height: 1.2;
     }

     .deal-amount {
         font-size: 2rem;
         font-weight: 700;
         margin: 15px 0;
         line-height: 1;
     }

     .best-month-card .deal-amount,
     .max-profit-card .deal-amount {
         color: #28a745;
     }

     .worst-month-card .deal-amount {
         color: #dc3545;
     }

     .min-profit-card .deal-amount {
         color: #6c757d;
     }

     .deal-details {
         font-size: 0.9rem;
         color: #999999;
         font-weight: 500;
         line-height: 1.4;
         word-break: break-word;
     }

     @media (max-width: 768px) {
         .best-worst-deals-grid {
             grid-template-columns: 1fr;
         }
         
         .deal-card {
             padding: 20px;
         }
         
         .deal-header {
             gap: 12px;
             margin-bottom: 15px;
         }
         
         .deal-icon {
             width: 40px;
             height: 40px;
             font-size: 1rem;
         }
         
         .deal-amount {
             font-size: 1.6rem;
         }
         
         .deal-title {
             font-size: 0.9rem;
         }
     }

     /* Стили FAQ страницы */
    .faq-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
        padding: 0 10px;
    }

    .faq-header h1 {
        font-size: 3rem;
        font-weight: 900;
        color: var(--accent);
        margin: 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        -webkit-text-stroke: 0.5px;
    }

    .faq-close-btn {
        width: 50px;
        height: 50px;
        background: var(--bg-card);
        border: 2px solid var(--border);
        border-radius: 12px;
        color: var(--text-secondary);
        font-size: 32px;
        font-weight: 900;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        line-height: 1;
    }

    .faq-close-btn:hover {
        background: var(--negative);
        color: #ffffff;
        border-color: var(--negative);
        transform: scale(1.1);
    }

    .faq-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        padding: 0 10px;
    }

    .faq-card {
        background: #111111;
        border: none;
        border-radius: 15px;
        padding: 30px;
        position: relative;
        overflow: hidden;
    }

    .faq-card h3 {
        font-size: 1.4rem;
        font-weight: 900;
        color: var(--accent);
        margin-bottom: 15px;
        line-height: 1.3;
        -webkit-text-stroke: 0.3px;
    }

    .faq-card p {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        line-height: 1.6;
        margin: 0;
        -webkit-text-stroke: 0.2px;
    }

    .faq-card.highlight {
        background: linear-gradient(135deg, #1e3a8a, #3b82f6);
        box-shadow: 0 8px 25px rgba(30, 58, 138, 0.4);
    }

    .faq-card.highlight h3 {
        color: #ffffff;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .faq-card.highlight p {
        color: rgba(255, 255, 255, 0.9);
        text-shadow: 0 1px 4px rgba(0,0,0,0.2);
    }

    /* Адаптивность для FAQ */
    @media (max-width: 768px) {
        .faq-header h1 {
            font-size: 2.2rem;
        }

        .faq-close-btn {
            width: 45px;
            height: 45px;
            font-size: 28px;
        }

        .faq-container {
            grid-template-columns: 1fr;
            gap: 20px;
            padding: 0 5px;
        }

        .faq-card {
            padding: 25px 20px;
        }

        .faq-card h3 {
            font-size: 1.2rem;
        }

        .faq-card p {
            font-size: 0.95rem;
        }
    }

    /* Новые стили календаря */
    .calendar-container {
        display: flex;
        gap: 30px;
        height: calc(100vh - 100px);
        padding: 20px;
    }

    .calendar-main {
        flex: 2;
        background: #111111;
        border-radius: 20px;
        padding: 30px;
        display: flex;
        flex-direction: column;
        min-height: 0;
        overflow: hidden;
    }

    .calendar-sidebar {
        flex: 1;
        background: linear-gradient(135deg, #111111 0%, #1a1a1a 100%);
        border-radius: 20px;
        padding: 30px;
        max-height: 100%;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        border: 1px solid transparent;
    }

    .calendar-header-new {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .calendar-title-new {
        font-size: 2.5rem;
        font-weight: 900;
        color: var(--accent);
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .calendar-nav-btn-new {
        width: 50px;
        height: 50px;
        background: var(--accent);
        border: none;
        border-radius: 12px;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        transition: all 0.3s ease;
    }

    .calendar-nav-btn-new:hover {
        background: #0066ff;
        transform: scale(1.05);
    }

    .calendar-weekdays {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 10px;
        margin-bottom: 15px;
    }

    .calendar-weekday-new {
        padding: 15px 5px;
        background: #222222;
        border-radius: 8px;
        text-align: center;
        font-weight: 800;
        font-size: 0.9rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.8px;
    }

    .calendar-grid-new {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 10px;
        flex: 1;
        align-content: start;
        overflow-y: auto;
        padding-right: 10px;
    }

    /* Кастомный скроллбар для календарной сетки */
    .calendar-grid-new::-webkit-scrollbar {
        width: 8px;
    }

    .calendar-grid-new::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 8px;
        margin: 5px 0;
    }

    .calendar-grid-new::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
        border: 2px solid transparent;
        background-clip: content-box;
    }

    .calendar-grid-new::-webkit-scrollbar-thumb:hover {
        background: #555555;
        background-clip: content-box;
    }

    .calendar-day-new {
        background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
        border-radius: 12px;
        padding: 15px 12px;
        min-height: 80px;
        max-height: none;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        text-align: center;
        border: 1px solid transparent;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .calendar-day-new:hover {
        background: linear-gradient(135deg, #252525 0%, #333333 100%);
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        border-color: #333333;
    }

    .calendar-day-new.today {
        background: linear-gradient(135deg, var(--accent), #0066ff);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
        border-color: rgba(255, 255, 255, 0.2);
        transform: scale(1.02);
    }

    .calendar-day-new.today .calendar-day-number-new {
        color: white;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }

    .calendar-day-new.today .calendar-day-balance {
        background: #ffffff !important;
        color: #1a1a1a !important;
        border: none !important;
        box-shadow: none !important;
        text-shadow: none !important;
    }

    .calendar-day-new.today:hover {
        background: linear-gradient(135deg, #0066ff, var(--accent));
        transform: translateY(-3px) scale(1.02);
        box-shadow: 0 12px 30px rgba(0, 123, 255, 0.5);
    }

    .calendar-day-number-new {
        font-size: 1.6rem;
        font-weight: 900;
        color: var(--text-primary);
        margin: 0;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        line-height: 1;
    }

    .calendar-day-balance {
        font-size: 0.65rem;
        font-weight: 800;
        margin: 0;
        padding: 4px 6px;
        border-radius: 6px;
        min-width: 40px;
        text-transform: uppercase;
        letter-spacing: 0.2px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .calendar-day-balance.profit {
        color: #ffffff;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        border-color: #22c55e;
    }

    .calendar-day-balance.loss {
        color: #ffffff;
        background: linear-gradient(135deg, #ef4444, #dc2626);
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        border-color: #ef4444;
    }

    .calendar-day-balance.neutral {
        color: var(--text-secondary);
        background: linear-gradient(135deg, #374151, #4b5563);
        border-color: #4b5563;
    }

    .calendar-day-new.has-transactions {
        border: 2px solid rgba(0, 123, 255, 0.3);
    }

    .calendar-sidebar-title {
        font-size: 1.5rem;
        font-weight: 900;
        color: var(--accent);
        margin-bottom: 25px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        text-align: center;
    }

    .calendar-transactions-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-height: calc(100% - 80px);
        overflow-y: auto;
        padding-right: 10px;
    }

    /* Скроллбар для правой панели календаря */
    .calendar-transactions-list::-webkit-scrollbar {
        width: 8px;
    }

    .calendar-transactions-list::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 8px;
    }

    .calendar-transactions-list::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 8px;
    }

    .calendar-transactions-list::-webkit-scrollbar-thumb:hover {
        background: var(--border);
    }

    .calendar-transaction-item {
        background: #1a1a1a;
        border-radius: 12px;
        padding: 15px;
        border-left: 4px solid var(--accent);
        transition: all 0.3s ease;
    }

    .calendar-transaction-item:hover {
        background: #252525;
        transform: translateX(5px);
    }

    .calendar-transaction-item.income {
        border-left-color: var(--positive);
    }

    .calendar-transaction-item.expense {
        border-left-color: var(--negative);
    }

    .calendar-transaction-title {
        font-size: 1rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 5px;
    }

    .calendar-transaction-amount {
        font-size: 1.1rem;
        font-weight: 900;
        margin-bottom: 8px;
    }

    .calendar-transaction-amount.income {
        color: var(--positive);
    }

    .calendar-transaction-amount.expense {
        color: var(--negative);
    }

    .calendar-transaction-date {
        font-size: 0.8rem;
        color: var(--text-secondary);
        font-weight: 600;
    }

    .calendar-transaction-type {
        font-size: 0.75rem;
        color: var(--accent);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Адаптивность для календаря */
    @media (max-width: 768px) {
        .calendar-container {
            flex-direction: column;
            gap: 20px;
            height: auto;
        }

        .calendar-main {
            min-height: 500px;
        }

        .calendar-sidebar {
            max-height: 400px;
        }

        .calendar-title-new {
            font-size: 1.8rem;
        }

        .calendar-weekday-new {
            font-size: 0.8rem;
            padding: 12px 5px;
            letter-spacing: 0.5px;
        }

        .calendar-day-new {
            min-height: 60px;
            padding: 10px 8px;
        }

        .calendar-day-number-new {
            font-size: 1.2rem;
        }

        .calendar-day-balance {
            font-size: 0.55rem;
            padding: 3px 5px;
            min-width: 35px;
            letter-spacing: 0.1px;
        }

        .calendar-grid-new {
            padding-right: 5px;
        }

        .calendar-grid-new::-webkit-scrollbar {
            width: 6px;
        }
    }

    /* Стили дашборда в современном стиле */
    .dashboard-cards {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 25px;
        margin-bottom: 40px;
    }

    .dashboard-card {
        background: #f8f9fa;
        border-radius: 20px;
        padding: 30px 25px;
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: 1px solid rgba(255,255,255,0.1);
    }

    .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }

    .dashboard-card.main-balance {
        background: #ffffff;
        color: #1a1a1a;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .dashboard-card.main-balance:hover {
        box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }

    .dashboard-card.main-balance.profit-gradient {
        background: linear-gradient(135deg, #ffffff 0%, #f0fff4 50%, #e6fffa 100%);
        border: 1px solid rgba(34, 197, 94, 0.1);
        box-shadow: 0 4px 20px rgba(34, 197, 94, 0.08);
    }

    .dashboard-card.main-balance.profit-gradient:hover {
        box-shadow: 0 12px 40px rgba(34, 197, 94, 0.15);
    }

    .dashboard-card.main-balance.loss-gradient {
        background: linear-gradient(135deg, #ffffff 0%, #fef2f2 50%, #fee2e2 100%);
        border: 1px solid rgba(239, 68, 68, 0.1);
        box-shadow: 0 4px 20px rgba(239, 68, 68, 0.08);
    }

    .dashboard-card.main-balance.loss-gradient:hover {
        box-shadow: 0 12px 40px rgba(239, 68, 68, 0.15);
    }

    .dashboard-card.income-card {
        background: #1a1a1a;
        color: #ffffff;
        border: none;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }

    .dashboard-card.income-card:hover {
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6);
    }

    .dashboard-card.expense-card {
        background: #1a1a1a;
        color: #ffffff;
        border: none;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }

    .dashboard-card.expense-card:hover {
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6);
    }

    .card-header {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 20px;
        height: 24px;
    }

    .card-icon {
        width: 45px;
        height: 45px;
        background: rgba(0,0,0,0.08);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: #1a1a1a;
    }

    .dashboard-card.income-card .card-icon,
    .dashboard-card.expense-card .card-icon {
        background: rgba(255,255,255,0.15);
        color: #ffffff;
    }

    .card-trend {
        width: 35px;
        height: 35px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
    }

    .card-trend.up {
        background: rgba(34, 197, 94, 0.15);
        color: #22c55e;
    }

    .card-trend.down {
        background: rgba(239, 68, 68, 0.15);
        color: #ef4444;
    }

    .card-content {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .card-value {
        font-size: 2.8rem !important;
        font-weight: 900 !important;
        margin: 0 !important;
        line-height: 1.1;
        letter-spacing: -0.02em;
    }

    .dashboard-card.main-balance .card-value {
        color: #1a1a1a;
        text-shadow: none;
        font-size: 3.2rem !important;
    }

    .dashboard-card.income-card .card-value {
        color: #22c55e;
    }

    .dashboard-card.expense-card .card-value {
        color: #ef4444;
    }

    .card-label {
        font-size: 1.1rem !important;
        font-weight: 700 !important;
        margin: 0 !important;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .dashboard-card.main-balance .card-label {
        color: #64748b;
    }

    .dashboard-card.income-card .card-label,
    .dashboard-card.expense-card .card-label {
        color: #ffffff;
    }

    .card-subtitle {
        font-size: 0.85rem !important;
        font-weight: 500 !important;
        opacity: 0.7;
        margin: 0 !important;
    }

    .dashboard-card.main-balance .card-subtitle {
        color: #94a3b8;
    }

    .dashboard-card.income-card .card-subtitle,
    .dashboard-card.expense-card .card-subtitle {
        color: rgba(255,255,255,0.7);
    }

    /* Стили для кнопки переключения депозитов */
    .deposits-toggle-btn {
        position: absolute;
        top: 16px;
        left: 16px;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #94a3b8;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 10;
    }

    .deposits-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #22c55e;
        transform: scale(1.1);
    }

    .deposits-toggle-btn.active {
        background: rgba(34, 197, 94, 0.2);
        color: #22c55e;
    }

    .deposits-toggle-btn i {
        font-size: 0.9rem;
    }

    /* Подсказка для карточки баланса */
    .deposits-hint {
        font-size: 0.7rem;
        color: rgba(148, 163, 184, 0.6);
        margin-top: 8px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .dashboard-card.main-balance:hover .deposits-hint {
        opacity: 1;
    }

    /* Стили для модального окна депозитов */
    #depositsModal .modal-content {
        max-width: 900px !important;
        width: 95% !important;
    }
    
    .deposits-sections {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-top: 20px;
    }

    .deposits-add-section,
    .deposits-list-section {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 20px;
    }

    .deposits-add-section h4,
    .deposits-list-section h4 {
        color: #22c55e;
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .deposits-add-section h4 i,
    .deposits-list-section h4 i {
        font-size: 0.9rem;
    }

    /* Увеличенные поля ввода для депозитов */
    #depositsModal .form-control {
        font-size: 1.1rem !important;
        padding: 16px 18px !important;
        min-height: 50px;
        border-radius: 10px !important;
    }

    #depositsModal .form-group label {
        font-size: 1rem !important;
        font-weight: 600 !important;
        margin-bottom: 10px !important;
    }

    #depositsModal input[type="number"],
    #depositsModal input[type="text"] {
        font-size: 1.1rem !important;
        font-weight: 500 !important;
    }

    #depositsModal input[type="number"]:focus,
    #depositsModal input[type="text"]:focus {
        transform: scale(1.02);
        transition: all 0.3s ease;
    }

    /* Стильные контейнеры для полей ввода депозитов */
    .deposit-input-container {
        position: relative;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .deposit-input-container:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(34, 197, 94, 0.3);
        box-shadow: 0 0 20px rgba(34, 197, 94, 0.1);
    }

    .deposit-input-container:focus-within {
        background: rgba(255, 255, 255, 0.1);
        border-color: #22c55e;
        box-shadow: 0 0 25px rgba(34, 197, 94, 0.2);
        transform: translateY(-2px);
    }

    .deposit-input {
        background: transparent !important;
        border: none !important;
        padding: 16px 20px !important;
        color: #ffffff !important;
        font-weight: 500 !important;
        border-radius: 12px !important;
    }

    .deposit-input:focus {
        box-shadow: none !important;
        outline: none !important;
        transform: none !important;
    }

    .deposit-input::placeholder {
        color: rgba(148, 163, 184, 0.7) !important;
        font-weight: 400 !important;
    }

    /* Специальные стили для поля даты */
    .deposit-input[type="date"] {
        color-scheme: dark;
    }

    .deposit-input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        cursor: pointer;
        margin-right: 10px;
    }



    .deposits-list-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .deposits-summary {
        font-size: 0.9rem;
        color: #94a3b8;
    }

    .deposits-summary strong {
        color: #22c55e;
        font-weight: 600;
    }

    /* Список депозитов */
    .deposits-list {
        max-height: 450px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
    }

    .deposits-list::-webkit-scrollbar {
        width: 6px;
    }

    .deposits-list::-webkit-scrollbar-track {
        background: transparent;
    }

    .deposits-list::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
    }

    .deposit-item {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
    }

    .deposit-item:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(34, 197, 94, 0.3);
    }

    .deposit-info {
        flex: 1;
    }

    .deposit-amount {
        font-size: 1rem;
        font-weight: 600;
        color: #22c55e;
        margin-bottom: 4px;
    }

    .deposit-comment {
        font-size: 0.85rem;
        color: #94a3b8;
        margin-bottom: 2px;
    }

    .deposit-date {
        font-size: 0.75rem;
        color: rgba(148, 163, 184, 0.7);
    }

    .deposit-actions {
        display: flex;
        gap: 8px;
    }

    .deposit-delete-btn {
        background: rgba(239, 68, 68, 0.2);
        border: none;
        border-radius: 6px;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ef4444;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .deposit-delete-btn:hover {
        background: rgba(239, 68, 68, 0.3);
        transform: scale(1.1);
    }

    .deposit-delete-btn i {
        font-size: 0.8rem;
    }

    /* Адаптивность для депозитов */
    @media (max-width: 768px) {
        #depositsModal .modal-content {
            max-width: 98% !important;
            width: 98% !important;
            margin: 2% auto !important;
        }
        
        .deposits-sections {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .deposits-add-section,
        .deposits-list-section {
            padding: 15px;
        }

        .deposits-list-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
        }

        .deposits-toggle-btn {
            width: 28px;
            height: 28px;
            top: 12px;
            left: 12px;
        }

        .deposits-toggle-btn i {
            font-size: 0.8rem;
        }

        #depositsModal .form-control {
            font-size: 1rem !important;
            padding: 14px 16px !important;
            min-height: 48px;
        }

        .deposit-input-container {
            border-radius: 10px;
        }

        .deposit-input {
            padding: 14px 16px !important;
            border-radius: 10px !important;
        }
    }

    /* Индикатор изменений за день */
    .daily-change {
        margin: 12px 0 8px 0;
    }

    .change-indicator {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        transition: all 0.3s ease;
        width: fit-content;
    }

    .change-indicator.profit {
        background: rgba(34, 197, 94, 0.15);
        color: #22c55e;
        border: 1px solid rgba(34, 197, 94, 0.2);
    }

    .change-indicator.loss {
        background: rgba(239, 68, 68, 0.15);
        color: #ef4444;
        border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .change-indicator.neutral {
        background: rgba(148, 163, 184, 0.15);
        color: #94a3b8;
        border: 1px solid rgba(148, 163, 184, 0.2);
    }

    .change-indicator i {
        font-size: 0.7rem;
        animation: pulse 2s infinite;
    }

    .change-indicator.profit i {
        animation: trendUp 1.5s ease-in-out infinite;
    }

    .change-indicator.loss i {
        animation: trendDown 1.5s ease-in-out infinite;
    }

    .change-text {
        font-size: 0.75rem;
        letter-spacing: 0.3px;
        text-transform: uppercase;
    }

    @keyframes trendUp {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-2px); }
    }

    @keyframes trendDown {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(2px); }
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.6; }
    }

    /* Адаптивность для дашборда */
    @media (max-width: 768px) {
        .dashboard-cards {
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            padding: 25px 20px;
        }

        .card-value {
            font-size: 2.2rem !important;
        }

        .dashboard-card.main-balance .card-value {
            font-size: 2.6rem !important;
        }

        .card-label {
            font-size: 1rem !important;
        }

        .card-subtitle {
            font-size: 0.8rem !important;
        }

        .change-indicator {
            padding: 6px 10px;
            font-size: 0.7rem;
        }

        .change-text {
            font-size: 0.65rem;
        }

        .change-indicator i {
            font-size: 0.6rem;
        }
    }

    /* Исправление видимости иконок в правом меню при открытии модальных окон */
    body.modal-open .right-sidebar .right-nav-btn {
        position: relative !important;
        z-index: 51 !important;
    }

    body.modal-open .right-sidebar .right-nav-btn i {
        position: relative !important;
        z-index: 52 !important;
    }

    /* Notification styles */
    .notification {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(-10px);
        background: var(--bg-card);
        color: var(--text-primary);
        padding: 15px 25px;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        border: 1px solid var(--border);
        z-index: 10000;
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        font-weight: 700;
        font-size: 0.95rem;
        backdrop-filter: blur(10px);
        max-width: 90%;
        text-align: center;
    }

    .notification.success {
        background: var(--positive);
        color: #ffffff;
        border-color: var(--positive);
    }

    .notification.error {
        background: var(--negative);
        color: #ffffff;
        border-color: var(--negative);
    }

    .notification.info {
        background: var(--accent);
        color: #ffffff;
        border-color: var(--accent);
    }


</style>
</head>
<body>
    <!-- Мобильное сообщение о разработке -->
    <div class="mobile-development-message" id="mobileDevelopmentMessage">
        <div class="mobile-dev-icon">
            <i class="fas fa-mobile-alt"></i>
        </div>
        <h1 class="mobile-dev-title">В РАЗРАБОТКЕ</h1>
        <p class="mobile-dev-subtitle">
            Мобильная версия сайта находится в активной разработке. 
            Для полного функционала используйте компьютер или планшет.
        </p>
        <ul class="mobile-dev-features">
            <li><i class="fas fa-chart-line"></i> Анализ прибыли</li>
            <li><i class="fas fa-calendar"></i> Календарь сделок</li>
            <li><i class="fas fa-calculator"></i> Калькулятор трейдера</li>
            <li><i class="fas fa-box"></i> Управление скинами</li>
        </ul>
        <div class="mobile-dev-contact">
            Следите за обновлениями: <a href="https://t.me/res661" target="_blank">@res661</a>
        </div>
    </div>

    <!-- Единая рамка с круглыми внутренними краями -->
    <div class="frame"></div>

    <!-- Левый сайдбар -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-logo" onclick="toggleSidebar()">
                <i class="fas fa-crosshairs"></i>
            </div>
            <div class="sidebar-nav">
                <button class="nav-btn" onclick="setActiveNav(this); showView('dashboard'); collapseSidebar()" data-tooltip="ОБЗОР">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-btn-text">Обзор</span>
                </button>
                <button class="nav-btn" onclick="setActiveNav(this); showView('calendar'); collapseSidebar()" data-tooltip="Календарь">
                    <i class="fas fa-calendar"></i>
                    <span class="nav-btn-text">Календарь</span>
                </button>
                <button class="nav-btn" onclick="setActiveNav(this); openNewTransactionModal(); collapseSidebar()" data-tooltip="Добавить сделку">
                    <i class="fas fa-plus"></i>
                    <span class="nav-btn-text">Добавить</span>
                </button>
                <div class="nav-separator"></div>
                <button class="nav-btn" onclick="setActiveNav(this); showModal('calculatorModal'); collapseSidebar()" data-tooltip="Калькулятор прибыли">
                    <i class="fas fa-calculator"></i>
                    <span class="nav-btn-text">Калькулятор</span>
                </button>
                <button class="nav-btn" onclick="setActiveNav(this); showView('skins'); collapseSidebar()" data-tooltip="Мои скины">
                    <i class="fas fa-box"></i>
                    <span class="nav-btn-text">Мои скины</span>
                </button>
                <div class="nav-separator"></div>

                <div style="margin-top: auto;">
                    <button class="nav-btn" onclick="exportData(); collapseSidebar()" data-tooltip="Экспорт данных">
                        <i class="fas fa-download"></i>
                        <span class="nav-btn-text">Экспорт</span>
                    </button>
                    <button class="nav-btn" onclick="document.getElementById('importFile').click(); collapseSidebar()" data-tooltip="Импорт данных">
                        <i class="fas fa-upload"></i>
                        <span class="nav-btn-text">Импорт</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Правый сайдбар -->
        <div class="right-sidebar">
            <div class="right-sidebar-nav">
                <button class="right-nav-btn" onclick="goToStatistics(this)" data-tooltip="СТАТИСТИКА">
                    <span class="active-line"></span>
                    <i class="fas fa-chart-pie"></i>
                </button>
                <button class="right-nav-btn important" onclick="setActiveRightNav(this); showView('faq')" data-tooltip="FAQ">
                    <span class="red-dot"></span>
                    <span class="active-line"></span>
                    <i class="fas fa-question"></i>
                </button>
            </div>
        </div>

        <!-- Скрытый input для импорта -->
        <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importTransactions(event)">
        
        <!-- Главная область с округлыми краями -->
        <div class="main-area">
            <div class="container">

                <!-- Главная страница -->
        <div id="home" class="view">
            <div class="hero-banner">
                <div class="hero-content">
                    <h1 class="hero-title">Управляй каждой сделкой с <span class="hero-brand">RESOTRADE</span></h1>
                    <p class="hero-subtitle">Записывай покупки и продажи • Анализируй прибыль • Максимизируй доходы</p>
                    <button class="hero-btn" onclick="setActiveNav(document.querySelector('.nav-btn[onclick*=&quot;dashboard&quot;]')); showView('dashboard')">НАЧАТЬ ТРЕЙДИНГ</button>
                </div>
                <div class="hero-decoration">
                    <img src="playside (66) (1).png" alt="АК-47 скин" class="hero-weapon">
                </div>
            </div>
            
            <div class="main-section-card">
                <div class="main-section-left">
                    <div class="home-cards">
                        <div class="home-card" onclick="openNewTransactionModal()">
                            <div class="home-card-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <h3>Создать Сделку</h3>
                            <p>Добавь новую покупку или продажу скина</p>
                        </div>
                        
                        <div class="home-card" onclick="setActiveNav(document.querySelectorAll('.nav-btn')[3]); showView('statistics')">
                            <div class="home-card-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <h3>Статистика</h3>
                            <p>Посмотри свои доходы и расходы</p>
                        </div>
                        
                        <div class="home-card" onclick="setActiveNav(document.querySelectorAll('.nav-btn')[1]); showView('calendar')">
                            <div class="home-card-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <h3>Календарь</h3>
                            <p>Отслеживай сделки по дням</p>
                        </div>
                    </div>
                </div>
                
                <div class="main-section-right">
                    <h4>Наши каналы</h4>
                    <div class="telegram-links">
                        <a href="https://t.me/res661" class="telegram-link" target="_blank">
                            <i class="fab fa-telegram"></i>
                            <div>
                                <span class="tg-title">RES 6️⃣6️⃣1️⃣</span>
                                <span class="tg-desc">Трейдинг и сделки</span>
                            </div>
                        </a>
                        
                        <a href="https://t.me/slavniytrade" class="telegram-link" target="_blank">
                            <i class="fab fa-telegram"></i>
                            <div>
                                <span class="tg-title">Славный трейд</span>
                                <span class="tg-desc">Торговля скинами</span>
                            </div>
                        </a>
                        
                        <a href="https://www.youtube.com/@RESGG661" class="telegram-link youtube-link" target="_blank">
                            <i class="fab fa-youtube"></i>
                            <div>
                                <span class="tg-title">RESGG661</span>
                                <span class="tg-desc">YouTube канал</span>
                            </div>
                        </a>
                        
                        <a href="https://www.youtube.com/@slavniytrade" class="telegram-link youtube-link" target="_blank">
                            <i class="fab fa-youtube"></i>
                            <div>
                                <span class="tg-title">Slavniy Trade</span>
                                <span class="tg-desc">YouTube видео</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

                <!-- Основной дашборд -->
        <div id="dashboard" class="view" style="display: none;">
            <!-- Hero баннер для dashboard -->
            <div class="dashboard-hero-banner">
                <div class="dashboard-hero-content">
                    <div class="dashboard-hero-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h1 class="dashboard-hero-title">Обзор сделок</h1>
                    <p class="dashboard-hero-subtitle">Обзор сделок, баланса, доходов и расходов</p>
                    <p class="dashboard-hero-description">На этой странице отображаются все ваши сделки, текущий баланс, а также график для визуализации прибыли и убытков.<br>Вы также можете добавить депозит, если это необходимо.</p>
                </div>
                <div class="dashboard-hero-decoration">
                    <img src="playside (62) (1).png" alt="Скин обзора" class="dashboard-weapon">
                </div>
            </div>
            
            <!-- Статистические карточки в стиле дашборда -->
            <div class="dashboard-cards">
                <div class="dashboard-card main-balance" onclick="openDepositsModal()">
                    <div class="card-header">
                        <button class="deposits-toggle-btn" onclick="event.stopPropagation(); toggleDepositsDisplay()" title="Показать/скрыть депозиты в балансе">
                            <i id="depositsToggleIcon" class="fas fa-eye"></i>
                        </button>
                        <div class="card-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                    </div>
                    <div class="card-content">
                        <h1 id="totalBalance" class="card-value">$0</h1>
                        <p class="card-label">Общий баланс</p>
                        <div id="dailyChange" class="daily-change">
                            <div class="change-indicator">
                                <i class="fas fa-minus"></i>
                                <span class="change-text">Нет изменений за день</span>
                            </div>
                        </div>
                        <small class="card-subtitle">Итого за все время</small>
                        <div class="deposits-hint">Нажмите для управления депозитами</div>
                    </div>
            </div>

                <div class="dashboard-card income-card">
                    <div class="card-header">
                        <div class="card-trend up">
                            <i class="fas fa-arrow-up"></i>
                </div>
                    </div>
                    <div class="card-content">
                        <h2 id="totalIncome" class="card-value">$0</h2>
                        <p class="card-label">Доходы</p>
                        <small class="card-subtitle">Весь период</small>
                    </div>
                </div>

                <div class="dashboard-card expense-card">
                    <div class="card-header">
                        <div class="card-trend down">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                    </div>
                    <div class="card-content">
                        <h2 id="totalExpense" class="card-value">$0</h2>
                        <p class="card-label">Расходы</p>
                        <small class="card-subtitle">Весь период</small>
                    </div>
                </div>
            </div>

            <!-- График -->
            <div class="card">
                <div class="chart-controls">
                    <div class="chart-controls-right">
                        <button id="toggleChartModeBtn" class="chart-btn" onclick="toggleChartMode()">
                            <i class="fas fa-chart-line"></i>
                            <span>Баланс</span>
                        </button>
                        <button id="togglePointsBtn" class="chart-btn" onclick="togglePoints()">
                            <i class="fas fa-circle"></i>
                            <span>Точки</span>
                        </button>
                        <button id="resetZoomBtn" class="chart-btn" onclick="resetZoom()" title="Приближение: колесо мыши или выделение мышью. Перемещение: Shift + перетаскивание">
                            <i class="fas fa-search-minus"></i>
                            <span>Сброс</span>
                        </button>
                        <div class="period-buttons">
                            <button class="period-btn" onclick="setPeriod('day')" data-period="day">1 день</button>
                            <button class="period-btn active" onclick="setPeriod('week')" data-period="week">7 дней</button>
                            <button class="period-btn" onclick="setPeriod('month')" data-period="month">30 дней</button>
                            <button class="period-btn" onclick="setPeriod('year')" data-period="year">Год</button>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="balanceChart"></canvas>
                </div>
            </div>

            <!-- Поиск и фильтры -->
            <div class="card">
                <div class="controls">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="form-control search-input" placeholder="Поиск транзакций..." onkeyup="searchTransactions()">
                    </div>
                    <select id="sortSelect" class="form-control" onchange="sortTransactions()">
                        <option value="date_desc">Сначала новые</option>
                        <option value="date_asc">Сначала старые</option>
                        <option value="amount_desc">По убыванию суммы</option>
                        <option value="amount_asc">По возрастанию суммы</option>
                        <option value="custom_date">Пользовательский диапазон</option>
                    </select>
                </div>
                
                <!-- Индикатор активного фильтра -->
                <div id="filterIndicator" class="filter-indicator" style="display: none;">
                    <div class="filter-info">
                        <i class="fas fa-filter"></i>
                        <span id="filterText">Активен пользовательский фильтр</span>
                    </div>
                    <button class="filter-reset-btn" onclick="cancelCustomFilter()" title="Сбросить фильтр">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- Список транзакций -->
                <div id="transactionsList" class="transactions-list"></div>
            </div>
        </div>

        <!-- Страница детальной статистики -->
        <div id="statistics" class="view" style="display: none;">
            <div class="statistics-hero-banner">
                <div class="statistics-hero-content">
                    <div class="statistics-hero-icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <h1 class="statistics-hero-title">Детальная статистика</h1>
                    <p class="statistics-hero-subtitle">Полный анализ ваших сделок и финансовых показателей</p>
                    
                    <div class="statistics-controls">
                        <select id="statisticsPeriod" class="form-control statistics-period-select" onchange="updateStatistics()">
                            <option value="all">За все время</option>
                            <option value="month">За месяц</option>
                            <option value="week">За неделю</option>
                            <option value="day">За день</option>
                        </select>
                    </div>
                </div>
                <div class="statistics-hero-decoration">
                    <img src="playside (7) (1).png" alt="Скин статистики" class="statistics-weapon">
                </div>
            </div>
            
            <div class="statistics-container">
                <h3 class="statistics-section-title">
                    <i class="fas fa-chart-line"></i>
                    Основные показатели
                </h3>
                
                <div class="statistics-grid">
                    <div class="statistic-card profit-card">
                        <div class="statistic-header">
                            <i class="fas fa-arrow-up"></i>
                            <span class="statistic-period-label">Профит за период</span>
                        </div>
                        <div class="statistic-value" id="periodProfit">$0</div>
                        <div class="statistic-trend" id="periodProfitTrend"></div>
                    </div>
                    
                    <div class="statistic-card balance-card">
                        <div class="statistic-header">
                            <i class="fas fa-wallet"></i>
                            <span>Общий баланс</span>
                        </div>
                        <div class="statistic-value" id="totalBalanceStat">$0</div>
                        <div class="statistic-trend">Текущее состояние</div>
                    </div>
                    
                    <div class="statistic-card average-card">
                        <div class="statistic-header">
                            <i class="fas fa-calculator"></i>
                            <span>Средний профит на сделку</span>
                        </div>
                        <div class="statistic-value" id="averageProfitPerTrade">$0</div>
                        <div class="statistic-trend" id="averageProfitTrend"></div>
                    </div>
                    
                    <div class="statistic-card earnings-card">
                        <div class="statistic-header">
                            <i class="fas fa-calendar-day"></i>
                            <span>Средний заработок в день</span>
                        </div>
                        <div class="statistic-value" id="averageDailyEarnings">$0</div>
                        <div class="statistic-trend" id="dailyEarningsTrend"></div>
                    </div>
                    
                    <div class="statistic-card success-card">
                        <div class="statistic-header">
                            <i class="fas fa-percentage"></i>
                            <span>Процент успешных сделок</span>
                        </div>
                        <div class="statistic-value" id="successRate">0%</div>
                        <div class="statistic-trend" id="successRateTrend"></div>
                    </div>
                    
                    <div class="statistic-card percent-card">
                        <div class="statistic-header">
                            <i class="fas fa-chart-area"></i>
                            <span>Средний % прибыли на сделку</span>
                        </div>
                        <div class="statistic-value" id="averageProfitPercent">0%</div>
                        <div class="statistic-trend" id="profitPercentTrend"></div>
                    </div>
                </div>
                
                <!-- Секция торговой активности -->
                <h3 class="statistics-section-title">
                    <i class="fas fa-chart-pie"></i>
                    Торговая активность
                    <span class="beta-badge">БЕТА</span>
                </h3>
                
                <div class="trading-activity-grid">
                    <div class="activity-card deals-card">
                        <div class="activity-number" id="totalDealsActivity">0</div>
                        <div class="activity-title">Сделок совершено</div>
                        <div class="activity-subtitle">
                            <span>Дней в трейдинге</span>
                            <span id="activeTradingDays">0</span>
                        </div>
                    </div>
                    
                    <div class="activity-card month-card">
                        <div class="activity-number" id="mostActiveMonth">ЯНВАРЬ</div>
                        <div class="activity-title">Самый активный месяц</div>
                        <div class="activity-subtitle">
                            <span>Сделок совершено</span>
                            <span id="mostActiveMonthDeals">0</span>
                        </div>
                    </div>
                    
                    <div class="activity-card time-card">
                        <div class="activity-number" id="mostProductiveTime">12:00</div>
                        <div class="activity-title">Самое продуктивное время</div>
                        <div class="activity-subtitle">
                            <span>Процент успеха</span>
                            <span id="timeSuccessRate">0%</span>
                        </div>
                    </div>
                </div>
                
                <!-- Графики торговой активности -->
                <h3 class="statistics-section-title">
                    <i class="fas fa-chart-line"></i>
                    Графики активности
                </h3>
                
                <div class="activity-charts-grid">
                    <div class="activity-chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <span class="chart-number" id="avgDailyDeals">2,5</span>
                                <span class="chart-subtitle">Ср. количество сделок в день</span>
                            </div>
                            <div class="chart-legend">
                                <span class="legend-item">
                                    <span class="legend-dot white"></span>
                                    Сделок совершено
                                </span>
                                <span class="legend-item">
                                    <span class="legend-dot green"></span>
                                    Прибыльных
                                </span>
                            </div>
                        </div>
                        <div class="chart-container-activity">
                            <canvas id="dailyActivityChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="activity-chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <span class="chart-number" id="avgWeeklyDeals">5</span>
                                <span class="chart-subtitle">Average weekly deals</span>
                            </div>
                            <div class="chart-legend">
                                <span class="legend-item">
                                    <span class="legend-dot white"></span>
                                    Сделок совершено
                                </span>
                                <span class="legend-item">
                                    <span class="legend-dot green"></span>
                                    Прибыльных
                                </span>
                            </div>
                        </div>
                        <div class="chart-container-activity">
                            <canvas id="weeklyActivityChart"></canvas>
                        </div>
                    </div>
                </div>
                 
                 <!-- Секция количества сделок -->
                 <h3 class="statistics-section-title">
                     <i class="fas fa-chart-bar"></i>
                     Количество сделок
                 </h3>
                 
                 <div class="deals-count-grid">
                     <div class="deals-count-card">
                         <div class="count-icon-square day"></div>
                         <div class="count-content">
                             <div class="count-number" id="dealsToday">0</div>
                             <div class="count-label">Сделок за день</div>
                         </div>
                     </div>
                     
                     <div class="deals-count-card">
                         <div class="count-icon-square week"></div>
                         <div class="count-content">
                             <div class="count-number" id="dealsWeek">0</div>
                             <div class="count-label">Сделок за неделю</div>
                         </div>
                     </div>
                     
                     <div class="deals-count-card">
                         <div class="count-icon-square month"></div>
                         <div class="count-content">
                             <div class="count-number" id="dealsMonth">0</div>
                             <div class="count-label">Сделок за месяц</div>
                         </div>
                     </div>
                     
                     <div class="deals-count-card">
                         <div class="count-icon-square total"></div>
                         <div class="count-content">
                             <div class="count-number" id="dealsTotal">0</div>
                             <div class="count-label">Всего сделок</div>
                         </div>
                     </div>
                 </div>
                 
                 <!-- Секция лучших и худших сделок -->
                 <h3 class="statistics-section-title">
                     <i class="fas fa-trophy"></i>
                     Лучшие и худшие сделки
                 </h3>
                 
                 <div class="best-worst-deals-grid">
                     <div class="deal-card best-month-card">
                         <div class="deal-header">
                             <div class="deal-icon best">
                                 <i class="fas fa-crown"></i>
                             </div>
                             <div class="deal-title">Лучшая сделка месяца</div>
                         </div>
                         <div class="deal-amount" id="bestMonthAmount">$0</div>
                         <div class="deal-details" id="bestMonthDetails">-</div>
                     </div>
                     
                     <div class="deal-card worst-month-card">
                         <div class="deal-header">
                             <div class="deal-icon worst">
                                 <i class="fas fa-triangle-exclamation"></i>
                             </div>
                             <div class="deal-title">Худшая сделка месяца</div>
                         </div>
                         <div class="deal-amount" id="worstMonthAmount">-</div>
                         <div class="deal-details" id="worstMonthDetails">-</div>
                     </div>
                     
                     <div class="deal-card max-profit-card">
                         <div class="deal-header">
                             <div class="deal-icon max">
                                 <i class="fas fa-star"></i>
                             </div>
                             <div class="deal-title">Максимальный профит за сделку</div>
                         </div>
                         <div class="deal-amount" id="maxProfitAmount">$0</div>
                         <div class="deal-details" id="maxProfitDetails">-</div>
                     </div>
                     
                     <div class="deal-card min-profit-card">
                         <div class="deal-header">
                             <div class="deal-icon min">
                                 <i class="fas fa-arrow-down"></i>
                             </div>
                             <div class="deal-title">Минимальный профит за сделку</div>
                         </div>
                         <div class="deal-amount" id="minProfitAmount">$0</div>
                         <div class="deal-details" id="minProfitDetails">-</div>
                     </div>
                 </div>
            </div>
        </div>

        <!-- FAQ страница -->
        <div id="faq" class="view" style="display: none;">
            <div class="faq-header">
                <h1>FAQ — Часто задаваемые вопросы</h1>
                <button class="faq-close-btn" onclick="goHome()">×</button>
            </div>
            
            <div class="faq-container">
                <div class="faq-card">
                    <h3>Вы видите мои сделки?</h3>
                    <p>Нет. Все данные хранятся только у вас в браузере через localStorage. Мы не имеем доступа к вашим сделкам и не передаём данные на сервер.</p>
                </div>

                <div class="faq-card">
                    <h3>Что будет, если я очищу кэш или куки браузера?</h3>
                    <p>Все данные исчезнут. Перед этим обязательно сделайте экспорт в .json, иначе восстановить информацию будет невозможно.</p>
                </div>

                <div class="faq-card">
                    <h3>Как сохранить сделки?</h3>
                    <p>Нажмите кнопку «Экспорт» (в левом меню), чтобы сохранить все сделки в файл .json. Этот файл вы сможете позже импортировать и восстановить все данные.</p>
                </div>

                <div class="faq-card">
                    <h3>Могу ли я перенести сделки на другой ПК?</h3>
                    <p>Да. Сначала сделайте экспорт, затем на другом устройстве используйте кнопку «Импорт», чтобы загрузить файл .json и восстановить ваши данные.</p>
                </div>

                <div class="faq-card">
                    <h3>Почему данные не сохраняются на сервере?</h3>
                    <p>Потому что сайт размещён на GitHub Pages, который поддерживает только статические сайты. Мы не можем и не собираем вашу информацию.</p>
                </div>

                <div class="faq-card">
                    <h3>Это анонимный сервис?</h3>
                    <p>Да. Финансовый трекер полностью оффлайн и анонимный. Всё, что вы записываете, остаётся только у вас в браузере.</p>
                </div>

                <div class="faq-card">
                    <h3>Что делать, если всё пропало?</h3>
                    <p>Если вы случайно удалили кэш/куки или используете другой браузер — данные исчезнут. Поэтому регулярно сохраняйте резервную копию через экспорт.</p>
                </div>
            </div>
        </div>

        <!-- Календарь -->
        <div id="calendar" class="view" style="display: none;">
            <!-- Hero баннер для календаря -->
            <div class="calendar-hero-banner">
                <div class="calendar-hero-content">
                    <div class="calendar-hero-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h1 class="calendar-hero-title">Календарь сделок</h1>
                    <p class="calendar-hero-subtitle">Визуализация транзакций по датам</p>
                    <p class="calendar-hero-description">Просматривайте свои сделки в удобном календарном формате. Каждый день отображает количество и сумму совершенных транзакций.<br>Выберите любую дату для просмотра детальной информации о сделках.</p>
                </div>
                <div class="calendar-hero-decoration">
                    <img src="playside (65) (1).png" alt="Скин календаря" class="calendar-weapon">
                </div>
            </div>
            
            <div class="calendar-container">
                <div class="calendar-main">
                    <div class="calendar-header-new">
                        <button class="calendar-nav-btn-new" onclick="changeMonth(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                        <h2 id="currentMonthNew" class="calendar-title-new"></h2>
                        <button class="calendar-nav-btn-new" onclick="changeMonth(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                    
                    <div class="calendar-weekdays">
                        <div class="calendar-weekday-new">ПН</div>
                        <div class="calendar-weekday-new">ВТ</div>
                        <div class="calendar-weekday-new">СР</div>
                        <div class="calendar-weekday-new">ЧТ</div>
                        <div class="calendar-weekday-new">ПТ</div>
                        <div class="calendar-weekday-new">СБ</div>
                        <div class="calendar-weekday-new">ВС</div>
                        </div>
                    
                    <div id="calendarGridNew" class="calendar-grid-new"></div>
                        </div>
                
                <div class="calendar-sidebar">
                    <h3 class="calendar-sidebar-title">Список сделок</h3>
                    <div id="calendarTransactionsList" class="calendar-transactions-list"></div>
                        </div>
            </div>
        </div>

        <!-- Мои скины -->
        <div id="skins" class="view" style="display: none;">
            <div class="skins-hero-banner">
                <div class="skins-hero-content">
                    <div class="skins-hero-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <h1 class="skins-hero-title">МОИ СКИНЫ</h1>
                    <p class="skins-hero-subtitle">Добавляйте скины, которые вы купили, но ещё не продали. Позже просто укажите продажу — и прибыль автоматически учтётся в балансе.</p>
                </div>
                <div class="skins-hero-decoration">
                    <img src="playside (63) (1).png" alt="Скин коллекции" class="skins-weapon">
                </div>
            </div>

            <div class="skins-stats-cards">
                <div class="skins-stat-card total-skins">
                    <div class="stat-icon">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalSkinsCount">0</h3>
                        <p>Всего скинов</p>
                    </div>
                </div>
                
                <div class="skins-stat-card total-value">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalSkinsValue">$0.00</h3>
                        <p>Общая стоимость</p>
                    </div>
                </div>
                
                <div class="skins-stat-card average-price">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="averageSkinPrice">$0.00</h3>
                        <p>Средняя цена</p>
                    </div>
                </div>
            </div>

            <div class="skins-main-content">
                <div class="skins-sidebar">
                    <div class="add-skin-section">
                        <h3><i class="fas fa-plus"></i> Добавить скин</h3>
                        
                        <div class="form-group">
                            <label>Название скина:</label>
                            <input type="text" id="newSkinName" class="form-control" placeholder="Например: AK-47 | Redline">
                        </div>
                        
                        <div class="form-group">
                            <label>Качество:</label>
                            <select id="newSkinQuality" class="form-control">
                                <option value="FN">Factory New (FN)</option>
                                <option value="MW">Minimal Wear (MW)</option>
                                <option value="FT" selected>Field-Tested (FT)</option>
                                <option value="WW">Well-Worn (WW)</option>
                                <option value="BS">Battle-Scarred (BS)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Цена покупки:</label>
                            <input type="number" id="newSkinPrice" class="form-control" step="0.01" placeholder="0.00">
                        </div>
                        
                        <button class="btn btn-primary" onclick="addNewSkin()">
                            <i class="fas fa-plus"></i> ДОБАВИТЬ СКИН
                        </button>
                    </div>
                </div>

                <div class="skins-grid-section">
                    <div class="skins-grid-header">
                        <h3>Мои скины</h3>
                        <div class="skins-filter">
                            <select id="skinsSort" class="form-control" onchange="loadSkinsGrid()">
                                <option value="date_desc">Сначала новые</option>
                                <option value="date_asc">Сначала старые</option>
                                <option value="price_desc">Дорогие сначала</option>
                                <option value="price_asc">Дешевые сначала</option>
                                <option value="name_asc">По названию А-Я</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="skinsGrid" class="skins-grid">
                        <!-- Скины будут добавлены через JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>



            <!-- Модальное окно транзакции -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('transactionModal')">&times;</span>
                            <h3><i class="fas fa-plus"></i>ДОБАВИТЬ СДЕЛКУ</h3>
            <form id="transactionForm">
                <div class="form-group">
                    <label>Тип транзакции:</label>
                    <select id="transactionType" class="form-control" onchange="toggleTransactionFields()">
                        <option value="simple">Простая транзакция</option>
                        <option value="advanced">Расширенная сделка</option>
                    </select>
                </div>
                
                <!-- Простая транзакция -->
                <div id="simpleFields">
                    <div class="transaction-form-grid">
                    <div class="form-group">
                        <label>Категория:</label>
                        <select id="category" class="form-control">
                            <option value="income">Доход</option>
                            <option value="expense">Расход</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Название:</label>
                        <input type="text" id="transactionName" class="form-control" required>
                    </div>
                    </div>
                    
                    <div class="transaction-form-grid">
                    <div class="form-group">
                        <label>Сумма:</label>
                        <input type="number" id="transactionAmount" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Дата:</label>
                        <input type="date" id="transactionDate" class="form-control" required>
                    </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Описание:</label>
                        <textarea id="transactionDescription" class="form-control"></textarea>
                    </div>
                </div>

                <!-- Расширенная сделка -->
                <div id="advancedFields" style="display: none;">
                    <div class="transaction-form-grid">
                    <div class="form-group">
                        <label>Название скина:</label>
                            <input type="text" id="skinName" class="form-control" placeholder="AK-47 | Redline" required>
                    </div>
                    <div class="form-group">
                        <label>Качество:</label>
                        <select id="skinQuality" class="form-control">
                            <option value="">Не выбрано</option>
                            <option value="Factory New">Factory New</option>
                            <option value="Minimal Wear">Minimal Wear</option>
                            <option value="Field-Tested">Field-Tested</option>
                            <option value="Well-Worn">Well-Worn</option>
                            <option value="Battle-Scarred">Battle-Scarred</option>
                        </select>
                    </div>
                    </div>

                    <div class="transaction-form-grid">
                    <div class="form-group">
                        <label>Цена покупки ($):</label>
                            <input type="number" id="buyPrice" class="form-control" step="0.01" onkeyup="calculateDealProfit()" required>
                    </div>
                    <div class="form-group">
                        <label>Цена продажи ($):</label>
                            <input type="number" id="sellPrice" class="form-control" step="0.01" onkeyup="calculateDealProfit()" required>
                    </div>
                    </div>

                    <div class="transaction-form-grid">
                    <div class="form-group">
                        <label>Комиссия (%):</label>
                        <input type="number" id="commission" class="form-control" value="13" step="0.01" onkeyup="calculateDealProfit()">
                    </div>
                    <div class="form-group">
                        <label>Дата:</label>
                        <input type="date" id="advancedDate" class="form-control" required>
                    </div>
                    </div>

                    <div id="dealResult" style="padding: 15px; background: #000000; border: 1px solid #333333; border-radius: 8px; margin-top: 15px; display: none; color: #ffffff;">
                        <p style="margin: 5px 0; font-weight: 500;">Комиссия: <span id="commissionAmount" style="color: #ff4757; font-weight: 600;">$0</span></p>
                        <p style="margin: 5px 0; font-weight: 500;">Чистая прибыль: <span id="netProfit" style="color: #22c55e; font-weight: 600;">$0</span></p>
                        <p style="margin: 5px 0; font-weight: 500;">Процент прибыли: <span id="profitPercent" style="color: #007bff; font-weight: 600;">0%</span></p>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="hideModal('transactionModal')">ОТМЕНИТЬ</button>
                    <button type="submit" class="btn" onclick="console.log('Кнопка ДОБАВИТЬ нажата!'); submitTransactionForm(); return false;">ДОБАВИТЬ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Модальное окно калькулятора -->
    <div id="calculatorModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('calculatorModal')">&times;</span>
                            <h3><i class="fas fa-calculator"></i> КАЛЬКУЛЯТОР ПРИБЫЛИ</h3>
            <div class="form-group">
                <label>Цена покупки:</label>
                <input type="number" id="calcBuyPrice" class="form-control" step="0.01" onkeyup="calculateProfit()">
            </div>
            <div class="form-group">
                <label>Желаемая прибыль (%):</label>
                <input type="number" id="calcProfitPercent" class="form-control" value="10" onkeyup="calculateProfit()">
            </div>
            <div class="form-group">
                <label>Комиссия площадки (%):</label>
                <input type="number" id="calcCommission" class="form-control" value="13" onkeyup="calculateProfit()">
            </div>
            <div class="calculator-section">
                <h4>Результат:</h4>
                <p>Цена продажи: <span id="calcSellPrice">$0</span></p>
                <p>Чистая прибыль: <span id="calcNetProfit">$0</span></p>
                <p>Комиссия: <span id="calcCommissionAmount">$0</span></p>
            </div>
        </div>
    </div>



    <!-- Модальное окно продажи скина -->
    <div id="sellSkinModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('sellSkinModal')">&times;</span>
            <h3><i class="fas fa-money-bill-wave"></i> ПРОДАТЬ СКИН</h3>
            
            <div id="sellSkinInfo" class="sell-skin-info">
                <!-- Информация о скине будет добавлена через JS -->
            </div>
            
            <div class="form-group">
                <label>Цена продажи:</label>
                <input type="number" id="skinSellPrice" class="form-control" step="0.01" placeholder="0.00" oninput="calculateSellProfit()" onkeyup="calculateSellProfit()">
            </div>
            <div class="form-group">
                <label>Комиссия (%):</label>
                <input type="number" id="sellCommission" class="form-control" step="0.01" value="10" placeholder="10" oninput="calculateSellProfit()" onkeyup="calculateSellProfit()">
            </div>
            <div class="form-group">
                <label>Комментарий:</label>
                <input type="text" id="sellComment" class="form-control" placeholder="Дополнительная информация...">
            </div>
            

            
            <div class="sell-calculation" id="sellCalculation" style="display: block;">
                <div class="calculation-row">
                    <span>Цена продажи:</span>
                    <span id="skinCalcSellPrice">$0.00</span>
                </div>
                <div class="calculation-row">
                    <span>Комиссия:</span>
                    <span id="skinCalcCommissionAmount">$0.00</span>
                </div>
                <div class="calculation-row profit">
                    <span>Чистая прибыль:</span>
                    <span id="skinCalcNetProfit">$0.00</span>
                </div>
            </div>
            
            <div class="form-group">
                <button class="btn" onclick="completeSkinSale()">Продать скин</button>
                <button class="btn btn-secondary" onclick="hideModal('sellSkinModal')">Отмена</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно FAQ -->
    <div id="faqModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('faqModal')">&times;</span>
                            <h3>❓ FAQ</h3>
            <div>
                <h4>Как добавить транзакцию?</h4>
                <p>Нажмите на кнопку "+" в правом нижнем углу и заполните форму.</p>
                
                <h4>Как изменить тему?</h4>
                <p>Нажмите на кнопку "Тема" в правом верхнем углу.</p>
                
                <h4>Как работает калькулятор?</h4>
                <p>Введите цену покупки и желаемую прибыль, калькулятор покажет цену продажи с учетом комиссии.</p>
            </div>

        </div>
    </div>

    <!-- Модальное окно пользовательского диапазона дат -->
    <div id="dateRangeModal" class="modal date-range-modal">
        <div class="modal-content date-range-modal-content">
            <span class="close" onclick="hideModal('dateRangeModal')">&times;</span>
            <h3><i class="fas fa-calendar-alt" style="font-size: 1.2rem; margin-right: 8px;"></i>ПОЛЬЗОВАТЕЛЬСКИЙ ДИАПАЗОН</h3>
            
            <div class="date-range-form-grid">
                <div class="date-range-type-row">
                    <div class="form-group">
                        <label>Тип:</label>
                        <select id="customFilterType" class="form-control">
                            <option value="all">Все транзакции</option>
                            <option value="income">Только доходы</option>
                            <option value="expense">Только расходы</option>
                        </select>
                    </div>
                </div>

                <div class="date-range-dates-row">
                    <div class="form-group">
                        <label>От</label>
                        <input type="date" id="customDateFrom" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label>По</label>
                        <input type="date" id="customDateTo" class="form-control">
                    </div>
                </div>
            </div>

            <div class="date-range-buttons">
                <button type="button" class="btn btn-secondary" onclick="cancelCustomFilter()">ОТМЕНИТЬ</button>
                <button type="button" class="btn" onclick="applyCustomFilter()">ФИЛЬТР</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно подтверждения удаления -->
    <div id="confirmDeleteModal" class="modal">
        <div class="modal-content confirm-delete-modal-content">
            <span class="close" onclick="hideModal('confirmDeleteModal')">&times;</span>
            <div class="confirm-delete-header">
                <div class="confirm-delete-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3>УДАЛИТЬ СДЕЛКУ</h3>
            </div>
            
            <div class="confirm-delete-body">
                <p>Вы уверены, что хотите удалить эту транзакцию?</p>
                <div class="transaction-preview" id="deleteTransactionPreview"></div>
            </div>
            
            <div class="confirm-delete-buttons">
                <button type="button" class="btn btn-secondary" onclick="hideModal('confirmDeleteModal')">ОТМЕНИТЬ</button>
                <button type="button" class="btn btn-danger" onclick="confirmDeleteTransaction()">УДАЛИТЬ</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно подтверждения удаления скина -->
    <div id="confirmDeleteSkinModal" class="modal">
        <div class="modal-content confirm-delete-modal-content">
            <span class="close" onclick="hideModal('confirmDeleteSkinModal')">&times;</span>
            <div class="confirm-delete-header">
                <div class="confirm-delete-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3>УДАЛИТЬ СКИН</h3>
            </div>
            
            <div class="confirm-delete-body">
                <p>Вы уверены, что хотите удалить этот скин из коллекции?</p>
                <div class="transaction-preview" id="deleteSkinPreview"></div>
            </div>
            
            <div class="confirm-delete-buttons">
                <button type="button" class="btn btn-secondary" onclick="hideModal('confirmDeleteSkinModal')">ОТМЕНИТЬ</button>
                <button type="button" class="btn btn-danger" onclick="confirmDeleteSkin()">УДАЛИТЬ</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно депозитов -->
    <div id="depositsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('depositsModal')">&times;</span>
            <h3><i class="fas fa-piggy-bank"></i>УПРАВЛЕНИЕ ДЕПОЗИТАМИ</h3>
            
            <div class="deposits-sections">
                <!-- Секция добавления депозита -->
                <div class="deposits-add-section">
                    <h4><i class="fas fa-plus"></i> Добавить депозит</h4>
                    <form id="depositForm" onsubmit="addDeposit(event)">
                        <div class="form-group">
                            <label for="depositAmount">Сумма депозита</label>
                            <div class="deposit-input-container">
                                <input type="number" id="depositAmount" class="form-control deposit-input" step="0.01" required placeholder="Введите сумму...">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="depositComment">Комментарий</label>
                            <div class="deposit-input-container">
                                <input type="text" id="depositComment" class="form-control deposit-input" placeholder="Например: Пополнение Steam кошелька...">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="depositDate">Дата</label>
                            <div class="deposit-input-container">
                                <input type="date" id="depositDate" class="form-control deposit-input" required>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> ДОБАВИТЬ ДЕПОЗИТ
                        </button>
                    </form>
                </div>
                
                <!-- Секция списка депозитов -->
                <div class="deposits-list-section">
                    <div class="deposits-list-header">
                        <h4><i class="fas fa-list"></i> Список депозитов</h4>
                        <div class="deposits-summary">
                            <span>Общая сумма: <strong id="totalDepositsAmount">$0</strong></span>
                        </div>
                    </div>
                    <div id="depositsList" class="deposits-list"></div>
                </div>
            </div>
        </div>
    </div>

            </div>
        </div>

    <script>
        // Проверка мобильных устройств
        function isMobileDevice() {
            return (
                window.innerWidth <= 768 ||
                /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                'ontouchstart' in window ||
                navigator.maxTouchPoints > 0
            );
        }

        // Показать мобильное сообщение если нужно
        function checkMobileAndShowMessage() {
            const mobileMessage = document.getElementById('mobileDevelopmentMessage');
            const isMobile = isMobileDevice();
            
            if (isMobile && mobileMessage) {
                mobileMessage.style.display = 'flex';
                console.log('🔎 Обнаружено мобильное устройство - показано сообщение о разработке');
                
                // Скрываем основные элементы интерфейса
                const elementsToHide = ['.frame', '.sidebar', '.right-sidebar', '.main-area'];
                elementsToHide.forEach(selector => {
                    const element = document.querySelector(selector);
                    if (element) {
                        element.style.display = 'none';
                    }
                });
            } else if (mobileMessage) {
                mobileMessage.style.display = 'none';
            }
        }

        // Проверяем сразу при загрузке
        checkMobileAndShowMessage();
        
        // Проверяем при изменении размера окна
        window.addEventListener('resize', checkMobileAndShowMessage);

        // Глобальные переменные
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let skins = JSON.parse(localStorage.getItem('skins')) || [];
        let deposits = JSON.parse(localStorage.getItem('deposits')) || [];
        let depositsEnabled = JSON.parse(localStorage.getItem('depositsEnabled')) || false;
        let chart = null;
        let currentView = 'list';
        let currentMonth = new Date();
        let chartMode = 'balance'; // 'balance' или 'profitloss'
        let currentCustomFilter = JSON.parse(localStorage.getItem('currentCustomFilter')) || null; // Пользовательский фильтр

        // Функция для получения локальной даты в формате YYYY-MM-DD
        function getLocalDateString(date = new Date()) {
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            const today = getLocalDateString();
            document.getElementById('transactionDate').value = today;
            document.getElementById('advancedDate').value = today;
            
            // Проверяем, что форма существует
            const form = document.getElementById('transactionForm');
            
            // Добавляем альтернативный обработчик на кнопку
            setTimeout(() => {
                const submitBtn = document.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.addEventListener('click', function(e) {
                        // Не препятствуем обычной отправке формы
                    });
                }
            }, 1000);
            
            // Восстанавливаем последнюю открытую страницу или показываем главную
            const savedView = localStorage.getItem('currentView') || 'home';
            showView(savedView);
            
            // Устанавливаем активную навигацию в зависимости от страницы
            if (savedView === 'dashboard') {
                setActiveNav(document.querySelector('.nav-btn[onclick*="dashboard"]'));
            } else if (savedView === 'calendar') {
                setActiveNav(document.querySelector('.nav-btn[onclick*="calendar"]'));
            } else if (savedView === 'skins') {
                setActiveNav(document.querySelector('.nav-btn[onclick*="skins"]'));
            } else if (savedView === 'faq') {
                setActiveRightNav(document.querySelector('.right-nav-btn'));
            } else if (savedView === 'statistics') {
                const statisticsBtn = document.querySelector('[onclick*="goToStatistics"]');
                if (statisticsBtn) {
                    setActiveRightNav(statisticsBtn);
                }
                // Статистика обновится автоматически в showView()
            } else {
                // Убираем активный класс со всех кнопок для home
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.right-nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
            }
            
            updateDashboard();
            initChart();
            updateCalendar();
            loadSkinsGrid();
            updateSkinsStats();
            loadDeposits();
            updateDepositsToggleState();
            
            // Проверяем, что элементы скинов загружены корректно
            console.log('Скины загружены:', skins.length, 'элементов');
            toggleTransactionFields(); // Инициализируем поля формы
            
            // Инициализируем дату депозита
            document.getElementById('depositDate').value = today;
            
            // Инициализируем селект сортировки
            const sortSelect = document.getElementById('sortSelect');
            if (sortSelect && !currentCustomFilter) {
                sortSelect.value = 'date_desc'; // По умолчанию "Сначала новые"
            }
            
            // Если есть активный фильтр после перезагрузки, обновляем селект
            if (currentCustomFilter) {
                updateSortSelectForCustomFilter();
            }
            
            // Обработчики для продажи скинов устанавливаются в функции openSellSkinModal
            // Здесь их убираем, чтобы избежать конфликтов с дублирующимися ID
        });

        // Управление темой
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
            if (chart) updateChartColors();
        }

        // Загрузка темы (по умолчанию черная)
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');

        // Управление модальными окнами
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            document.body.classList.add('modal-open');
            
            // Не сохраняем модальные окна как текущую страницу
            // Они открываются поверх текущей страницы
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            
            // Очищаем форму транзакции при закрытии
            if (modalId === 'transactionModal') {
                document.getElementById('transactionForm').reset();
                const today = getLocalDateString();
                document.getElementById('transactionDate').value = today;
                document.getElementById('advancedDate').value = today;
                document.getElementById('transactionType').value = 'simple';
                toggleTransactionFields();
            }
            
            // Очищаем данные при закрытии модального окна подтверждения удаления
            if (modalId === 'confirmDeleteModal') {
                transactionToDelete = null;
                document.getElementById('deleteTransactionPreview').innerHTML = '';
            }
            
            // Очищаем данные при закрытии модального окна подтверждения удаления скина
            if (modalId === 'confirmDeleteSkinModal') {
                skinToDelete = null;
                document.getElementById('deleteSkinPreview').innerHTML = '';
            }
            
            // Очищаем форму депозитов при закрытии
            if (modalId === 'depositsModal') {
                document.getElementById('depositForm').reset();
                const today = getLocalDateString();
                document.getElementById('depositDate').value = today;
            }
            
            // Проверяем, есть ли другие открытые модальные окна
            const openModals = document.querySelectorAll('.modal[style*="block"]');
            if (openModals.length === 0) {
                document.body.classList.remove('modal-open');
            }
        }

        // Система уведомлений
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = message;
            document.body.appendChild(notification);

            // Показываем уведомление
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);

            // Скрываем через 3 секунды
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(-20px)';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }

        // Управление сайдбаром
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('expanded');
            
            // Добавляем/убираем класс к body для корректного позиционирования main-area
            document.body.classList.toggle('sidebar-expanded', sidebar.classList.contains('expanded'));
            
            // Всегда показываем главную страницу при клике на логотип
            goHome();
        }

        function collapseSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.remove('expanded');
            document.body.classList.remove('sidebar-expanded');
        }

        // Управление активной навигацией
        function setActiveNav(activeBtn) {
            // Убираем активный класс со всех кнопок левого меню
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // Убираем активный класс со всех кнопок правого меню
            document.querySelectorAll('.right-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // Добавляем активный класс к нажатой кнопке
            activeBtn.classList.add('active');
        }

        // Управление активной навигацией правого меню
        function setActiveRightNav(activeBtn) {
            // Убираем активный класс со всех кнопок левого меню
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // Убираем активный класс со всех кнопок правого меню
            document.querySelectorAll('.right-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // Добавляем активный класс к нажатой кнопке
            activeBtn.classList.add('active');
        }

        // Управление видами
        function showView(viewName) {
            const views = ['home', 'dashboard', 'calendar', 'statistics', 'faq', 'skins'];
            views.forEach(view => {
                document.getElementById(view).style.display = view === viewName ? 'block' : 'none';
            });
            
            // Специальная логика для страницы статистики
            if (viewName === 'statistics') {
                // Обновляем статистику при каждом открытии страницы
                updateStatistics();
                
                // Обновляем графики активности
                setTimeout(() => {
                    if (typeof updateActivityCharts === 'function') {
                        updateActivityCharts(transactions);
                    }
                }, 100);
            }
            
            // Специальная логика для календаря
            if (viewName === 'calendar') {
                updateCalendar();
            }
            
            // Специальная логика для страницы скинов
            if (viewName === 'skins') {
                // Обновляем статистику и сетку скинов
                setTimeout(() => {
                    updateSkinsStats();
                    loadSkinsGrid();
                }, 50);
            }
            
            // Сохраняем текущую страницу в localStorage
            localStorage.setItem('currentView', viewName);
        }

        // Функция для возврата на главную страницу
        function goHome() {
            showView('home');
            // Убираем активный класс со всех кнопок левого меню
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // Убираем активный класс со всех кнопок правого меню
            document.querySelectorAll('.right-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
        }

        // Функция для перехода в статистику
        function goToStatistics(button) {
            setActiveRightNav(button);
            showView('statistics');
        }

        // Переключение полей транзакции
        function toggleTransactionFields() {
            const type = document.getElementById('transactionType').value;
            const simpleFields = document.getElementById('simpleFields');
            const advancedFields = document.getElementById('advancedFields');
            
            if (type === 'simple') {
                simpleFields.style.display = 'block';
                advancedFields.style.display = 'none';
            } else {
                simpleFields.style.display = 'none';
                advancedFields.style.display = 'block';
                // Устанавливаем текущую дату для расширенной сделки только если поле пустое
                const advancedDateField = document.getElementById('advancedDate');
                if (!advancedDateField.value) {
                    const today = getLocalDateString();
                    advancedDateField.value = today;
                }
            }
        }

        // Расчет прибыли для расширенной сделки
        function calculateDealProfit() {
            const buyPrice = parseFloat(document.getElementById('buyPrice').value) || 0;
            const sellPrice = parseFloat(document.getElementById('sellPrice').value) || 0;
            const commission = parseFloat(document.getElementById('commission').value) || 0;

            if (buyPrice > 0 && sellPrice > 0) {
                const commissionAmount = sellPrice * (commission / 100);
                const netProfit = sellPrice - buyPrice - commissionAmount;
                const profitPercent = buyPrice > 0 ? ((netProfit / buyPrice) * 100) : 0;

                document.getElementById('commissionAmount').textContent = `$${commissionAmount.toFixed(2)}`;
                document.getElementById('netProfit').textContent = `$${netProfit.toFixed(2)}`;
                document.getElementById('profitPercent').textContent = `${profitPercent.toFixed(2)}%`;
                document.getElementById('dealResult').style.display = 'block';
            } else {
                document.getElementById('dealResult').style.display = 'none';
            }
        }

        // Функция для тестирования сортировки из консоли
        function testSort(sortType) {
            console.log('🧪 Тестирование сортировки:', sortType);
            document.getElementById('sortSelect').value = sortType;
            sortTransactions();
        }

        // Альтернативная функция для отправки формы
        function submitTransactionForm() {
            const transactionType = document.getElementById('transactionType').value;
            
            let transaction;

            if (transactionType === 'simple') {
                transaction = {
                    id: Date.now(),
                    type: document.getElementById('category').value,
                    name: document.getElementById('transactionName').value,
                    amount: parseFloat(document.getElementById('transactionAmount').value),
                    date: document.getElementById('transactionDate').value,
                    description: document.getElementById('transactionDescription').value,
                    transactionType: 'simple'
                };
            } else {
                const buyPrice = parseFloat(document.getElementById('buyPrice').value);
                const sellPrice = parseFloat(document.getElementById('sellPrice').value);
                const commission = parseFloat(document.getElementById('commission').value) || 13;
                const skinName = document.getElementById('skinName').value;
                const advancedDate = document.getElementById('advancedDate').value;

                // Упрощенная валидация
                if (!skinName || skinName.trim() === '') {
                    alert('Введите название скина');
                    return;
                }
                if (!buyPrice || buyPrice <= 0) {
                    alert('Введите цену покупки больше 0');
                    return;
                }
                if (!sellPrice || sellPrice <= 0) {
                    alert('Введите цену продажи больше 0');
                    return;
                }
                if (!advancedDate) {
                    alert('Выберите дату');
                    return;
                }

                const commissionAmount = sellPrice * (commission / 100);
                const netProfit = sellPrice - buyPrice - commissionAmount;

                const quality = document.getElementById('skinQuality').value;
                const fullName = quality ? `${skinName} (${quality})` : skinName;

                transaction = {
                    id: Date.now(),
                    type: 'income',
                    name: fullName,
                    amount: netProfit,
                    date: advancedDate,
                    description: `Сделка: Купил за $${buyPrice.toFixed(2)}, продал за $${sellPrice.toFixed(2)}, комиссия $${commissionAmount.toFixed(2)}`,
                    transactionType: 'advanced',
                    buyPrice: buyPrice,
                    sellPrice: sellPrice,
                    commission: commission,
                    skinName: skinName,
                    quality: quality
                };
            }

            // Проверяем, редактируем ли мы существующую транзакцию
            if (window.editingTransactionId) {
                // Находим индекс редактируемой транзакции
                const editIndex = transactions.findIndex(t => t.id === window.editingTransactionId);
                if (editIndex !== -1) {
                    // Сохраняем оригинальный ID
                    transaction.id = window.editingTransactionId;
                    // Заменяем транзакцию
                    transactions[editIndex] = transaction;
                }
                // Очищаем ID редактирования
                window.editingTransactionId = null;
            } else {
                // Создаем новую транзакцию
                transaction.id = Date.now();
                transactions.push(transaction);
            }

            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            updateDashboard();
            hideModal('transactionModal');
            
            // Сбрасываем заголовок модального окна обратно
            const modalTitle = document.querySelector('#transactionModal h3');
            if (modalTitle) {
                modalTitle.innerHTML = '<i class="fas fa-plus"></i>ДОБАВИТЬ СДЕЛКУ';
            }
            
            document.getElementById('transactionForm').reset();
            document.getElementById('transactionDate').value = getLocalDateString();
            document.getElementById('advancedDate').value = getLocalDateString();
            toggleTransactionFields();
        }

        // Транзакции
        document.getElementById('transactionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            submitTransactionForm();
        });

        // Переменная для хранения ID удаляемой транзакции
        let transactionToDelete = null;

        function deleteTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                transactionToDelete = id;
                
                // Заполняем превью транзакции
                const preview = document.getElementById('deleteTransactionPreview');
                const typeText = transaction.transactionType === 'advanced' ? 'Расширенная сделка' : 'Простая транзакция';
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('ru-RU', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                preview.innerHTML = `
                    <h4>${transaction.name}</h4>
                    <div class="preview-amount ${transaction.type}">
                        ${transaction.type === 'income' ? '+' : '-'}$${Math.abs(transaction.amount).toFixed(2)}
                    </div>
                    <div class="preview-date">
                        <i class="fas fa-calendar-alt"></i> ${formattedDate}
                    </div>
                    <div class="preview-type">${typeText}</div>
                `;
                
                showModal('confirmDeleteModal');
            }
        }

        function confirmDeleteTransaction() {
            if (transactionToDelete) {
                transactions = transactions.filter(t => t.id !== transactionToDelete);
                localStorage.setItem('transactions', JSON.stringify(transactions));
                updateDashboard();
                transactionToDelete = null;
                hideModal('confirmDeleteModal');
            }
        }

        function duplicateTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                // Создаем копию транзакции с новым ID
                const duplicatedTransaction = {
                    ...transaction,
                    id: Date.now() + Math.random(), // Новый уникальный ID
                    date: getLocalDateString() // Устанавливаем сегодняшнюю дату
                };
                
                // Добавляем копию в массив транзакций
                transactions.push(duplicatedTransaction);
                
                // Сохраняем в localStorage
                localStorage.setItem('transactions', JSON.stringify(transactions));
                
                // Обновляем интерфейс
                updateDashboard();
                
                // Показываем уведомление об успешном дублировании
                console.log('Транзакция успешно дублирована');
            }
        }

        function openNewTransactionModal() {
            // Очищаем ID редактирования
            window.editingTransactionId = null;
            
            // Сбрасываем заголовок модального окна
            const modalTitle = document.querySelector('#transactionModal h3');
            if (modalTitle) {
                modalTitle.innerHTML = '<i class="fas fa-plus"></i>ДОБАВИТЬ СДЕЛКУ';
            }
            
            showModal('transactionModal');
        }

        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                // Сохраняем ID редактируемой транзакции
                window.editingTransactionId = id;
                
                // Сначала открываем модальное окно
                showModal('transactionModal');
                
                // Затем с небольшой задержкой настраиваем поля
                setTimeout(() => {
                    if (transaction.transactionType === 'advanced') {
                        document.getElementById('transactionType').value = 'advanced';
                        toggleTransactionFields();
                        
                        // Извлекаем название скина из полного названия
                        let skinName = transaction.skinName || transaction.name;
                        let quality = transaction.quality || '';
                        
                        // Если skinName отсутствует, пытаемся извлечь из name
                        if (!transaction.skinName && transaction.name) {
                            // Убираем качество из названия, если оно есть в скобках в конце
                            const qualityMatch = transaction.name.match(/^(.+?)\s*\(([^)]+)\)$/);
                            if (qualityMatch) {
                                skinName = qualityMatch[1].trim();
                                quality = qualityMatch[2].trim();
                            } else {
                                skinName = transaction.name;
                            }
                        }
                        
                        document.getElementById('skinName').value = skinName;
                        document.getElementById('skinQuality').value = quality;
                        document.getElementById('buyPrice').value = transaction.buyPrice || '';
                        document.getElementById('sellPrice').value = transaction.sellPrice || '';
                        document.getElementById('commission').value = transaction.commission || 13;
                        document.getElementById('advancedDate').value = transaction.date;
                    } else {
                        document.getElementById('transactionType').value = 'simple';
                        toggleTransactionFields();
                        document.getElementById('category').value = transaction.type;
                        document.getElementById('transactionName').value = transaction.name;
                        document.getElementById('transactionAmount').value = transaction.amount;
                        document.getElementById('transactionDate').value = transaction.date;
                        document.getElementById('transactionDescription').value = transaction.description || '';
                    }
                }, 50); // Небольшая задержка для корректной работы
                
                // Изменяем заголовок модального окна для редактирования
                const modalTitle = document.querySelector('#transactionModal h3');
                if (modalTitle) {
                    modalTitle.innerHTML = '<i class="fas fa-edit"></i>РЕДАКТИРОВАТЬ СДЕЛКУ';
                }
            }
        }

        // Обновление дашборда
        function updateDashboard() {
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const expense = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            let balance = income - expense;
            
            // Добавляем депозиты к балансу если включено отображение
            if (depositsEnabled) {
                const totalDeposits = deposits.reduce((sum, d) => sum + d.amount, 0);
                balance += totalDeposits;
            }

            document.getElementById('totalBalance').textContent = `$${balance.toFixed(2)}`;
            document.getElementById('totalIncome').textContent = `$${income.toFixed(2)}`;
            document.getElementById('totalExpense').textContent = `$${expense.toFixed(2)}`;

            updateDailyChange();
            updateFilterIndicator();
            displayTransactions();
            updateChart();
            
            // Обновляем счетчики сделок в статистике
            updateDealsCount(transactions);
            updateBestWorstDeals();
        }

        // Обновление индикатора изменений за день
        function updateDailyChange() {
            const today = getLocalDateString();
            const todayTransactions = transactions.filter(t => t.date === today);
            
            let dailyChange = 0;
            todayTransactions.forEach(t => {
                dailyChange += t.type === 'income' ? t.amount : -t.amount;
            });

            const changeIndicator = document.querySelector('.change-indicator');
            const changeText = document.querySelector('.change-text');
            const changeIcon = changeIndicator.querySelector('i');
            const balanceCard = document.querySelector('.dashboard-card.main-balance');

            // Убираем все классы
            changeIndicator.classList.remove('profit', 'loss', 'neutral');
            if (balanceCard) {
                balanceCard.classList.remove('profit-gradient', 'loss-gradient');
            }

            if (dailyChange > 0) {
                changeIndicator.classList.add('profit');
                changeIcon.className = 'fas fa-trending-up';
                changeText.textContent = `+$${dailyChange.toFixed(0)} за сегодня`;
                if (balanceCard) {
                    balanceCard.classList.add('profit-gradient');
                }
            } else if (dailyChange < 0) {
                changeIndicator.classList.add('loss');
                changeIcon.className = 'fas fa-trending-down';
                changeText.textContent = `$${dailyChange.toFixed(0)} за сегодня`;
                if (balanceCard) {
                    balanceCard.classList.add('loss-gradient');
                }
            } else {
                changeIndicator.classList.add('neutral');
                changeIcon.className = 'fas fa-minus';
                changeText.textContent = todayTransactions.length > 0 ? 'Нулевой результат' : 'Нет сделок сегодня';
                // Карточка остается с обычным белым фоном
            }
        }

        // Отображение транзакций
        function displayTransactions() {
            const container = document.getElementById('transactionsList');
            let sortedTransactions = [...transactions];

            // Применяем пользовательский фильтр
            if (currentCustomFilter) {
                sortedTransactions = sortedTransactions.filter(t => {
                    // Фильтр по типу
                    if (currentCustomFilter.type !== 'all' && t.type !== currentCustomFilter.type) {
                        return false;
                    }
                    
                    // Фильтр по дате
                    const transactionDate = new Date(t.date);
                    const fromDate = new Date(currentCustomFilter.dateFrom);
                    const toDate = new Date(currentCustomFilter.dateTo);
                    
                    return transactionDate >= fromDate && transactionDate <= toDate;
                });
                
                // Для пользовательского фильтра всегда сортируем по дате (новые сначала)
                sortedTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            } else {
                // Применяем обычную сортировку
                const sortSelect = document.getElementById('sortSelect');
                const sortBy = sortSelect ? sortSelect.value : 'date_desc';
                
                switch(sortBy) {
                    case 'date_desc':
                        sortedTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                    case 'date_asc':
                        sortedTransactions.sort((a, b) => new Date(a.date) - new Date(b.date));
                        break;
                    case 'amount_desc':
                        sortedTransactions.sort((a, b) => Math.abs(b.amount) - Math.abs(a.amount));
                        break;
                    case 'amount_asc':
                        sortedTransactions.sort((a, b) => Math.abs(a.amount) - Math.abs(b.amount));
                        break;
                    default:
                        sortedTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                }
            }

            // Применяем поиск
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            if (searchTerm) {
                sortedTransactions = sortedTransactions.filter(t => 
                    t.name.toLowerCase().includes(searchTerm) || 
                    t.description.toLowerCase().includes(searchTerm)
                );
            }

            container.innerHTML = sortedTransactions.map(transaction => {
                const typeText = transaction.transactionType === 'advanced' ? 'Расширенная сделка' : 'Простая транзакция';
                const profitInfo = transaction.transactionType === 'advanced' && transaction.buyPrice && transaction.sellPrice
                    ? `Купил: $${transaction.buyPrice.toFixed(2)} • Продал: $${transaction.sellPrice.toFixed(2)}`
                    : transaction.description;

                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('ru-RU', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });

                const icon = transaction.type === 'income' ? 
                    (transaction.transactionType === 'advanced' ? 'fas fa-chart-line' : 'fas fa-plus') :
                    'fas fa-minus';

                const profitPercent = transaction.transactionType === 'advanced' && transaction.buyPrice && transaction.sellPrice ?
                    (((transaction.amount / transaction.buyPrice) * 100)).toFixed(1) : null;
                
                return `
                    <div class="transaction-item ${transaction.type}">
                        <div class="transaction-content">
                            <div class="transaction-header">
                                <div class="transaction-icon ${transaction.type}">
                                    <i class="${icon}"></i>
                                </div>
                                <div class="transaction-main-info">
                                    <div class="transaction-title-row">
                            <h4>${transaction.name}</h4>
                                        <span class="transaction-type">${typeText}</span>
                        </div>
                                    <div class="transaction-date">
                                        <i class="fas fa-calendar-alt"></i>
                                        ${formattedDate}
                                    </div>
                                </div>
                            </div>
                            ${profitInfo ? `<div class="transaction-description">${profitInfo}</div>` : ''}
                        </div>
                        
                        <div class="transaction-amount-section">
                            <div class="transaction-amount ${transaction.type}">
                                ${transaction.type === 'income' ? '+' : '-'}$${Math.abs(transaction.amount).toFixed(2)}
                            </div>
                            ${profitPercent ? `<div class="transaction-profit-info">${profitPercent}% прибыль</div>` : ''}
                            <div class="transaction-actions">
                                <button class="btn btn-sm btn-secondary" onclick="editTransaction(${transaction.id})" title="Редактировать">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-info" onclick="duplicateTransaction(${transaction.id})" title="Дублировать">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="deleteTransaction(${transaction.id})" title="Удалить">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Загрузка настроек графика
        function loadChartSettings() {
            const pointsEnabled = localStorage.getItem('chartPointsEnabled') === 'true';
            const savedPeriod = localStorage.getItem('chartPeriod') || 'week';
            const savedMode = localStorage.getItem('chartMode') || 'balance';
            
            const pointsBtn = document.getElementById('togglePointsBtn');
            const modeBtn = document.getElementById('toggleChartModeBtn');
            
            if (pointsEnabled) {
                pointsBtn.classList.add('active');
                pointsBtn.querySelector('i').className = 'fas fa-circle';
            } else {
                pointsBtn.classList.remove('active');
                pointsBtn.querySelector('i').className = 'far fa-circle';
            }
            
            // Восстанавливаем режим графика
            chartMode = savedMode;
            if (chartMode === 'profitloss') {
                modeBtn.classList.add('active');
                modeBtn.querySelector('i').className = 'fas fa-chart-bar';
                modeBtn.querySelector('span').textContent = 'П/У';
            } else {
                modeBtn.classList.remove('active');
                modeBtn.querySelector('i').className = 'fas fa-chart-line';
                modeBtn.querySelector('span').textContent = 'Баланс';
            }
            
            // Восстанавливаем выбранный период
            currentPeriod = savedPeriod;
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`[data-period="${savedPeriod}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            return { pointsEnabled };
        }

        // График
        function initChart() {
            const settings = loadChartSettings();
            const ctx = document.getElementById('balanceChart').getContext('2d');
            
            // Создаем градиент для заливки
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(0, 123, 255, 0.3)');    // Сверху более насыщенный
            gradient.addColorStop(0.5, 'rgba(0, 123, 255, 0.12)'); // В середине средний
            gradient.addColorStop(1, 'rgba(0, 123, 255, 0.001)');  // Снизу почти невидимый
            
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Баланс',
                        data: [],
                        borderColor: '#007bff',
                        backgroundColor: gradient,
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: settings.pointsEnabled ? 4 : 0,
                        pointHoverRadius: settings.pointsEnabled ? 6 : 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 13,
                                    weight: '700'
                                },
                                color: '#cccccc',
                                maxRotation: 0,
                                padding: 8
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.08)',
                                lineWidth: 1
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                    size: 14,
                                    weight: '800'
                                },
                                color: '#ffffff',
                                padding: 12,
                                callback: function(value) {
                                    return '$' + value.toFixed(2);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                lineWidth: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        zoom: {
                            zoom: {
                                wheel: {
                                    enabled: true,
                                    speed: 0.1,
                                    modifierKey: null
                                },
                                pinch: {
                                    enabled: true
                                },
                                drag: {
                                    enabled: true,
                                    backgroundColor: 'rgba(0, 123, 255, 0.1)',
                                    borderColor: 'rgba(0, 123, 255, 0.5)',
                                    borderWidth: 1
                                },
                                mode: 'x',
                                rangeMin: {
                                    x: null,
                                    y: null
                                },
                                rangeMax: {
                                    x: null, 
                                    y: null
                                }
                            },
                            pan: {
                                enabled: true,
                                mode: 'x',
                                modifierKey: 'shift',
                                rangeMin: {
                                    x: null,
                                    y: null
                                },
                                rangeMax: {
                                    x: null,
                                    y: null
                                }
                            }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(26, 26, 26, 0.95)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#333333',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: false,
                            titleFont: {
                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                                size: 16,
                                weight: '900'
                            },
                            footerFont: {
                                size: 11,
                                weight: '500'
                            },
                            padding: 12,
                            caretPadding: 8,
                            caretSize: 6,
                            usePointStyle: true,
                            boxPadding: 4,
                            callbacks: {
                                title: function(context) {
                                    const date = new Date(context[0].label);
                                    return date.toLocaleDateString('ru-RU', {
                                        day: '2-digit',
                                        month: 'long',
                                        year: 'numeric'
                                    });
                                },
                                label: function(context) {
                                    const value = context.parsed.y;
                                    const sign = value >= 0 ? '+' : '';
                                    const prefix = chartMode === 'balance' ? 'Баланс: ' : 
                                                  (value >= 0 ? 'Прибыль: ' : 'Убыток: ');
                                    return `${prefix}${sign}$${value.toFixed(2)}`;
                                },
                                labelColor: function(context) {
                                    const value = context.parsed.y;
                                    return {
                                        borderColor: value >= 0 ? '#22c55e' : '#ef4444',
                                        backgroundColor: value >= 0 ? '#22c55e' : '#ef4444',
                                        borderWidth: 3,
                                        borderRadius: 6
                                    };
                                },
                                footer: function(tooltipItems) {
                                    return 'Зажмите Shift + перетащите для панорамирования';
                                }
                            }
                        }
                    }
                }
            });
            updateChart();
        }

        let currentPeriod = 'week'; // По умолчанию 7 дней

        function updateChart() {
            if (!chart) return;

            let filteredTransactions = [...transactions];

            // Фильтр по периоду
            const now = new Date();
                const cutoffDate = new Date();
            
            switch(currentPeriod) {
                case 'day':
                    cutoffDate.setDate(now.getDate() - 1);
                    break;
                    case 'week':
                        cutoffDate.setDate(now.getDate() - 7);
                        break;
                    case 'month':
                    cutoffDate.setDate(now.getDate() - 30);
                        break;
                    case 'year':
                        cutoffDate.setFullYear(now.getFullYear() - 1);
                        break;
                }
                filteredTransactions = transactions.filter(t => new Date(t.date) >= cutoffDate);

            const sortedTransactions = filteredTransactions.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let labels = [];
            let data = [];

            if (chartMode === 'balance') {
                // Режим баланса (накопительный)
            const dailyBalance = {};
            let runningBalance = 0;
            
            sortedTransactions.forEach(transaction => {
                const date = transaction.date;
                if (!dailyBalance[date]) {
                    dailyBalance[date] = runningBalance;
                }
                runningBalance += transaction.type === 'income' ? transaction.amount : -transaction.amount;
                dailyBalance[date] = runningBalance;
            });

                labels = Object.keys(dailyBalance).sort();
                data = labels.map(date => dailyBalance[date]);
                
                // Обновляем подпись оси Y для режима баланса
                chart.options.scales.y.title = {
                    display: true,
                    text: 'Баланс ($)',
                    font: {
                        family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        size: 13,
                        weight: '700'
                    },
                    color: '#ffffff'
                };
            } else {
                // Режим прибылей/убытков (отдельные транзакции)
                labels = sortedTransactions.map(t => t.date);
                data = sortedTransactions.map(t => t.type === 'income' ? t.amount : -t.amount);
                
                // Обновляем подпись оси Y для режима П/У
                chart.options.scales.y.title = {
                    display: true,
                    text: 'Прибыль / Убыток ($)',
                    font: {
                        family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        size: 13,
                        weight: '700'
                    },
                    color: '#ffffff'
                };
                
                // В режиме П/У всегда показываем ноль как базовую линию
                chart.options.scales.y.beginAtZero = true;
            }

            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            
            // Обновляем метку датасета
            chart.data.datasets[0].label = chartMode === 'balance' ? 'Баланс' : 'П/У';
            
            chart.update();
        }

        function updateChartColors() {
            const isDark = document.documentElement.classList.contains('dark');
            const ctx = document.getElementById('balanceChart').getContext('2d');
            
            // Обновляем цвета линии
            chart.data.datasets[0].borderColor = isDark ? '#0d6efd' : '#007bff';
            
            // Создаем новый градиент для текущей темы
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            if (isDark) {
                gradient.addColorStop(0, 'rgba(13, 110, 253, 0.3)');
                gradient.addColorStop(0.5, 'rgba(13, 110, 253, 0.12)');
                gradient.addColorStop(1, 'rgba(13, 110, 253, 0.001)');
            } else {
                gradient.addColorStop(0, 'rgba(0, 123, 255, 0.3)');
                gradient.addColorStop(0.5, 'rgba(0, 123, 255, 0.12)');
                gradient.addColorStop(1, 'rgba(0, 123, 255, 0.001)');
            }
            chart.data.datasets[0].backgroundColor = gradient;
            
            // Обновляем цвета tooltip
            chart.options.plugins.tooltip.backgroundColor = isDark ? '#111111' : '#ffffff';
            chart.options.plugins.tooltip.titleColor = isDark ? '#ffffff' : '#1a1a1a';
            chart.options.plugins.tooltip.bodyColor = isDark ? '#ffffff' : '#1a1a1a';
            chart.options.plugins.tooltip.borderColor = isDark ? '#333333' : '#e5e7eb';
            
            // Обновляем цвета осей
            chart.options.scales.x.ticks.color = isDark ? '#cccccc' : '#666666';
            chart.options.scales.x.grid.color = isDark ? 'rgba(255, 255, 255, 0.08)' : 'rgba(0, 0, 0, 0.08)';
            chart.options.scales.y.ticks.color = isDark ? '#ffffff' : '#1a1a1a';
            chart.options.scales.y.grid.color = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
            
            // Обновляем цвет подписи оси Y
            if (chart.options.scales.y.title) {
                chart.options.scales.y.title.color = isDark ? '#ffffff' : '#1a1a1a';
            }
            
            // Обновляем цвета zoom области
            if (chart.options.plugins.zoom) {
                if (isDark) {
                    chart.options.plugins.zoom.zoom.drag.backgroundColor = 'rgba(13, 110, 253, 0.1)';
                    chart.options.plugins.zoom.zoom.drag.borderColor = 'rgba(13, 110, 253, 0.5)';
                } else {
                    chart.options.plugins.zoom.zoom.drag.backgroundColor = 'rgba(0, 123, 255, 0.1)';
                    chart.options.plugins.zoom.zoom.drag.borderColor = 'rgba(0, 123, 255, 0.5)';
                }
            }
            
            chart.update();
        }

        function togglePoints() {
            if (chart) {
                const dataset = chart.data.datasets[0];
                const btn = document.getElementById('togglePointsBtn');
                const isActive = dataset.pointRadius > 0;
                
                dataset.pointRadius = isActive ? 0 : 4;
                dataset.pointHoverRadius = isActive ? 0 : 6;
                
                // Обновляем внешний вид кнопки
                if (isActive) {
                    btn.classList.remove('active');
                    btn.querySelector('i').className = 'far fa-circle';
                    localStorage.setItem('chartPointsEnabled', 'false');
                } else {
                    btn.classList.add('active');
                    btn.querySelector('i').className = 'fas fa-circle';
                    localStorage.setItem('chartPointsEnabled', 'true');
                }
                
                chart.update();
            }
        }

        function toggleChartMode() {
            const btn = document.getElementById('toggleChartModeBtn');
            
            if (chartMode === 'balance') {
                chartMode = 'profitloss';
                btn.classList.add('active');
                btn.querySelector('i').className = 'fas fa-chart-bar';
                btn.querySelector('span').textContent = 'П/У';
                localStorage.setItem('chartMode', 'profitloss');
            } else {
                chartMode = 'balance';
                btn.classList.remove('active');
                btn.querySelector('i').className = 'fas fa-chart-line';
                btn.querySelector('span').textContent = 'Баланс';
                localStorage.setItem('chartMode', 'balance');
            }
            
            updateChart();
        }

        function resetZoom() {
            if (chart) {
                chart.resetZoom();
            }
        }

        function setPeriod(period) {
            currentPeriod = period;
            
            // Сохраняем выбранный период
            localStorage.setItem('chartPeriod', period);
            
            // Обновляем активную кнопку
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-period="${period}"]`).classList.add('active');
            
            updateChart();
        }

        // Поиск и сортировка
        function searchTransactions() {
            updateFilterIndicator();
            displayTransactions();
        }

                function sortTransactions() {
            const sortBy = document.getElementById('sortSelect').value;
            
            if (sortBy === 'custom_date') {
                // Сбрасываем селект обратно, чтобы можно было выбрать снова
                setTimeout(() => {
                    if (currentCustomFilter) {
                        updateSortSelectForCustomFilter();
                    } else {
                        document.getElementById('sortSelect').value = 'date_desc';
                    }
                }, 100);
                
                showModal('dateRangeModal');
                // Устанавливаем текущую дату в поля
                const today = getLocalDateString();
                document.getElementById('customDateFrom').value = today;
                document.getElementById('customDateTo').value = today;
            } else if (sortBy === 'custom_active') {
                // Если выбрана активная опция фильтра - открываем окно для изменения
                showModal('dateRangeModal');
                // Заполняем поля текущими значениями фильтра
                if (currentCustomFilter) {
                    document.getElementById('customFilterType').value = currentCustomFilter.type;
                    document.getElementById('customDateFrom').value = currentCustomFilter.dateFrom;
                    document.getElementById('customDateTo').value = currentCustomFilter.dateTo;
                }
            } else {
                // ВАЖНО: Сбрасываем пользовательский фильтр для обычной сортировки
                if (currentCustomFilter) {
                    currentCustomFilter = null;
                    localStorage.removeItem('currentCustomFilter');
                    resetSortSelectFromCustomFilter();
                    updateFilterIndicator();
                }
            }
            
            // Всегда обновляем отображение транзакций для применения сортировки
            // (кроме случаев открытия модального окна)
            if (sortBy !== 'custom_date' && sortBy !== 'custom_active') {
                displayTransactions();
            }
        }

        // Календарь
        function updateCalendar() {
            const monthNames = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь',
                'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];
            
            // Рассчитываем общую сумму за месяц
            const monthlyBalance = calculateMonthlyBalance(currentMonth.getFullYear(), currentMonth.getMonth());
            const balanceText = monthlyBalance > 0 ? `+$${monthlyBalance.toFixed(0)}` : 
                               monthlyBalance < 0 ? `$${monthlyBalance.toFixed(0)}` : '$0';
            
            // Обновляем заголовок месяца с общей суммой
            document.getElementById('currentMonthNew').innerHTML = 
                `${monthNames[currentMonth.getMonth()]} ${currentMonth.getFullYear()} <span style="color: #ffffff; font-weight: 600; margin-left: 20px;">${balanceText}</span>`;

            const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const lastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);

            const calendar = document.getElementById('calendarGridNew');
            calendar.innerHTML = '';

            // Пустые дни в начале
            const startPadding = (firstDay.getDay() || 7) - 1;
            for (let i = 0; i < startPadding; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day-new';
                emptyDay.style.opacity = '0.3';
                calendar.appendChild(emptyDay);
            }

            // Дни месяца
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const date = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
                const dateStr = getLocalDateString(date);
                const dayTransactions = getTransactionsForDate(dateStr);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day-new';

                // Проверяем, является ли день сегодняшним
                const today = getLocalDateString();
                const isToday = dateStr === today;

                if (isToday) {
                    dayElement.classList.add('today');
                }
                
                if (dayTransactions.length > 0) {
                    dayElement.classList.add('has-transactions');
                }

                // Создаем содержимое дня
                let dayContent = `<div class="calendar-day-number-new">${day}</div>`;
                
                // Рассчитываем баланс за день
                let dayBalance = 0;
                dayTransactions.forEach(t => {
                    dayBalance += t.type === 'income' ? t.amount : -t.amount;
                });
                
                // Добавляем сумму
                if (dayBalance > 0) {
                    dayContent += `<div class="calendar-day-balance profit">+$${dayBalance.toFixed(0)}</div>`;
                } else if (dayBalance < 0) {
                    dayContent += `<div class="calendar-day-balance loss">$${dayBalance.toFixed(0)}</div>`;
                } else if (dayTransactions.length > 0) {
                    // Есть транзакции, но баланс равен нулю
                    dayContent += `<div class="calendar-day-balance neutral">$0</div>`;
                } else {
                    dayContent += '<div></div>'; // Пустой элемент для выравнивания
                }

                dayElement.innerHTML = dayContent;

                // Клик по дню для фильтрации транзакций
                dayElement.onclick = () => filterTransactionsByDay(dateStr, day);
                
                calendar.appendChild(dayElement);
            }
            
            // Показываем все транзакции месяца в боковой панели
            showMonthTransactions();
        }

        // Рассчитать общий баланс за месяц
        function calculateMonthlyBalance(year, month) {
            return transactions
                .filter(t => {
                    const date = new Date(t.date);
                    return date.getFullYear() === year && date.getMonth() === month;
                })
                .reduce((total, t) => total + (t.type === 'income' ? t.amount : -t.amount), 0);
        }

        // Показать транзакции месяца в правой панели
        function showMonthTransactions() {
            const monthTransactions = transactions.filter(t => {
                const date = new Date(t.date);
                return date.getFullYear() === currentMonth.getFullYear() && 
                       date.getMonth() === currentMonth.getMonth();
            }).sort((a, b) => new Date(b.date) - new Date(a.date));

            displayCalendarTransactions(monthTransactions, 'Все сделки месяца');
        }

        // Фильтровать транзакции по дню
        function filterTransactionsByDay(date, day) {
            const dayTransactions = getTransactionsForDate(date);
            const monthNames = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня',
                'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];
            
            const title = dayTransactions.length > 0 ? 
                `Сделки за ${day} ${monthNames[currentMonth.getMonth()]}` : 
                'Сделок нет';
            
            displayCalendarTransactions(dayTransactions, title);
        }

        // Отобразить транзакции в правой панели
        function displayCalendarTransactions(transactionsList, title) {
            const container = document.getElementById('calendarTransactionsList');
            const titleElement = document.querySelector('.calendar-sidebar-title');
            
            titleElement.textContent = title;
            
            if (transactionsList.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); margin-top: 50px;">
                        <i class="fas fa-calendar-times" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>Транзакций не найдено</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = transactionsList.map(transaction => {
                const typeText = transaction.transactionType === 'advanced' ? 'Расширенная сделка' : 'Простая транзакция';
                const date = new Date(transaction.date);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}`;
                
                return `
                    <div class="calendar-transaction-item ${transaction.type}">
                        <div class="calendar-transaction-title">${transaction.name}</div>
                        <div class="calendar-transaction-type">${typeText}</div>
                        <div class="calendar-transaction-amount ${transaction.type}">
                            ${transaction.type === 'income' ? '+' : '-'}$${Math.abs(transaction.amount).toFixed(2)}
                        </div>
                        <div class="calendar-transaction-date">${formattedDate}</div>
                        ${transaction.description ? `<div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px; line-height: 1.3;">${transaction.description}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        function getTransactionsForDate(date) {
            return transactions.filter(t => t.date === date);
        }

        function changeMonth(direction) {
            currentMonth.setMonth(currentMonth.getMonth() + direction);
            updateCalendar();
        }

        // Функции пользовательского диапазона дат

        function applyCustomFilter() {
            const filterType = document.getElementById('customFilterType').value;
            const dateFrom = document.getElementById('customDateFrom').value;
            const dateTo = document.getElementById('customDateTo').value;

            if (!dateFrom || !dateTo) {
                alert('Пожалуйста, выберите даты');
                return;
            }

            if (new Date(dateFrom) > new Date(dateTo)) {
                alert('Дата "От" не может быть позже даты "По"');
                return;
            }

            currentCustomFilter = {
                type: filterType,
                dateFrom: dateFrom,
                dateTo: dateTo
            };

            // Сохраняем фильтр в localStorage
            localStorage.setItem('currentCustomFilter', JSON.stringify(currentCustomFilter));

            // Обновляем селект для показа активного фильтра
            updateSortSelectForCustomFilter();
            updateFilterIndicator();
            hideModal('dateRangeModal');
            displayTransactions();
        }





        function cancelCustomFilter() {
            // Возвращаем селект к "Сначала новые"
            currentCustomFilter = null;
            localStorage.removeItem('currentCustomFilter');
            resetSortSelectFromCustomFilter();
            updateFilterIndicator();
            hideModal('dateRangeModal');
            displayTransactions();
        }

        function updateSortSelectForCustomFilter() {
            const select = document.getElementById('sortSelect');
            // Добавляем опцию для показа активного фильтра если её нет
            if (!select.querySelector('option[value="custom_active"]')) {
                const option = document.createElement('option');
                option.value = 'custom_active';
                option.textContent = '✓ Пользовательский фильтр активен';
                select.appendChild(option);
            }
            select.value = 'custom_active';
        }

        function resetSortSelectFromCustomFilter() {
            const select = document.getElementById('sortSelect');
            // Удаляем опцию активного фильтра
            const customOption = select.querySelector('option[value="custom_active"]');
            if (customOption) {
                customOption.remove();
            }
            select.value = 'date_desc';
        }

        function updateFilterIndicator() {
            const indicator = document.getElementById('filterIndicator');
            const filterText = document.getElementById('filterText');

            if (currentCustomFilter) {
                const typeText = currentCustomFilter.type === 'all' ? 'Все' : 
                               currentCustomFilter.type === 'income' ? 'Доходы' : 'Расходы';
                
                const fromDate = new Date(currentCustomFilter.dateFrom).toLocaleDateString('ru-RU', {
                    day: '2-digit',
                    month: 'short'
                });
                const toDate = new Date(currentCustomFilter.dateTo).toLocaleDateString('ru-RU', {
                    day: '2-digit',
                    month: 'short'
                });

                filterText.textContent = `${typeText} • ${fromDate} - ${toDate}`;
                indicator.style.display = 'flex';
            } else {
                indicator.style.display = 'none';
            }
        }

        // Калькулятор прибыли
        function calculateProfit() {
            const buyPrice = parseFloat(document.getElementById('calcBuyPrice').value) || 0;
            const profitPercent = parseFloat(document.getElementById('calcProfitPercent').value) || 0;
            const commission = parseFloat(document.getElementById('calcCommission').value) || 0;

            const desiredProfit = buyPrice * (profitPercent / 100);
            const sellPrice = (buyPrice + desiredProfit) / (1 - commission / 100);
            const commissionAmount = sellPrice * (commission / 100);
            const netProfit = sellPrice - buyPrice - commissionAmount;

            document.getElementById('calcSellPrice').textContent = `$${sellPrice.toFixed(2)}`;
            document.getElementById('calcNetProfit').textContent = `$${netProfit.toFixed(2)}`;
            document.getElementById('calcCommissionAmount').textContent = `$${commissionAmount.toFixed(2)}`;
        }



        // Новая функция добавления скина для страницы скинов
        function addNewSkin() {
            console.log('Функция addNewSkin() вызвана');
            
            // Получаем элементы
            const nameElement = document.getElementById('newSkinName');
            const qualityElement = document.getElementById('newSkinQuality');
            const priceElement = document.getElementById('newSkinPrice');
            
            // Проверяем существование элементов
            if (!nameElement || !qualityElement || !priceElement) {
                alert('Ошибка: не удалось найти элементы формы.');
                return;
            }
            
            // Получаем значения
            const name = nameElement.value.trim();
            const quality = qualityElement.value;
            const priceInput = priceElement.value;
            const price = parseFloat(priceInput);
            
            console.log('Полученные значения:', {
                name: `"${name}"`,
                quality: quality,
                priceInput: priceInput,
                price: price
            });

            // Проверяем валидность данных
            if (!name) {
                showNotification('Пожалуйста, введите название скина', 'error');
                nameElement.focus();
                return;
            }

            if (!priceInput || isNaN(price) || price <= 0) {
                showNotification('Пожалуйста, введите корректную цену покупки (больше 0)', 'error');
                priceElement.focus();
                return;
            }

            // Создаем скин
            const skin = {
                id: Date.now(),
                name: name,
                quality: quality,
                price: price,
                date: getLocalDateString()
            };

            try {
                skins.push(skin);
                localStorage.setItem('skins', JSON.stringify(skins));
                
                // Очищаем форму
                nameElement.value = '';
                qualityElement.value = 'FT';
                priceElement.value = '';
                
                // Обновляем интерфейс
                loadSkinsGrid();
                updateSkinsStats();
                
                showNotification(`Скин "${skin.name}" успешно добавлен!`, 'success');
                console.log('Скин успешно добавлен:', skin);
            } catch (error) {
                console.error('Ошибка при добавлении скина:', error);
                showNotification('Произошла ошибка при добавлении скина. Попробуйте еще раз.', 'error');
            }
        }

        function deleteSkin(id) {
            const skin = skins.find(s => s.id === id);
            if (!skin) return;
            
            skinToDelete = id;
            
            // Показываем превью скина для удаления
            const preview = document.getElementById('deleteSkinPreview');
            const date = new Date(skin.date);
            const formattedDate = date.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            
            preview.innerHTML = `
                <div class="delete-preview-content">
                    <div class="preview-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="preview-details">
                        <div class="preview-name">${skin.name} (${skin.quality || 'FT'})</div>
                        <div class="preview-amount">$${skin.price.toFixed(2)}</div>
                        <div class="preview-date">${formattedDate}</div>
                    </div>
                </div>
            `;
            
            showModal('confirmDeleteSkinModal');
        }

        // Глобальная переменная для хранения ID продаваемого скина
        let currentSellingSkinId = null;
        
        // Глобальная переменная для хранения ID удаляемого скина
        let skinToDelete = null;

        function openSellSkinModal(id) {
            const skin = skins.find(s => s.id === id);
            if (!skin) return;
            
            currentSellingSkinId = id;
            
            // Показываем информацию о скине
            document.getElementById('sellSkinInfo').innerHTML = `
                <div class="skin-info-card">
                    <h4>${skin.name} (${skin.quality || 'FT'})</h4>
                    <p>Цена покупки: $${skin.price.toFixed(2)}</p>
                    <p>Дата покупки: ${skin.date}</p>
                </div>
            `;
            
            // Инициализируем поля
            document.getElementById('skinSellPrice').value = ''; // Очищаем поле цены
            document.getElementById('sellCommission').value = '10'; // Комиссия по умолчанию 10%
            document.getElementById('sellComment').value = '';
            document.getElementById('sellCalculation').style.display = 'none';
            
            // Устанавливаем обработчики событий для автоматического расчета
            const sellPriceInput = document.getElementById('skinSellPrice');
            const sellCommissionInput = document.getElementById('sellCommission');
            
            // Удаляем старые обработчики (если есть) и добавляем новые
            if (sellPriceInput) {
                sellPriceInput.removeEventListener('input', calculateSellProfit);
                sellPriceInput.removeEventListener('keyup', calculateSellProfit);
                sellPriceInput.removeEventListener('change', calculateSellProfit);
                
                sellPriceInput.addEventListener('input', calculateSellProfit);
                sellPriceInput.addEventListener('keyup', calculateSellProfit);
                sellPriceInput.addEventListener('change', calculateSellProfit);
            }
            if (sellCommissionInput) {
                sellCommissionInput.removeEventListener('input', calculateSellProfit);
                sellCommissionInput.removeEventListener('keyup', calculateSellProfit);
                sellCommissionInput.removeEventListener('change', calculateSellProfit);
                
                sellCommissionInput.addEventListener('input', calculateSellProfit);
                sellCommissionInput.addEventListener('keyup', calculateSellProfit);
                sellCommissionInput.addEventListener('change', calculateSellProfit);
            }
            
            // Принудительно вызываем расчет если поле комиссии уже заполнено
            setTimeout(() => {
                calculateSellProfit();
            }, 100);
            
            showModal('sellSkinModal');
        }

        function completeSkinSale() {
            const skin = skins.find(s => s.id === currentSellingSkinId);
            if (!skin) {
                showNotification('Ошибка: скин не найден', 'error');
                return;
            }
            
            const sellPriceElement = document.getElementById('skinSellPrice');
            if (!sellPriceElement) {
                showNotification('Ошибка: поле цены не найдено', 'error');
                return;
            }
            
            const sellPriceInput = sellPriceElement.value.trim();
            
            // Заменяем запятую на точку для корректного парсинга
            const sellPriceValue = sellPriceInput.replace(',', '.');
            const sellPrice = parseFloat(sellPriceValue);
            const commission = parseFloat(document.getElementById('sellCommission').value) || 0;
            const comment = document.getElementById('sellComment').value;
            
            // Проверка цены продажи
            if (!sellPriceInput || sellPriceInput === '') {
                showNotification('Введите цену продажи', 'error');
                sellPriceElement.focus();
                return;
            }
            
            if (isNaN(sellPrice) || sellPriceValue === '') {
                showNotification('Цена должна быть числом', 'error');
                sellPriceElement.focus();
                return;
            }
            
            if (sellPrice <= 0) {
                showNotification('Цена должна быть больше 0', 'error');
                sellPriceElement.focus();
                return;
            }
            
            // Создаем расширенную сделку
            const transaction = {
                id: Date.now(),
                transactionType: 'advanced',
                type: 'income',
                name: `${skin.name} (${skin.quality || 'FT'})`,
                buyPrice: skin.price,
                sellPrice: sellPrice,
                commission: commission,
                amount: sellPrice - (sellPrice * commission / 100) - skin.price,
                date: getLocalDateString(),
                description: comment || `Продажа скина из коллекции. Куплен ${skin.date} за $${skin.price.toFixed(2)}`
            };
            
            transactions.push(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            // Удаляем скин из коллекции
            skins = skins.filter(s => s.id !== currentSellingSkinId);
            localStorage.setItem('skins', JSON.stringify(skins));
            
            // Обновляем интерфейс
            updateDashboard();
            loadSkinsGrid();
            updateSkinsStats();
            hideModal('sellSkinModal');
            
            showNotification(`Скин успешно продан! Прибыль: $${transaction.amount.toFixed(2)}`, 'success');
        }

        // Функции для страницы "Мои скины"
        function updateSkinsStats() {
            const totalCount = skins.length;
            const totalValue = skins.reduce((sum, skin) => sum + skin.price, 0);
            const averagePrice = totalCount > 0 ? totalValue / totalCount : 0;

            document.getElementById('totalSkinsCount').textContent = totalCount;
            document.getElementById('totalSkinsValue').textContent = `$${totalValue.toFixed(2)}`;
            document.getElementById('averageSkinPrice').textContent = `$${averagePrice.toFixed(2)}`;
        }

        function loadSkinsGrid() {
            const container = document.getElementById('skinsGrid');
            const sortBy = document.getElementById('skinsSort')?.value || 'date_desc';
            
            if (!container) return;

            // Сортируем скины
            let sortedSkins = [...skins];
            switch (sortBy) {
                case 'date_desc':
                    sortedSkins.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'date_asc':
                    sortedSkins.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'price_desc':
                    sortedSkins.sort((a, b) => b.price - a.price);
                    break;
                case 'price_asc':
                    sortedSkins.sort((a, b) => a.price - b.price);
                    break;
                case 'name_asc':
                    sortedSkins.sort((a, b) => a.name.localeCompare(b.name));
                    break;
            }

            if (sortedSkins.length === 0) {
                container.innerHTML = `
                    <div class="empty-skins">
                        <i class="fas fa-box-open"></i>
                        <h3>Коллекция пуста</h3>
                        <p>Добавьте свой первый скин, чтобы начать управлять коллекцией</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = sortedSkins.map(skin => `
                <div class="skin-card">
                    <div class="skin-card-header">
                        <h4 class="skin-name">${skin.name}</h4>
                        <span class="skin-quality">${skin.quality || 'FT'}</span>
                    </div>
                    <div class="skin-price">$${skin.price.toFixed(2)}</div>
                    <div class="skin-date">Куплен: ${formatDate(skin.date)}</div>
                    <div class="skin-actions">
                        <button class="btn btn-sell" onclick="openSellSkinModal(${skin.id})">
                            <i class="fas fa-dollar-sign"></i> Продать
                        </button>
                        <button class="btn btn-danger" onclick="deleteSkinFromGrid(${skin.id})">
                            <i class="fas fa-trash"></i> Удалить
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function deleteSkinFromGrid(id) {
            const skin = skins.find(s => s.id === id);
            if (!skin) return;
            
            skinToDelete = id;
            
            // Показываем превью скина для удаления
            const preview = document.getElementById('deleteSkinPreview');
            const date = new Date(skin.date);
            const formattedDate = date.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            
            preview.innerHTML = `
                <div class="delete-preview-content">
                    <div class="preview-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="preview-details">
                        <div class="preview-name">${skin.name} (${skin.quality || 'FT'})</div>
                        <div class="preview-amount">$${skin.price.toFixed(2)}</div>
                        <div class="preview-date">${formattedDate}</div>
                    </div>
                </div>
            `;
            
            showModal('confirmDeleteSkinModal');
        }

        function confirmDeleteSkin() {
            if (skinToDelete !== null) {
                skins = skins.filter(s => s.id !== skinToDelete);
                localStorage.setItem('skins', JSON.stringify(skins));
                loadSkinsGrid();
                updateSkinsStats();
                hideModal('confirmDeleteSkinModal');
                showNotification('Скин удален из коллекции', 'success');
                skinToDelete = null;
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }

        // Автоматический расчет прибыли при продаже скина
        function calculateSellProfit() {
            const skin = skins.find(s => s.id === currentSellingSkinId);
            if (!skin) return;
            
            // Поддержка запятой как десятичного разделителя
            const sellPriceValue = document.getElementById('skinSellPrice').value.replace(',', '.');
            const commissionValue = document.getElementById('sellCommission').value.replace(',', '.');
            const sellPrice = parseFloat(sellPriceValue) || 0;
            const commission = parseFloat(commissionValue) || 0;
            
            if (sellPrice > 0) {
                const commissionAmount = sellPrice * commission / 100;
                const netSellPrice = sellPrice - commissionAmount;
                const profit = netSellPrice - skin.price;
                
                // Получаем элементы для отображения расчетов
                const calcSellPriceEl = document.getElementById('skinCalcSellPrice');
                const calcCommissionEl = document.getElementById('skinCalcCommissionAmount');
                const calcNetProfitEl = document.getElementById('skinCalcNetProfit');
                const sellCalculationEl = document.getElementById('sellCalculation');
                
                // Показываем расчеты
                if (calcSellPriceEl) calcSellPriceEl.textContent = `$${sellPrice.toFixed(2)}`;
                if (calcCommissionEl) calcCommissionEl.textContent = `$${commissionAmount.toFixed(2)}`;
                if (calcNetProfitEl) calcNetProfitEl.textContent = `$${profit.toFixed(2)}`;
                
                // Меняем цвет прибыли в зависимости от знака
                if (calcNetProfitEl) {
                    if (profit > 0) {
                        calcNetProfitEl.style.color = 'var(--positive)';
                    } else if (profit < 0) {
                        calcNetProfitEl.style.color = 'var(--negative)';
                    } else {
                        calcNetProfitEl.style.color = 'var(--text-secondary)';
                    }
                }
                
                if (sellCalculationEl) {
                    sellCalculationEl.style.display = 'block';
                }
            } else {
                const sellCalculationEl = document.getElementById('sellCalculation');
                if (sellCalculationEl) sellCalculationEl.style.display = 'none';
            }
        }



        // Импорт/Экспорт данных
        function exportData() {
            const data = {
                transactions: transactions,
                skins: skins,
                deposits: deposits,
                depositsEnabled: depositsEnabled,
                exportDate: new Date().toISOString(),
                version: '1.1'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `financial_tracker_backup_${getLocalDateString()}.json`;
            link.click();
        }

        function importTransactions(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (confirm('Импорт данных заменит все существующие данные. Продолжить?')) {
                        // Проверяем формат данных
                        if (data.transactions && Array.isArray(data.transactions)) {
                            transactions = data.transactions;
                            localStorage.setItem('transactions', JSON.stringify(transactions));
                        }
                        
                        if (data.skins && Array.isArray(data.skins)) {
                            skins = data.skins;
                            localStorage.setItem('skins', JSON.stringify(skins));
                        }
                        
                        // Импортируем депозиты если есть
                        if (data.deposits && Array.isArray(data.deposits)) {
                            deposits = data.deposits;
                            localStorage.setItem('deposits', JSON.stringify(deposits));
                        }
                        
                        // Импортируем настройку депозитов если есть
                        if (data.depositsEnabled !== undefined) {
                            depositsEnabled = data.depositsEnabled;
                            localStorage.setItem('depositsEnabled', JSON.stringify(depositsEnabled));
                        }
                        
                        // Обновляем интерфейс
                        updateDashboard();
                        loadSkinsGrid();
                        updateSkinsStats();
                        loadDeposits();
                        updateDepositsToggleState();
                        updateCalendar();
                        
                        alert('Данные успешно импортированы!');
                    }
                } catch (error) {
                    alert('Ошибка при импорте данных. Проверьте формат файла.');
                    console.error('Import error:', error);
                }
                
                // Очищаем input
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }

        // Закрытие модальных окон при клике вне них
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
                
                // Проверяем, есть ли другие открытые модальные окна
                const openModals = document.querySelectorAll('.modal[style*="block"]');
                if (openModals.length === 0) {
                    document.body.classList.remove('modal-open');
                }
            }
        });

        // Автосворачивание сайдбара при клике вне его области
        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const isClickInsideSidebar = sidebar.contains(e.target);
            
            if (!isClickInsideSidebar && sidebar.classList.contains('expanded')) {
                collapseSidebar();
            }
        });

        // ======== ФУНКЦИИ ДЛЯ РАБОТЫ С ДЕПОЗИТАМИ ========

        // Открытие модального окна депозитов
        function openDepositsModal() {
            showModal('depositsModal');
            loadDeposits();
        }

        // Переключение отображения депозитов в балансе
        function toggleDepositsDisplay() {
            depositsEnabled = !depositsEnabled;
            localStorage.setItem('depositsEnabled', JSON.stringify(depositsEnabled));
            updateDepositsToggleState();
            updateDashboard();
        }

        // Обновление состояния кнопки переключения
        function updateDepositsToggleState() {
            const toggleBtn = document.querySelector('.deposits-toggle-btn');
            const toggleIcon = document.getElementById('depositsToggleIcon');
            
            if (depositsEnabled) {
                toggleBtn.classList.add('active');
                toggleIcon.className = 'fas fa-eye';
                toggleBtn.title = 'Скрыть депозиты из баланса';
            } else {
                toggleBtn.classList.remove('active');
                toggleIcon.className = 'fas fa-eye-slash';
                toggleBtn.title = 'Показать депозиты в балансе';
            }
        }

        // Добавление депозита
        function addDeposit(event) {
            event.preventDefault();
            
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const comment = document.getElementById('depositComment').value.trim();
            const date = document.getElementById('depositDate').value;
            
            if (!amount || amount <= 0) {
                alert('Введите корректную сумму депозита');
                return;
            }
            
            if (!date) {
                alert('Выберите дату депозита');
                return;
            }
            
            const deposit = {
                id: Date.now(),
                amount: amount,
                comment: comment || 'Без комментария',
                date: date,
                created: new Date().toISOString()
            };
            
            deposits.push(deposit);
            localStorage.setItem('deposits', JSON.stringify(deposits));
            
            // Очищаем форму
            document.getElementById('depositForm').reset();
            const today = getLocalDateString();
            document.getElementById('depositDate').value = today;
            
            // Обновляем отображение
            loadDeposits();
            updateDashboard();
        }

        // Загрузка и отображение депозитов
        function loadDeposits() {
            const container = document.getElementById('depositsList');
            const totalElement = document.getElementById('totalDepositsAmount');
            
            if (!deposits || deposits.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #94a3b8; padding: 20px;">Нет депозитов</div>';
                totalElement.textContent = '$0';
                return;
            }
            
            // Сортируем депозиты по дате (новые сначала)
            const sortedDeposits = [...deposits].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Рассчитываем общую сумму
            const totalAmount = deposits.reduce((sum, d) => sum + d.amount, 0);
            totalElement.textContent = `$${totalAmount.toFixed(2)}`;
            
            // Отображаем список депозитов
            container.innerHTML = sortedDeposits.map(deposit => {
                const date = new Date(deposit.date);
                const formattedDate = date.toLocaleDateString('ru-RU', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                return `
                    <div class="deposit-item">
                        <div class="deposit-info">
                            <div class="deposit-amount">+$${deposit.amount.toFixed(2)}</div>
                            <div class="deposit-comment">${deposit.comment}</div>
                            <div class="deposit-date">
                                <i class="fas fa-calendar-alt"></i>
                                ${formattedDate}
                            </div>
                        </div>
                        <div class="deposit-actions">
                            <button class="deposit-delete-btn" onclick="deleteDeposit(${deposit.id})" title="Удалить депозит">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Удаление депозита
        function deleteDeposit(id) {
            const deposit = deposits.find(d => d.id === id);
            if (!deposit) return;
            
            if (confirm(`Удалить депозит на сумму $${deposit.amount.toFixed(2)}?`)) {
                deposits = deposits.filter(d => d.id !== id);
                localStorage.setItem('deposits', JSON.stringify(deposits));
                loadDeposits();
                updateDashboard();
            }
        }

        // Функции статистики
        function updateStatistics() {
            const period = document.getElementById('statisticsPeriod').value;
            const now = new Date();
            let filteredTransactions = [...transactions];
            
            // Фильтрация по периоду
            if (period !== 'all') {
                let startDate;
                switch(period) {
                    case 'day':
                        startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                        break;
                    case 'week':
                        startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                        break;
                    case 'month':
                        startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                        break;
                }
                
                filteredTransactions = transactions.filter(t => new Date(t.date) >= startDate);
            }
            
            // Обновляем название периода
            const periodLabel = document.querySelector('.statistic-period-label');
            const periodNames = {
                'all': 'Профит за все время',
                'month': 'Профит за месяц',
                'week': 'Профит за неделю',
                'day': 'Профит за день'
            };
            if (periodLabel) {
                periodLabel.textContent = periodNames[period];
            }
            
            // Расчеты
            const totalProfit = filteredTransactions.reduce((sum, t) => sum + t.amount, 0);
            const totalBalance = transactions.reduce((sum, t) => sum + t.amount, 0) + 
                               (depositsEnabled ? deposits.reduce((sum, d) => sum + d.amount, 0) : 0);
            
            const profitableDeals = filteredTransactions.filter(t => t.amount > 0);
            const totalDeals = filteredTransactions.length;
            const successRate = totalDeals > 0 ? (profitableDeals.length / totalDeals * 100) : 0;
            
            const averageProfitPerTrade = totalDeals > 0 ? totalProfit / totalDeals : 0;
            
            // Средний заработок в день
            const daysDiff = period === 'all' ? getDaysBetweenDates(getFirstTransactionDate(), now) : 
                           period === 'month' ? now.getDate() :
                           period === 'week' ? 7 : 1;
            const averageDailyEarnings = daysDiff > 0 ? totalProfit / daysDiff : 0;
            
            // Средний процент прибыли
            const advancedDeals = filteredTransactions.filter(t => t.transactionType === 'advanced' && t.buyPrice && t.sellPrice);
            const averageProfitPercent = advancedDeals.length > 0 ? 
                advancedDeals.reduce((sum, t) => sum + ((t.amount / t.buyPrice) * 100), 0) / advancedDeals.length : 0;
            
            // Обновляем UI
            document.getElementById('periodProfit').textContent = `$${totalProfit.toFixed(2)}`;
            document.getElementById('totalBalanceStat').textContent = `$${totalBalance.toFixed(2)}`;
            document.getElementById('averageProfitPerTrade').textContent = `$${averageProfitPerTrade.toFixed(2)}`;
            document.getElementById('averageDailyEarnings').textContent = `$${averageDailyEarnings.toFixed(2)}`;
            document.getElementById('successRate').textContent = `${successRate.toFixed(1)}%`;
            document.getElementById('averageProfitPercent').textContent = `${averageProfitPercent.toFixed(2)}%`;
            
            // Обновляем тренды
            updateStatisticsTrends(totalProfit, successRate, averageProfitPercent);
            
            // Обновляем торговую активность
            updateTradingActivity(filteredTransactions);
            
            // Обновляем счетчики сделок
            updateDealsCount(filteredTransactions);
            
            // Обновляем лучшие и худшие сделки
            updateBestWorstDeals();
            
            // Обновляем графики активности
            updateActivityCharts(filteredTransactions);
        }
        
        function updateStatisticsTrends(profit, successRate, profitPercent) {
            const profitTrend = document.getElementById('periodProfitTrend');
            const successTrend = document.getElementById('successRateTrend');
            const profitPercentTrend = document.getElementById('profitPercentTrend');
            
            // Трендовые сообщения
            if (profit > 0) {
                profitTrend.textContent = '↗ Положительная динамика';
                profitTrend.className = 'statistic-trend positive';
            } else if (profit < 0) {
                profitTrend.textContent = '↘ Отрицательная динамика';
                profitTrend.className = 'statistic-trend negative';
            } else {
                profitTrend.textContent = '→ Без изменений';
                profitTrend.className = 'statistic-trend';
            }
            
            if (successRate >= 70) {
                successTrend.innerHTML = '<i class="fas fa-fire"></i> Отличный результат';
                successTrend.className = 'statistic-trend positive';
            } else if (successRate >= 50) {
                successTrend.innerHTML = '<i class="fas fa-chart-line"></i> Хороший результат';
                successTrend.className = 'statistic-trend positive';
            } else {
                successTrend.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Требуется улучшение';
                successTrend.className = 'statistic-trend negative';
            }
            
            if (profitPercent >= 20) {
                profitPercentTrend.innerHTML = '<i class="fas fa-coins"></i> Высокая доходность';
                profitPercentTrend.className = 'statistic-trend positive';
            } else if (profitPercent >= 10) {
                profitPercentTrend.innerHTML = '<i class="fas fa-chart-bar"></i> Средняя доходность';
                profitPercentTrend.className = 'statistic-trend';
            } else {
                profitPercentTrend.innerHTML = '<i class="fas fa-bolt"></i> Низкая доходность';
                profitPercentTrend.className = 'statistic-trend negative';
            }
        }
        
        function getFirstTransactionDate() {
            if (transactions.length === 0) return new Date();
            const sortedDates = transactions.map(t => new Date(t.date)).sort((a, b) => a - b);
            return sortedDates[0];
        }
        
        function getDaysBetweenDates(date1, date2) {
            const diffTime = Math.abs(date2 - date1);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }
        
        // Функция обновления торговой активности
        function updateTradingActivity(filteredTransactions) {
            // Общее количество сделок
            const totalDeals = filteredTransactions.length;
            document.getElementById('totalDealsActivity').textContent = totalDeals;
            
            // Количество активных дней торговли
            const tradingDates = [...new Set(filteredTransactions.map(t => t.date))];
            const activeDays = tradingDates.length;
            document.getElementById('activeTradingDays').textContent = activeDays;
            
            // Самый активный месяц
            const monthlyActivity = {};
            const monthNames = ['ЯНВАРЬ', 'ФЕВРАЛЬ', 'МАРТ', 'АПРЕЛЬ', 'МАЙ', 'ИЮНЬ', 
                              'ИЮЛЬ', 'АВГУСТ', 'СЕНТЯБРЬ', 'ОКТЯБРЬ', 'НОЯБРЬ', 'ДЕКАБРЬ'];
            
            filteredTransactions.forEach(t => {
                const date = new Date(t.date);
                const monthKey = `${date.getFullYear()}-${date.getMonth()}`;
                const monthName = monthNames[date.getMonth()];
                
                if (!monthlyActivity[monthKey]) {
                    monthlyActivity[monthKey] = { name: monthName, count: 0 };
                }
                monthlyActivity[monthKey].count++;
            });
            
            let mostActiveMonth = { name: 'ЯНВАРЬ', count: 0 };
            Object.values(monthlyActivity).forEach(month => {
                if (month.count > mostActiveMonth.count) {
                    mostActiveMonth = month;
                }
            });
            
            document.getElementById('mostActiveMonth').textContent = mostActiveMonth.name;
            document.getElementById('mostActiveMonthDeals').textContent = mostActiveMonth.count;
            
            // Самое продуктивное время
            if (filteredTransactions.length > 0) {
                // Пока что добавляем текущее время, позже можно будет добавить отслеживание времени создания
                const now = new Date();
                const productiveTime = `${now.getHours().toString().padStart(2, '0')}:00`;
                document.getElementById('mostProductiveTime').textContent = productiveTime;
                
                // Примерный расчет процента успеха (положительные сделки)
                const successfulDeals = filteredTransactions.filter(t => t.amount > 0).length;
                const successRate = totalDeals > 0 ? Math.round((successfulDeals / totalDeals) * 100) : 0;
                document.getElementById('timeSuccessRate').textContent = `${successRate}%`;
            } else {
                document.getElementById('mostProductiveTime').textContent = '12:00';
                document.getElementById('timeSuccessRate').textContent = '0%';
            }
        }
        
        // Функция обновления счетчиков сделок по периодам
        function updateDealsCount(filteredTransactions) {
            const now = new Date();
            
            // Всегда берем данные из всех транзакций для правильного подсчета
            const allTransactions = transactions;
            
            // Сделки за день (сегодня)
            const today = now.toISOString().split('T')[0];
            const todayDeals = allTransactions.filter(t => t.date === today).length;
            document.getElementById('dealsToday').textContent = todayDeals;
            
            // Сделки за неделю (последние 7 дней)
            const weekAgo = new Date(now);
            weekAgo.setDate(weekAgo.getDate() - 7);
            const weekDeals = allTransactions.filter(t => new Date(t.date) >= weekAgo).length;
            document.getElementById('dealsWeek').textContent = weekDeals;
            
            // Сделки за месяц (последние 30 дней)
            const monthAgo = new Date(now);
            monthAgo.setDate(monthAgo.getDate() - 30);
            const monthDeals = allTransactions.filter(t => new Date(t.date) >= monthAgo).length;
            document.getElementById('dealsMonth').textContent = monthDeals;
            
            // Всего сделок
            const totalDeals = allTransactions.length;
            document.getElementById('dealsTotal').textContent = totalDeals;
        }

        // Функция обновления лучших и худших сделок
        function updateBestWorstDeals() {
            const now = new Date();
            const currentMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            
            // Сделки за текущий месяц
            const thisMonthDeals = transactions.filter(t => new Date(t.date) >= currentMonth);
            
            // Все сделки с положительным результатом (только доходы)
            const profitableDeals = transactions.filter(t => t.amount > 0);
            
            // Лучшая сделка месяца
            if (thisMonthDeals.length > 0) {
                const bestMonth = thisMonthDeals.reduce((max, deal) => deal.amount > max.amount ? deal : max);
                if (bestMonth.amount > 0) {
                    document.getElementById('bestMonthAmount').textContent = `$${bestMonth.amount.toFixed(2)}`;
                    const date = new Date(bestMonth.date).toLocaleDateString('ru-RU');
                    document.getElementById('bestMonthDetails').textContent = `${bestMonth.name} (прибыль: $${bestMonth.amount.toFixed(2)}) (${date})`;
                } else {
                    document.getElementById('bestMonthAmount').textContent = '-';
                    document.getElementById('bestMonthDetails').textContent = '-';
                }
            } else {
                document.getElementById('bestMonthAmount').textContent = '-';
                document.getElementById('bestMonthDetails').textContent = '-';
            }
            
            // Худшая сделка месяца (наименьшая прибыльная или самый большой убыток)
            if (thisMonthDeals.length > 0) {
                const worstMonth = thisMonthDeals.reduce((min, deal) => deal.amount < min.amount ? deal : min);
                if (worstMonth.amount < 0) {
                    document.getElementById('worstMonthAmount').textContent = `-$${Math.abs(worstMonth.amount).toFixed(2)}`;
                    const date = new Date(worstMonth.date).toLocaleDateString('ru-RU');
                    document.getElementById('worstMonthDetails').textContent = `${worstMonth.name} (убыток: $${Math.abs(worstMonth.amount).toFixed(2)}) (${date})`;
                } else {
                    // Если нет убыточных сделок, показываем самую маленькую прибыльную
                    const minProfitable = thisMonthDeals.filter(t => t.amount > 0);
                    if (minProfitable.length > 0) {
                        const smallestProfit = minProfitable.reduce((min, deal) => deal.amount < min.amount ? deal : min);
                        document.getElementById('worstMonthAmount').textContent = `$${smallestProfit.amount.toFixed(2)}`;
                        const date = new Date(smallestProfit.date).toLocaleDateString('ru-RU');
                        document.getElementById('worstMonthDetails').textContent = `${smallestProfit.name} (минимальная прибыль: $${smallestProfit.amount.toFixed(2)}) (${date})`;
                    } else {
                        document.getElementById('worstMonthAmount').textContent = '-';
                        document.getElementById('worstMonthDetails').textContent = '-';
                    }
                }
            } else {
                document.getElementById('worstMonthAmount').textContent = '-';
                document.getElementById('worstMonthDetails').textContent = '-';
            }
            
            // Максимальный профит за сделку (за все время)
            if (profitableDeals.length > 0) {
                const maxProfit = profitableDeals.reduce((max, deal) => deal.amount > max.amount ? deal : max);
                document.getElementById('maxProfitAmount').textContent = `$${maxProfit.amount.toFixed(2)}`;
                const date = new Date(maxProfit.date).toLocaleDateString('ru-RU');
                document.getElementById('maxProfitDetails').textContent = `${maxProfit.name} (прибыль: $${maxProfit.amount.toFixed(2)}) (${date})`;
            } else {
                document.getElementById('maxProfitAmount').textContent = '$0';
                document.getElementById('maxProfitDetails').textContent = '-';
            }
            
            // Минимальный профит за сделку (наименьшая прибыльная сделка)
            if (profitableDeals.length > 0) {
                const minProfit = profitableDeals.reduce((min, deal) => deal.amount < min.amount ? deal : min);
                document.getElementById('minProfitAmount').textContent = `$${minProfit.amount.toFixed(2)}`;
                const date = new Date(minProfit.date).toLocaleDateString('ru-RU');
                document.getElementById('minProfitDetails').textContent = `${minProfit.name} (прибыль: $${minProfit.amount.toFixed(2)}) (${date})`;
            } else {
                document.getElementById('minProfitAmount').textContent = '$0';
                document.getElementById('minProfitDetails').textContent = '-';
            }
        }

        // Переменные для хранения графиков
        let dailyActivityChart = null;
        let weeklyActivityChart = null;
        
        // Функция обновления графиков активности
        function updateActivityCharts(filteredTransactions) {
            createDailyActivityChart(filteredTransactions);
            createWeeklyActivityChart(filteredTransactions);
        }
        
        // Создание графика дневной активности
        function createDailyActivityChart(transactions) {
            const ctx = document.getElementById('dailyActivityChart').getContext('2d');
            
            // Уничтожаем предыдущий график
            if (dailyActivityChart) {
                dailyActivityChart.destroy();
            }
            
            // Группируем транзакции по дням за последние 14 дней
            const last14Days = [];
            const dailyData = [];
            const profitableData = [];
            
            for (let i = 13; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                last14Days.push(dateStr);
                
                const dayTransactions = transactions.filter(t => t.date === dateStr);
                const profitable = dayTransactions.filter(t => t.amount > 0);
                
                dailyData.push(dayTransactions.length);
                profitableData.push(profitable.length);
            }
            
            // Вычисляем среднее количество сделок в день
            const avgDaily = dailyData.length > 0 ? (dailyData.reduce((a, b) => a + b, 0) / dailyData.length).toFixed(1) : 0;
            document.getElementById('avgDailyDeals').textContent = avgDaily;
            
            dailyActivityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last14Days.map((date, index) => index + 1),
                    datasets: [{
                        label: 'Сделок совершено',
                        data: dailyData,
                        borderColor: '#ffffff',
                        backgroundColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 2,
                        pointRadius: 2,
                        pointHoverRadius: 4,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Прибыльных',
                        data: profitableData,
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        borderWidth: 2,
                        pointRadius: 2,
                        pointHoverRadius: 4,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 26, 0.95)',
                            titleColor: '#ffffff',
                            bodyColor: '#cccccc',
                            borderColor: '#333333',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: true,
                            titleFont: {
                                size: 14,
                                weight: 'bold',
                                family: "'Segoe UI', sans-serif"
                            },
                            bodyFont: {
                                size: 13,
                                weight: '600',
                                family: "'Segoe UI', sans-serif"
                            },
                            footerFont: {
                                size: 11,
                                weight: '500'
                            },
                            padding: 12,
                            caretSize: 6,
                            caretPadding: 8,
                            usePointStyle: true,
                            boxPadding: 4,
                            callbacks: {
                                title: function(context) {
                                    return `День ${context[0].label}`;
                                },
                                label: function(context) {
                                    const label = context.dataset.label;
                                    const value = context.parsed.y;
                                    return `${label}: ${value} сделок`;
                                },
                                footer: function(tooltipItems) {
                                    const total = tooltipItems.reduce((sum, item) => sum + item.parsed.y, 0);
                                    return total > 0 ? `Общая активность: ${total}` : '';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: '#333333',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#666666',
                                font: {
                                    size: 10
                                }
                            }
                        },
                        y: {
                            display: true,
                            beginAtZero: true,
                            grid: {
                                color: '#333333',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#666666',
                                font: {
                                    size: 10
                                },
                                stepSize: 1
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }
        
        // Создание графика еженедельной активности
        function createWeeklyActivityChart(transactions) {
            const ctx = document.getElementById('weeklyActivityChart').getContext('2d');
            
            // Уничтожаем предыдущий график
            if (weeklyActivityChart) {
                weeklyActivityChart.destroy();
            }
            
            // Группируем транзакции по неделям за последние 8 недель
            const last8Weeks = [];
            const weeklyData = [];
            const profitableWeeklyData = [];
            
            for (let i = 7; i >= 0; i--) {
                const weekStart = new Date();
                weekStart.setDate(weekStart.getDate() - (i * 7));
                weekStart.setDate(weekStart.getDate() - weekStart.getDay() + 1); // Понедельник
                
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6); // Воскресенье
                
                last8Weeks.push(`Week ${8-i}`);
                
                const weekTransactions = transactions.filter(t => {
                    const transDate = new Date(t.date);
                    return transDate >= weekStart && transDate <= weekEnd;
                });
                
                const profitable = weekTransactions.filter(t => t.amount > 0);
                
                weeklyData.push(weekTransactions.length);
                profitableWeeklyData.push(profitable.length);
            }
            
            // Вычисляем среднее количество сделок в неделю
            const avgWeekly = weeklyData.length > 0 ? Math.round(weeklyData.reduce((a, b) => a + b, 0) / weeklyData.length) : 0;
            document.getElementById('avgWeeklyDeals').textContent = avgWeekly;
            
            weeklyActivityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: last8Weeks,
                    datasets: [{
                        label: 'Сделок совершено',
                        data: weeklyData,
                        backgroundColor: '#ffffff',
                        borderRadius: 2,
                        maxBarThickness: 30
                    }, {
                        label: 'Прибыльных',
                        data: profitableWeeklyData,
                        backgroundColor: '#22c55e',
                        borderRadius: 2,
                        maxBarThickness: 30
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 26, 0.95)',
                            titleColor: '#ffffff',
                            bodyColor: '#cccccc',
                            borderColor: '#333333',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: true,
                            titleFont: {
                                size: 14,
                                weight: 'bold',
                                family: "'Segoe UI', sans-serif"
                            },
                            bodyFont: {
                                size: 13,
                                weight: '600',
                                family: "'Segoe UI', sans-serif"
                            },
                            footerFont: {
                                size: 11,
                                weight: '500'
                            },
                            padding: 12,
                            caretSize: 6,
                            caretPadding: 8,
                            usePointStyle: true,
                            boxPadding: 4,
                            callbacks: {
                                title: function(context) {
                                    return `${context[0].label}`;
                                },
                                label: function(context) {
                                    const label = context.dataset.label;
                                    const value = context.parsed.y;
                                    return `${label}: ${value} сделок`;
                                },
                                footer: function(tooltipItems) {
                                    const total = tooltipItems.reduce((sum, item) => sum + item.parsed.y, 0);
                                    return total > 0 ? `Общая активность: ${total}` : '';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#666666',
                                font: {
                                    size: 10
                                }
                            }
                        },
                        y: {
                            display: true,
                            beginAtZero: true,
                            grid: {
                                color: '#333333',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#666666',
                                font: {
                                    size: 10
                                },
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

    </script>
</body>
</html> 